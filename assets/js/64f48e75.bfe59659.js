"use strict";(self.webpackChunkmysite=self.webpackChunkmysite||[]).push([[694],{78352:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>i});var l=s(13274),a=s(1780);const r={},c=void 0,t={id:"\u7b14\u8bb0/\u6570\u636e\u5e93",title:"\u6570\u636e\u5e93",description:"mysql\u67e5\u770b\u6570\u636e\u5e93\u8868\u5927\u5c0f",source:"@site/docs/\u7b14\u8bb0/\u6570\u636e\u5e93.md",sourceDirName:"\u7b14\u8bb0",slug:"/\u7b14\u8bb0/\u6570\u636e\u5e93",permalink:"/docs/\u7b14\u8bb0/\u6570\u636e\u5e93",draft:!1,unlisted:!1,editUrl:"https://github.com/gavintan/notes/docs/\u7b14\u8bb0/\u6570\u636e\u5e93.md",tags:[],version:"current",frontMatter:{},sidebar:"doc",previous:{title:"\u524d\u7aef",permalink:"/docs/\u7b14\u8bb0/\u524d\u7aef"},next:{title:"\u7f51\u7edc\u4ea4\u6362\u673a",permalink:"/docs/\u7b14\u8bb0/\u7f51\u7edc\u4ea4\u6362\u673a"}},d={},i=[{value:"mysql\u67e5\u770b\u6570\u636e\u5e93\u8868\u5927\u5c0f",id:"mysql\u67e5\u770b\u6570\u636e\u5e93\u8868\u5927\u5c0f",level:2},{value:"msyql\u6570\u636e\u5e93\u5e38\u7528\u547d\u4ee4",id:"msyql\u6570\u636e\u5e93\u5e38\u7528\u547d\u4ee4",level:2}];function o(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"mysql\u67e5\u770b\u6570\u636e\u5e93\u8868\u5927\u5c0f",children:"mysql\u67e5\u770b\u6570\u636e\u5e93\u8868\u5927\u5c0f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SELECT TABLE_NAME AS \"Table\", round(((data_length + index_length) / 1024 / 1024), 2) AS Size_in_MB FROM information_schema.TABLES  WHERE table_schema = '\u6570\u636e\u5e93\u540d' ORDER BY Size_in_MB DESC LIMIT 10;\n"})}),"\n",(0,l.jsx)(n.h2,{id:"msyql\u6570\u636e\u5e93\u5e38\u7528\u547d\u4ee4",children:"msyql\u6570\u636e\u5e93\u5e38\u7528\u547d\u4ee4"}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770b\u8868\u7ed3\u6784"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"desc \u8868\u540d;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4fee\u6539\u8868\u540d"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"alter table \u8868\u540d rename \u65b0\u8868\u540d;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4fee\u6539\u8868\u5b57\u6bb5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"alter table \u8868\u540d change \u5b57\u6bb5\u540d \u65b0\u5b57\u6bb5\u540d integer;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4fee\u6539\u8868\u5185\u5bb9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"update \u8868\u540d set \u5b57\u6bb5='\u65b0\u5185\u5bb9' where \u5b57\u6bb5='\u6761\u4ef6';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6dfb\u52a0\u8868\u5b57\u6bb5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"alter table \u8868\u540d add column \u65b0\u5efa\u5b57\u6bb5\u540d int not null default 0 after \u65b0\u5efa\u5b57\u6bb5\u4e0a\u4e00\u4e2a\u5b57\u6bb5\u540d;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5220\u9664\u8868\u5b57\u6bb5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"alter table \u8868\u540d drop column \u5b57\u6bb5\u540d;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770b\u5e93\u7684\u5927\u5c0f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"use information_schema;\nselect  concat(round(sum(data_length/1024/1024),2),'mb') as data from tables where  table_schema='\u5e93\u540d';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770b\u5e93\u4e0b\u9762\u8868\u7684\u5927\u5c0f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"use information_schema;\nselect  concat(round(sum(data_length/1024/1024),2),'mb') as data from tables where  table_schema='\u5e93\u540d' and table_name='\u8868\u540d';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770b\u5e93\u7d22\u5f15\u5927\u5c0f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"use information_schema;\nselect concat(round(sum(data_length/1024/1024),2),'mb') as 'Total Index Size' from tables where table_schema = '\u5e93\u540d';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770b\u6240\u6709\u7528\u6237"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"select user,host,plugin from mysql.user;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u67e5\u770b\u7528\u6237\u6743\u9650"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"show grants for user_uild;\n\nshow grants for user_uild@'127.0.0.1';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u521b\u5efa\u7528\u6237"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"create user 'username'@'%' identified with by '123456';\n\ncreate user 'username'@'%' identified with mysql_native_password by '123456';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4fee\u6539\u6307\u5b9a\u7528\u6237\u5bc6\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"set password for 'root'@'localhost' = password('123456');\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4fee\u6539\u5f53\u524d\u7528\u6237\u5bc6\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"alter user user() identified by '123456';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6388\u6743\u7528\u6237"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"grant all privileges on *.* to root@'%' identified by '123456';\n\ngrant select,insert,update,delete on *.* to root@localhost identified by '123456';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u53d6\u6d88\u7528\u6237\u6388\u6743"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"revoke all privileges on *.* from root@'127.0.0.1';\n\nrevoke select on xhl_guild.* from user_guild@'%';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4fee\u6539\u52a0\u5bc6\u65b9\u5f0f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"update mysql.user set plugin='mysql_native_password' where user='root' and host='localhost';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5237\u65b0\u6388\u6743"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"flush privileges;\n"})}),"\n",(0,l.jsx)(n.p,{children:"mysql8\u8bbe\u7f6e\u7b80\u5355\u5bc6\u7801\u7b56\u7565"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"set global validate_password.policy=0;\nset global validate_password.length=1;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u521b\u5efa\u76d1\u63a7\u7528\u6237"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"create user 'exporter'@'localhost' identified by 'xxxxxxxx' with max_user_connections 3;\n\ngrant process, replication client, select on *.* to 'exporter'@'localhost';\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5168\u5c40\u8bfb\u9501"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"flush tables with read lock;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5355\u4e2a\u8868\u52a0\u9501"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"lock tables db_a.tbl_aaa read;\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u91ca\u653e\u9501"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"unlock tables;\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},1780:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>t});var l=s(79474);const a={},r=l.createContext(a);function c(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);