<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-笔记/linux" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">linux | 一心净土</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.tanwen.net/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.tanwen.net/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.tanwen.net/docs/笔记/linux"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="linux | 一心净土"><meta data-rh="true" name="description" content="shell变量含义"><meta data-rh="true" property="og:description" content="shell变量含义"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.tanwen.net/docs/笔记/linux"><link data-rh="true" rel="alternate" href="https://www.tanwen.net/docs/笔记/linux" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://www.tanwen.net/docs/笔记/linux" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KUPKLROM3T-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="一心净土" href="/opensearch.xml">

<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="一心净土 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="一心净土 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.5204f51a.css">
<script src="/assets/js/runtime~main.4f20380c.js" defer="defer"></script>
<script src="/assets/js/main.32bce179.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_RxHL" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.webp" alt="Logo" class="themedComponent_FXRw themedComponent--light_RIle"><img src="/img/logo.webp" alt="Logo" class="themedComponent_FXRw themedComponent--dark_gZs3"></div><b class="navbar__title text--truncate">一心净土</b></a><a class="navbar__item navbar__link" href="/blog">博客</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/笔记/linux">藏经阁</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">工具</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tools/base64">Base64转换</a></li><li><a class="dropdown__link" href="/tools/timestamp">时间戳转换</a></li><li><a class="dropdown__link" href="/tools/time">时间单位换算</a></li></ul></div><a href="https://github.com/gavintan" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_h4lT colorModeToggle_R02Z"><button class="clean-btn toggleButton_hHWs toggleButtonDisabled_H05n" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_mK0v"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_ijyT"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer__qBQ"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_Sb6R"><div class="docsWrapper_KTGS"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_zYHU" type="button"></button><div class="docRoot_Zota"><aside class="theme-doc-sidebar-container docSidebarContainer_sN_T"><div class="sidebarViewport_Fotp"><div class="sidebar_C7vj"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_TMzX"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/笔记/linux">笔记</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/笔记/linux">linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/笔记/windows">windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/笔记/k8s">k8s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/笔记/mac">mac</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/笔记/python">python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/笔记/前端">前端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/笔记/数据库">数据库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/笔记/网络交换机">网络交换机</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/k8s/Ingress">k8s</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/数据库/monodb">数据库</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/消息队列/rabbitmq">消息队列</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_itEV"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_xber"><div class="docItemContainer_Ovfy"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_ro25" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_jGbE"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">笔记</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">linux</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_aDiu theme-doc-toc-mobile tocMobile_Gbea"><button type="button" class="clean-btn tocCollapsibleButton_g9Wf">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>linux</h1></header><h2 class="anchor anchorWithStickyNavbar_AGbz" id="shell变量含义">shell变量含义<a href="#shell变量含义" class="hash-link" aria-label="shell变量含义的直接链接" title="shell变量含义的直接链接">​</a></h2>
<ul>
<li>$# 是传给脚本的参数个数</li>
<li>$0 是脚本 本身的名字</li>
<li>$1 是传递给该shell脚本的第一个参数</li>
<li>$2 是传递给该shell脚本的第二个参数</li>
<li>$3 是传递给该shell脚本的第三个参数</li>
<li>$@ 是传给脚本的所有参数的列表</li>
<li>$* 是以一个单字符串显示所有向脚本传递的参数，与位置变量不同，参数可超过9个</li>
<li>$$ 是脚本运行的当前进程ID号</li>
<li>$? 是显示最后命令的退出状态，0表示没有错误，其他表示有错误</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="es修复分片">es修复分片<a href="#es修复分片" class="hash-link" aria-label="es修复分片的直接链接" title="es修复分片的直接链接">​</a></h2>
<p>通过<code>explain api</code>查看详细情况</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[root@sh ~]# curl -s -XGET localhost:9200/_cluster/allocation/explain?pretty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;index&quot; : &quot;index-net-20210902-3&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;shard&quot; : 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;primary&quot; : true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;current_state&quot; : &quot;unassigned&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;unassigned_info&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;reason&quot; : &quot;ALLOCATION_FAILED&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;at&quot; : &quot;2021-09-28T03:10:58.099Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;failed_allocation_attempts&quot; : 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;details&quot; : &quot;&quot;&quot;failed shard on node [LwWiAwmdQCiEibtiF7oqxQ]: failed recovery, failure RecoveryFailedException[[device_search_20201204][3]: Recovery failed on {reading_9.10.126.164_node2}{LwWiAwmdQCiEibtiF7oqxQ}{YVadGK2FSDKbR69l0Wu0xg}{9.10.126.164}{9.10.126.164:9300}{dil}{ml.machine_memory=539647844352, xpack.installed=true, ml.max_open_jobs=20}]; nested: IndexShardRecoveryException[failed recovery]; nested: ElasticsearchException[java.io.IOException: failed to read /data1/containers/1612339152002810932/es/data/nodes/0/indices/b0Ar9gFpQc6_oHhrdHYxGQ/7/_state/retention-leases-1518.st]; nested: IOException[failed to read /data1/containers/1612339152002810932/es/data/nodes/0/indices/b0Ar9gFpQc6_oHhrdHYxGQ/7/_state/retention-leases-1518.st]; nested: IOException[org.apache.lucene.index.CorruptIndexException: codec footer mismatch (file truncated?): actual footer=892219961 vs expected footer=-1071082520 (resource=BufferedChecksumIndexInput(SimpleFSIndexInput(path=&quot;/data1/containers/1612339152002810932/es/data/nodes/0/indices/b0Ar9gFpQc6_oHhrdHYxGQ/7/_state/retention-leases-1518.st&quot;)))]; nested: CorruptIndexException[codec footer mismatch (file truncated?): actual footer=892219961 vs expected footer=-1071082520 (resource=BufferedChecksumIndexInput(SimpleFSIndexInput(path=&quot;/data1/containers/1612339152002810932/es/data/nodes/0/indices/b0Ar9gFpQc6_oHhrdHYxGQ/7/_state/retention-leases-1518.st&quot;)))]; &quot;&quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;last_allocation_status&quot; : &quot;no&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>方案一：修复分片</strong></p>
<p>retention-leases-1518.st 这个文件的损坏，与这个文件曾经有一段时间不在线有关系。也就是说，与机器重启有关。如果要恢复的话，则需要手动删除这个文件，然后重新尝试分配分片：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[root@sh ~]# curl -s -XPOST localhost:9200/_cluster/reroute?retry_failed=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;acknowledged&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;state&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;cluster_uuid&quot;: &quot;LOk2L8k5RsmCC7eg2y3h8A&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;version&quot;: 533752,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;state_uuid&quot;: &quot;jVm_8aAIT6ug9NBJazjVig&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;master_node&quot;: &quot;kHbBiclxR5-c-rsra2A5Jg&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;blocks&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;nodes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;m5eloUNuTJak4xDRqf3FeA&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;name&quot;: &quot;1625799512002116132&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;ephemeral_id&quot;: &quot;dqHmYahLSbuqvSkRXy2IPg&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;transport_address&quot;: &quot;9.27.34.96:9300&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;attributes&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;ml.machine_memory&quot;: &quot;134587404288&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;rack&quot;: &quot;cvm_33_330002&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;xpack.installed&quot;: &quot;true&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;set&quot;: &quot;330002&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;transform.node&quot;: &quot;true&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;ip&quot;: &quot;9.27.34.96&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;temperature&quot;: &quot;hot&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;ml.max_open_jobs&quot;: &quot;20&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;region&quot;: &quot;33&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;security_tokens&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>方案二：分配陈腐的分片</strong></p>
<p>如果删除损坏的.st文件无法使分片上线，则需要考虑使用reroute api分配stale primary。执行这个api之前，我们需要得到一些信息：</p>
<ul>
<li>索引名称和分片ID可以通过<code>explain api</code>直观看到；</li>
<li>节点名称可以通过<code>unassigned_info.details</code>得到。</li>
</ul>
<p><img loading="lazy" src="https://raw.githubusercontent.com/GavinTan/files/master/picgo/20220118162300.png" alt="" class="img_uPvX"></p>
<p>根据这些信息，我们就可以执行reroute api了：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[root@sh ~]# curl -s -H &quot;Content-Type:application/json&quot; -XPOST &quot;localhost:9200/_cluster/reroute?pretty&quot; -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;commands&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;allocate_stale_primary&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;index&quot;: &quot;{索引名称}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;shard&quot;: &quot;{分片ID}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;node&quot;: &quot;{节点名称}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;accept_data_loss&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>方案三：丢弃分片</strong></p>
<p>如果分配陈腐的分片也无法使分片上线，为了不影响索引读写请求，就只能丢弃掉损坏的分片了，这是最糟糕的情况：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[root@sh ~]# curl -s -H &quot;Content-Type:application/json&quot; -XPOST &quot;localhost:9200/_cluster/reroute?pretty&quot; -d &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;commands&quot; : [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;allocate_empty_primary&quot; : {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;index&quot; : &quot;{索引名称}&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;shard&quot; : &quot;{分片ID}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;node&quot; : &quot;{节点名称}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;accept_data_loss&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>使用Lucene CheckIndex 修复</strong></p>
<p><code>-exorcise</code>只能在紧急情况下使用，因为它将导致文件（也许是很多）被永久地从索引中删除。</p>
<ul>
<li>在运行这个工具之前，一定要对你的索引做一个备份。</li>
<li>不要在一个正在被写入的索引上运行这个工具。</li>
</ul>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">java -cp /usr/share/elasticsearch/lib/lucene-core-7.5.0.jar -ea:org.apache.lucene... org.apache.lucene.index.CheckIndex /work/elasticsearch/data/nodes/0/indices/uYrH-t7AR7e5mR2eCC7-6g/2/index -verbose -exorcise</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>结果返回 <code>No problems were detected with this index.</code> 话，说明索引没有损坏直接移除目录下的数据损坏标签 corrupted_*文件然后重启es</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mv /work/elasticsearch/data/nodes/0/indices/uYrH-t7AR7e5mR2eCC7-6g/2/index/corrupted_H_wQlkOtQzKaz3dGkq_G-A /tmp</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>链接：</p>
<ul>
<li><a href="https://cloud.tencent.com/developer/article/1884450" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1884450</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="haproxy停用启用server">haproxy停用启用server<a href="#haproxy停用启用server" class="hash-link" aria-label="haproxy停用启用server的直接链接" title="haproxy停用启用server的直接链接">​</a></h2>
<p>设置socket admin权限</p>
<div class="language-conf codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-conf codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">stats socket /var/lib/haproxy/stats level admin</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>停用backend app下的server app1</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;disable server app/app1&quot; | socat stdio /var/lib/haproxy/stats</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>启用</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;enable server app/app1&quot; | socat stdio /var/lib/haproxy/stats</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="mysql导出文件">mysql导出文件<a href="#mysql导出文件" class="hash-link" aria-label="mysql导出文件的直接链接" title="mysql导出文件的直接链接">​</a></h2>
<p>msyql5.7 secure_file_priv 用于限制数据导入导出操作：</p>
<ul>
<li>secure_file_priv 为 NULL 时，表示限制mysqld不允许导入或导出。</li>
<li>secure_file_priv 为 /tmp 时，表示限制mysqld只能在/tmp目录中执行导入导出，其他目录不能执行。</li>
<li>secure_file_priv 没有值 时，表示不限制mysqld在任意目录的导入导出。</li>
</ul>
<p>因为 <code>secure_file_priv</code> 参数是只读参数，不能使用set global命令修改。需要在my.ini里加入 <code>secure_file_priv=&#x27;&#x27;</code> 。</p>
<p>查看当前配置：</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> variables </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%secure_file_priv%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>导出csv：</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">outfile</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/tmp/user.csv&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fields</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">terminated</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">optionally</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">enclosed</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lines</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">terminated</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\r\n&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>导入数据：</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">load</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">data</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">infile</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/tmp/data.txt&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">replace</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> mytable</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="xtrabackup备份">xtrabackup备份<a href="#xtrabackup备份" class="hash-link" aria-label="xtrabackup备份的直接链接" title="xtrabackup备份的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y https://repo.percona.com/yum/percona-release-latest.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y percona-xtrabackup-21.x86_64</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>备份：</strong></p>
<p>创建备份用户</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bakuser&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;localhost&#x27;</span><span class="token plain"> identified </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;123456&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">grant</span><span class="token plain"> reload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lock</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">tables</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">replication</span><span class="token plain"> client </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bakuser&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;localhost&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flush </span><span class="token keyword" style="color:#00009f">privileges</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>全量备份</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup -u bakuser -p 123456 --backup --target-dir=/data/dbbak/base</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>压缩备份</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --backup --compress --compress-threads=4 --target-dir=/data/dbbak/base</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>备份指定数据库</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup -u bakuser -p 123456  --databases=&quot;db1 db2&quot; --backup --target-dir=/data/dbbak/base</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>备份指定表</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup -u bakuser -p 123456  --databases=&quot;db1.tab1 db2.tab2&quot; --backup --target-dir=/data/dbbak/base</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>恢复：</strong></p>
<p>准备备份</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#压缩过的需要先解压缩</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --decompress --target-dir=/data/dbbak/base</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --prepare --target-dir=/data/dbbak/base</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>恢复备份 --move-back 移动不保留备份 --copy-back 复制保留备份</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#rsync -avrP /data/dbbak/base/ /var/lib/mysql/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --copy-back --target-dir=/data/dbbak/base</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown -R mysql:mysql /var/lib/mysql</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>增量备份：</strong></p>
<p>创建全量备份</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup -u bakuser -p 123456 --backup --target-dir = /data/dbbak/base</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>创建增量备份 inc1</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup -u bakuser -p 123456 --backup --target-dir=/data/dbbak/inc1 --incremental-basedir=/data/dbbak/base</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>创建增量备份 inc2</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup -u bakuser -p 123456 --backup --target-dir=/data/dbbak/inc2 --incremental-basedir=/data/dbbak/inc1</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>恢复增量备份：</strong></p>
<p>准备备份</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#压缩过的需要先解压缩</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --decompress --target-dir=/data/dbbak/base</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --prepare --apply-log-only --target-dir=/data/dbbak/base</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --prepare --apply-log-only --target-dir=/data/dbbak/base --incremental-dir=/data/dbbak/inc1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --prepare --target-dir=/data/dbbak/base --incremental-dir=/data/dbbak/inc2</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>恢复备份</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#rsync -avrP /data/dbbak/ /var/lib/mysql/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xtrabackup --copy-back --target-dir=/data/dbbak/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown -R mysql:mysql /var/lib/mysql</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>恢复单个表：</strong></p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install mysql-utilities -y</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#从备份中读取表结构 复制创表语句在数据库创建表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysqlfrm --diagnostic /data/dbbak/mydb/tb1.frm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#丢弃表空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alter table tb1 discard tablespace;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#从备份中拷贝ibd文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp /data/dbbak/mydb/tb1.ibd /var/lib/mysql/mydb/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown mysql. /var/lib/mysql/mydb/tb1.ibd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#载入表空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alter table tb1 import tablespace;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>链接：</p>
<ul>
<li><a href="https://www.jianshu.com/p/19b986a39b5e" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/19b986a39b5e</a></li>
<li><a href="https://www.percona.com/doc/percona-xtrabackup/2.4/index.html#advanced-features" target="_blank" rel="noopener noreferrer">https://www.percona.com/doc/percona-xtrabackup/2.4/index.html#advanced-features</a></li>
<li><a href="https://www.percona.com/doc/percona-xtrabackup/2.3/howtos/recipes_ibkx_stream.html" target="_blank" rel="noopener noreferrer">https://www.percona.com/doc/percona-xtrabackup/2.3/howtos/recipes_ibkx_stream.html</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux中文支持">linux中文支持<a href="#linux中文支持" class="hash-link" aria-label="linux中文支持的直接链接" title="linux中文支持的直接链接">​</a></h2>
<blockquote>
<p>centos</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install fontconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#查看已安装的中文字体</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fc-list :lang=zh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#安装中文字体</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install wqy-zenhei-fonts wqy-microhei-fonts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#刷新字体缓存</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fc-cache -f -v</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>debian</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#查看当前环境语言</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">locale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#安装中文字体</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt-get install xfonts-wqy ttf-wqy-zenhei ttf-wqy-microhei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#添加中文环境支持</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dpkg-reconfigure locales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#通过空格选择 选择后确认添加</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#zh_CN,UTF-8 UTF-8</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>ubuntu</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># 安装中文字体</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt install fonts-wqy-microhei ttf-wqy-zenhei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#生成中文环境</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo locale-gen zh_CN.UTF-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#输入法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#安装输入法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install fcitx fcitx-googlepinyin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#生成dbus机器码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dbus-uuidgen &gt; /var/lib/dbus/machine-id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#配置环境变量，/etc/profile.d/fcitx.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export QT_IM_MODULE=fcitx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GTK_IM_MODULE=fcitx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export XMODIFIERS=@im=fcitx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export DefaultIMModule=fcitx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fcitx-autostart &amp;&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#配置 Fcitx 的输入法选项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fcitx-config-gtk3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#运行fcitx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fcitx-autostart</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="logrotate日志切割">logrotate日志切割<a href="#logrotate日志切割" class="hash-link" aria-label="logrotate日志切割的直接链接" title="logrotate日志切割的直接链接">​</a></h2>
<p><strong>logrotate 是基于 cron 每天运行</strong></p>
<p>配置文件示例：</p>
<div class="language-log codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-log codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/zabbix/zabbix_agentd.log {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weekly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rotate 12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delaycompress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    missingok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    notifempty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    create 0664 zabbix zabbix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-log codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-log codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/cron</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/maillog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/messages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/secure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/spooler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    missingok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sharedscripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    postrotate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /bin/kill -HUP `cat /var/run/syslogd.pid 2&gt; /dev/null` 2&gt; /dev/null || true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    endscript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-log codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-log codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/httpd/*log {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    missingok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    notifempty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sharedscripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delaycompress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    postrotate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /bin/systemctl reload httpd.service &gt; /dev/null 2&gt;/dev/null || true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    endscript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-log codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-log codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/tinyproxy/tinyproxy.log {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    daily</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rotate 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    missingok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    notifempty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sharedscripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    postrotate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [ ! -f /var/run/tinyproxy/tinyproxy.pid ] || kill -HUP `cat /var/run/tinyproxy/tinyproxy.pid`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    endscript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>monthly: 日志文件将按月轮循。其它可用值为 daily，weekly 或者 yearly。</li>
<li>rotate 5: 一次将存储 5 个归档日志。对于第六个归档，时间最久的归档将被删除。</li>
<li>compress: 在轮循任务完成后，已轮循的归档将使用 gzip 进行压缩。</li>
<li>delaycompress: 总是与 compress 选项一起用，delaycompress 选项指示 logrotate 不要将最近的归档压缩，压缩 将在下一次轮循周期进行。这在你或任何软件仍然需要读取最新归档时很有用。</li>
<li>missingok: 在日志轮循期间，任何错误将被忽略，例如 “文件无法找到” 之类的错误。</li>
<li>notifempty: 如果日志文件为空，轮循不会进行。</li>
<li>create 644 root root: 以指定的权限创建全新的日志文件，同时 logrotate 也会重命名原始日志文件。</li>
<li>postrotate/endscript: 在所有其它指令完成后，postrotate 和 endscript 里面指定的命令将被执行。在这种情况下，rsyslogd 进程将立即再次读取其配置并继续运行。</li>
</ul>
<p>常用配置参数：</p>
<ul>
<li>daily ：指定转储周期为每天</li>
<li>weekly ：指定转储周期为每周</li>
<li>monthly ：指定转储周期为每月</li>
<li>rotate count ：指定日志文件删除之前转储的次数，0 指没有备份，5 指保留 5 个备份</li>
<li>tabooext [+] list：让 logrotate 不转储指定扩展名的文件，缺省的扩展名是：.rpm-orig, .rpmsave, v, 和～</li>
<li>missingok：在日志轮循期间，任何错误将被忽略，例如 “文件无法找到” 之类的错误。</li>
<li>size size：当日志文件到达指定的大小时才转储，bytes (缺省) 及 KB (sizek) 或 MB (sizem)</li>
<li>compress： 通过 gzip 压缩转储以后的日志</li>
<li>nocompress： 不压缩</li>
<li>copytruncate：用于还在打开中的日志文件，把当前日志备份并截断</li>
<li>nocopytruncate： 备份日志文件但是不截断</li>
<li>create mode owner group ： 转储文件，使用指定的文件模式创建新的日志文件</li>
<li>nocreate： 不建立新的日志文 件</li>
<li>delaycompress： 和 compress 一起使用时，转储的日志文件到下一次转储时才压缩</li>
<li>nodelaycompress： 覆盖 delaycompress 选项，转储同时压缩</li>
<li>errors address ： 专储时的错误信息发送到指定的 Email 地址</li>
<li>ifempty ：即使是空文件也转储，这个是 logrotate 的缺省选项</li>
<li>notifempty ：如果是空文件的话，不转储</li>
<li>mail address ： 把转储的日志文件发送到指定的 E-mail 地址</li>
<li>nomail ： 转储时不发送日志文件</li>
<li>olddir directory：储后的日志文件放入指定的目录，必须和当前日志文件在同一个文件系统</li>
<li>noolddir： 转储后的日志文件和当前日志文件放在同一个目录下</li>
<li>prerotate/endscript： 在转储以前需要执行的命令可以放入这个对，这两个关键字必须单独成行</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="pm2">pm2<a href="#pm2" class="hash-link" aria-label="pm2的直接链接" title="pm2的直接链接">​</a></h2>
<p><strong>fork模式</strong>：单实例多进程不支持端口复用。支持配置interpreter使用pm2运行js之外的语言，例如php、python等等。</p>
<p><strong>cluster模式</strong>：多实例多进程，只支持node，端口可以复用，实现负载均衡、共享TCP连接。</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">npm install -g pm2</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>常用命令：</p>
<ul>
<li>
<p>npm启动</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start npm --name &quot;myapp&quot; -- start</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>npm启动指定脚本</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start npm --name &quot;myapp&quot; -- run &quot;start:dev&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>指定参数启动</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start app.js --node-args=&quot;--max-old-space-size=1024&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>启动app.js应用程序</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start app.js </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>启动4个app.js的应用实例cluster模式</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start app.js -i 4</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>启动应用程序并命名为myapp</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start app.js --name=&quot;myapp&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>当文件变化时自动重启应用</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start app.js --watch</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>通过config文件启动</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start ecosystem.config.js</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>列出 PM2 启动的所有的应用程序</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 list</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>显示每个应用程序的CPU和内存占用情况</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 monit</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>显示应用程序的所有信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 show [app-name]</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>显示所有应用程序的日志</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 logs</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>显示指定应用程序的日志</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 logs [app-name]</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>清空所有日志</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 flush</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>停止所有的应用程序</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 stop all</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>停止 id为 0的指定应用程序</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 stop 0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>重启所有应用</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 restart all</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>重新加载所有应用</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 reload all</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>关闭并删除所有应用</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 delete all</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>删除指定应用 id 0</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 delete 0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>把应用扩展到10个实例</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 scale [app-name] 10</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>增加2个实例</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 scale [app-name] +2</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>重置重启次数</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 reset [app-name]</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>创建开机自启动命令</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 startup</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>保存当前应用列表</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 save</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>更新pm2 ，保存进程&gt;杀死PM2&gt;恢复进程</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 update</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>生成ecosystem.config.js模板</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 init</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 init simple</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pm2 ecosystem</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<div class="language-js codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-js codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">apps</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;myapp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                            </span><span class="token comment" style="color:#999988;font-style:italic">// 项目名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;index.js&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic">// 执行文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">cwd</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                                </span><span class="token comment" style="color:#999988;font-style:italic">// 工作目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">args</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                                 </span><span class="token comment" style="color:#999988;font-style:italic">// 传递给脚本的参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">interpreter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/usr/bin/python&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// 指定的脚本解释器，默认node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">interpreter_args</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic">// 传递给解释器的参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">watch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                               </span><span class="token comment" style="color:#999988;font-style:italic">// 是否监听文件变动然后重启</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">ignore_watch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic">// 不用监听的文件或目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;node_modules</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&#x27;logs&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">exec_mode</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;fork&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic">// 启动应用程序的模式，可以是cluster或fork，默认fork。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">instances</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                             </span><span class="token comment" style="color:#999988;font-style:italic">// 应用启动实例个数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">max_memory_restart</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;8G&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">// 最大内存限制数，超出自动重启</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">error_file</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./logs/app-err.log&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// 错误日志文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">out_file</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./logs/app-out.log&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// 正常日志文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">merge_logs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                         </span><span class="token comment" style="color:#999988;font-style:italic">// 设置追加日志而不是新建日志</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">log_date_format</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;YYYY-MM-DD HH:mm:ss&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 指定日志文件的时间格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">min_uptime</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;60s&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic">// 应用运行少于时间被认为是异常启动</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">max_restarts</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                         </span><span class="token comment" style="color:#999988;font-style:italic">// 最大异常重启次数，即小于min_uptime运行时间重启次数；</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">autorestart</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic">// 默认为true, 发生异常的情况下自动重启</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">cron_restart</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1 0 * * *&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// crontab时间格式重启应用;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">restart_delay</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;60s&#x27;</span><span class="token plain">                      </span><span class="token comment" style="color:#999988;font-style:italic">// 异常重启情况下，延时重启时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">env</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                                    </span><span class="token comment" style="color:#999988;font-style:italic">// 默认环境参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token constant" style="color:#36acaa">PORT</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3003</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token constant" style="color:#36acaa">NODE_ENV</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;production&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token constant" style="color:#36acaa">MYNAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;aa&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">env_dev</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                                </span><span class="token comment" style="color:#999988;font-style:italic">// 自定义环境参数dev，当前指定为开发环境 pm2 start app.js --env dev</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token constant" style="color:#36acaa">NODE_ENV</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;development&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token constant" style="color:#36acaa">MYNAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bb&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">env_test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                               </span><span class="token comment" style="color:#999988;font-style:italic">// 自定义环境参数test，当前指定为测试环境 pm2 start app.js --env test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token constant" style="color:#36acaa">NODE_ENV</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token constant" style="color:#36acaa">MYNAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;cc&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./service-worker/&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">watch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;./service-worker&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">deploy</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">production</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">user</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SSH_USERNAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">host</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SSH_HOSTMACHINE&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">ref</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;origin/master&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">repo</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;GIT_REPOSITORY&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">path</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DESTINATION_PATH&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&#x27;pre-deploy-local&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&#x27;post-deploy&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;npm install &amp;&amp; pm2 reload ecosystem.config.js --env production&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&#x27;pre-setup&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="windwos文件名到linux乱码">windwos文件名到linux乱码<a href="#windwos文件名到linux乱码" class="hash-link" aria-label="windwos文件名到linux乱码的直接链接" title="windwos文件名到linux乱码的直接链接">​</a></h2>
<p>安装convmv：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install convmv</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>转换编码：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">convmv --notest --nosmart -f gbk -t utf8 -r /data</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>参数：</p>
<ul>
<li>-f enc     源编码</li>
<li>-t enc     新编码</li>
<li>-r         递归处理子文件夹</li>
<li>-i         交互文向转换</li>
<li>--list     显示所有可用编码</li>
<li>--nosmart  如果是utf8文件，忽略</li>
<li>--notest   直接转换不测试</li>
<li>--replace  文件相同直接替换</li>
<li>--unescape 可以做一下转义，比如把%20变成空格</li>
<li>--upper    全部转换成大写</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="redis">redis<a href="#redis" class="hash-link" aria-label="redis的直接链接" title="redis的直接链接">​</a></h2>
<p><strong>创建集群：</strong></p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster create 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 --cluster-replicas 1</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>添加节点：</strong></p>
<ul>
<li>
<p>添加master节点（master7008）</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster add-node 127.0.0.1:7008 127.0.0.1:7000</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>添加slave节点（指定master-id的slave7009）</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster add-node 127.0.0.1:7009 127.0.0.1:7000 --cluster-slave --cluster-master-id 46f0b68b3f605b3369d3843a89a2b4a164ed21e8</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p><strong>删除节点：</strong></p>
<ol>
<li>
<p>迁移哈希槽至别的节点</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster reshard 127.0.0.1:7000 --cluster-from 46f0b68b3f605b3369d3843a89a2b4a164ed21e8 --cluster-to 2846540d8284538096f111a8ce7cf01c50199237 --cluster-slots 1024 --cluster-yes</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>删除master以及对应的slave节点</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster del-node 127.0.0.1:7000 46f0b68b3f605b3369d3843a89a2b4a164ed21e8</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p><strong>导入数据：</strong></p>
<ul>
<li>
<p>数据从外部实例导入到 Redis 集群</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster import 127.0.0.1:7001 --cluster-from 172.16.7.14:6379 --cluster-copy</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>数据从aof恢复数据到集群</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli -c -p 7001 --pipe &lt; appendonly.aof</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p><strong>修复槽：</strong></p>
<p><code>[WARNING] Node 127.0.0.1:7003 has slots in migrating state 10867.</code></p>
<ol>
<li>
<p>清除哈希槽中的任何导入/迁移状态</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli -c -p 7001 cluster setslot 10867 stable</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>修复（槽对应的节点）</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster fix 127.0.0.1:7003</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p><strong>迁移槽（from &amp; to 对应节点id）：</strong></p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># cluster-slots 迁移槽的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster reshard 127.0.0.1:7001 --cluster-from 9a243bc1db6cd60689512b2c3c63e5962b2de0bb --cluster-to 3e96051497a2021c84d230831104f1f9e8c6430a --cluster-slots 5461 --cluster-yes</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>redis-cli下常用操作：</strong></p>
<p>redis-cli -c -p 7001</p>
<ul>
<li>
<p>指定或切换当前节点为node-id的slave（master时必须迁移走所有槽）</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cluster replicate node-id</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>查看keyname对应的槽</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cluster keyslot keyname</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>查看槽的分配</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cluster slots</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>异步重写aof生成新的aof文件</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">bgrewriteaof</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>异步生成rdb</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">bgsave</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>查看集群节点及槽分配</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster check 127.0.0.1:7001</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看集群各节点dbsize</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">redis-cli --cluster call 127.0.0.1:7001 dbsize</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="kvm">kvm<a href="#kvm" class="hash-link" aria-label="kvm的直接链接" title="kvm的直接链接">​</a></h2>
<p>安装kvm：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y qemu-kvm libvirt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y virt-install libvirt-python virt-manager virt-install libvirt-client</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置网桥：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virsh iface-bridge eth0 br0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virsh iface-list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brctl show</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virsh iface-unbridge br0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>创建虚拟机：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virt-install --name t01 --vcpus=2 --memory=1024 --location=/vm/CentOS-8.1.1911-x86_64-dvd1.iso --disk /vm/w01.qcow2,size=20,format=qcow2 --graphics vnc,listen=0.0.0.0 --noautoconsole --autostart --os-type=linux --os-variant=rhel8.0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virt-install --name eBay16_237--memory=2048 --vcpus=2 --os-type=windows --cdrom /data/en_windows_7_ultimate_with_sp1_x64_dvd_u_677332.iso --disk path=/usr/share/virtio-win/virtio-win-0.1.171_amd64.vfd,device=floppy --disk path=/data/kvm/eBay16_237.img,size=30,bus=virtio,format=qcow2 --network bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>从ISO映像安装虚拟机</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virt-install \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name guest1-rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --memory 2048 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vcpus 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --disk size=8 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cdrom /path/to/rhel7.iso \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --os-variant rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --noautoconsole</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>从虚拟磁盘映像导入虚拟机</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virt-install \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name guest1-rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --memory 2048 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vcpus 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --disk /path/to/imported/disk.qcow2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --import \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --os-variant rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --noautoconsole</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>从网络安装虚拟机</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virt-install \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name guest1-rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --memory 2048 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vcpus 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --disk size=8 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --location http://example.com/path/to/os \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --os-variant rhel7</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>使用PXE安装虚拟机</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virt-install \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name guest1-rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --memory 2048 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vcpus 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --disk size=8 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --network=bridge:br0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pxe \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --os-variant rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --noautoconsole</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>使用Kickstart安装虚拟机</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virt-install \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name guest1-rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --memory 2048 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vcpus 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --disk size=8 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --location http://example.com/path/to/os \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --os-variant rhel7 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --initrd-inject /path/to/ks.cfg \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --extra-args=&quot;ks=file:/ks.cfg console=tty0 console=ttyS0,115200n8&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --noautoconsole</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>在线添加硬盘：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">qemu-img create -f qcow2 /data/kvm/win11_1.img 20G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virsh attach-disk win11 /data/kvm/win11_1.img vdb --driver qemu --subdriver qcow2 --targetbus virtio --persistent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>卸载硬盘：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># 分离硬盘 vdb or img路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virsh detach-disk win11 /data/kvm/win11_1.img</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>硬盘扩容：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># 虚拟机在关机状态下进行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qemu-img resize /data/kvm/win11.img +10G</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>压缩硬盘使用空间：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">qemu-img convert -c -O qcow2 /data/kvm/win11_1.img /tmp/kvm/win11_1.img</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>DNF error: Error in POSTTRANS scriptlet in rpm package kernel-core   加上参数 --extra-args ro</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="lvs">lvs<a href="#lvs" class="hash-link" aria-label="lvs的直接链接" title="lvs的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ipvsadm -A -t VIP:port -s rr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipvsadm -a -t VIP:port -r RIP1 -g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipvsadm -a -t VIP:port -r RIP2 -g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#示例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ipvsadm -A -t 172.16.7.14:80 -s rr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ipvsadm -a -t 172.16.7.14:80 -r 172.16.7.15:88 -g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ipvsadm -a -t 172.16.7.14:80 -r 172.16.7.16:81 -g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ipvsadm -a -t 172.16.7.14:80 -r 172.16.7.17 -g</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ipvsadm -A -t VIP<!-- -->:port<!-- --> -s rr</strong></p>
<ul>
<li>-A 选项为添加一条虚拟服务器记录，即创建一个LVS集群</li>
<li>-t 标识创建的LVS集群服务为tcp协议，VIP<!-- -->:port<!-- --> 标识集群服务IP及端口号，</li>
<li>-u 使用udp协议</li>
<li>-s Scheduling 调度之意，后面参数为指定的调度算法，有rr、wrr、lc、wlc、lblc、lblcr、dh、sh、sed、nq，默认为wlc，其中rr为Round-Robin缩写，代表轮询算法</li>
</ul>
<p><strong>ipvsadm -a -t VIP<!-- -->:port<!-- --> -r RIP -g</strong></p>
<ul>
<li>-a 选项表示添加一个RS到集群中</li>
<li>-t 使用tcp协议</li>
<li>-u 使用udp协议</li>
<li>-r 用于指定需要添加的RIP（RS对应IP）</li>
<li>-g 表示LVS工作模式为DR模式，-i 为TUN模式，-m 为NAT模式</li>
</ul>
<p>查看生效规则：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ipvsadm -Ln</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但要注意一点，如果没有提前将规则进 行保存，在设备重启后配置会消失，所以我们配置完需要用 <code>service ipvsadm save</code> 保存命令，重启后用 <code>service ipvsadm reload</code> 重新载入规则。除此之外，可以用 <code>ipvsadm -S &gt; file</code> 将LVS规则保存在指定文件中，通过 <code>ipvsadm -R &lt; file</code> 进行重载</p>
<p>链接：</p>
<ul>
<li><a href="https://segmentfault.com/a/1190000019967549" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000019967549</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="nginx热升级版本">nginx热升级版本<a href="#nginx热升级版本" class="hash-link" aria-label="nginx热升级版本的直接链接" title="nginx热升级版本的直接链接">​</a></h2>
<ol>
<li>
<p>备份旧nginx</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mv /usr/local/nginx/sbin/nginx{,.bak}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>编译新ningx，复制编译好的nginx到sbin下</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">aria2c -c -x 10 https://nginx.org/download/nginx-1.20.1.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar zxf nginx-1.20.1.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd nginx-1.20.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./configure --prefix=/usr/local/nginx --with-http_ssl_module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make -j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp objs/nginx /usr/local/nginx/sbin</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>给旧nginx进程发送usr2信号，nginx会使用新文件启动一个新的master进程，生成新的nginx.pid文件旧的重命名为.obin</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">kill -usr2 `cat /usr/local/nginx/logs/nginx.pid`</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>给旧nginx进程发送winch关闭旧nginx的worker进程</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">kill -winch `cat /usr/local/nginx/logs/nginx.pid.obin`</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>待都正常后给旧nginx进程发送quit信号退出master进程</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">kill -quit `cat /usr/local/nginx/logs/nginx.pid.obin`</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>回滚（需要旧进程存在）：</p>
<ol>
<li>
<p>重启旧进程worker</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">kill -hup `cat /usr/local/nginx/logs/nginx.pid.obin`</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>退出新的进程</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">kill -quit `cat /usr/local/nginx/logs/nginx.pid`</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>链接：</p>
<ul>
<li><a href="https://blog.csdn.net/gexiaoyizhimei/article/details/101650717" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/gexiaoyizhimei/article/details/101650717</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看证书信息">查看证书信息<a href="#查看证书信息" class="hash-link" aria-label="查看证书信息的直接链接" title="查看证书信息的直接链接">​</a></h2>
<p>查看过期时间：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -noout -enddate -in /etc/kubernetes/pki/ca.crt</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看证书信息：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -noout -text -in ca.crt</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看KEY信息：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa -noout -text -in ca.key</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看CSR信息：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -noout -text -in ca.csr</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="kvm-开启tcp远程连接">kvm 开启tcp远程连接<a href="#kvm-开启tcp远程连接" class="hash-link" aria-label="kvm 开启tcp远程连接的直接链接" title="kvm 开启tcp远程连接的直接链接">​</a></h2>
<p>启用tcp的端口</p>
<div class="language-conf codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-conf codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">LIBVIRTD_CONFIG=/etc/libvirt/libvirtd.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIBVIRTD_ARGS=&quot;--listen&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-conf codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-conf codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">listen_tls = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen_tcp = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp_port = &quot;16509&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen_addr = &quot;0.0.0.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_tcp = &quot;none&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>连接</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">virsh -c qemu+tcp://172.16.7.254/system</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>tsl</strong></p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir pki</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd pki/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certtool --generate-privkey &gt; cakey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt;ca.info &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn = ops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ca</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert_signing_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expiration_days = 700</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cn: 组织名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># expiration_days：过期天数，默认1年</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certtool --generate-self-signed --load-privkey cakey.pem --template ca.info --outfile cacert.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certtool --generate-privkey &gt; serverkey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; server.info &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organization = ops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn = server22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip_address = 172.16.7.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tls_www_server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encryption_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signing_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expiration_days = 700</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># organization: 组织名，和ca中的cn一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cn: kvm服务器的hostname，需要能ping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ip_address: kvm服务器的ip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># expiration_days: 证书过期时间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certtool --generate-certificate --load-privkey serverkey.pem --load-ca-certificate cacert.pem --load-ca-privkey cakey.pem --template server.info --outfile servercert.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certtool --generate-privkey &gt; clientkey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt;client.info &lt;&lt;EOF </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">country = CN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">state = GD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">locality = SZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organization = ops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cn = server22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tls_www_server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encryption_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signing_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expiration_days = 700</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certtool --generate-certificate --load-privkey clientkey.pem --load-ca-certificate cacert.pem --load-ca-privkey cakey.pem --template client.info --outfile clientcert.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp servercert.pem /etc/pki/libvirt/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp serverkey.pem /etc/pki/libvirt/private/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp cacert.pem /etc/pki/CA/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scp cacert.pem root@172.16.7.14:/etc/pki/CA/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scp clientcert.pem root@172.16.7.14:/etc/pki/libvirt/clientcert.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scp clientkey.pem  root@172.16.7.14:/etc/pki/libvirt/clientkey.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vim /etc/sysconfig/libvirtd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#libvirtd启动时添加--listen参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIBVIRTD_ARGS=&quot;--listen&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>链接：</p>
<ul>
<li><a href="https://www.cnblogs.com/jinyuanliu/p/11244876.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/jinyuanliu/p/11244876.html</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="vim进入块编辑模式">vim进入块编辑模式<a href="#vim进入块编辑模式" class="hash-link" aria-label="vim进入块编辑模式的直接链接" title="vim进入块编辑模式的直接链接">​</a></h2>
<p>wsl：ctrl+q</p>
<p>linux：ctrl+v or ctrl+shift+v</p>
<p>批量编辑内容：按方向键选中要编辑的行 shift+i 编辑输入内容然后按两下esc</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装python">安装python<a href="#安装python" class="hash-link" aria-label="安装python的直接链接" title="安装python的直接链接">​</a></h2>
<p>debian：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">apt install gcc g++ make libssl-dev libsqlite3-dev libreadline-dev libffi-dev zlib1g-dev libbz2-dev</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>centos：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y zlib-devel bzip2-devel readline-devel sqlite-devel openssl-devel libffi-devel</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>ModuleNotFoundError: No module named &#x27;_ctypes&#x27;</code>    需要安装libffi然后重新编译</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看使用swap进程">查看使用swap进程<a href="#查看使用swap进程" class="hash-link" aria-label="查看使用swap进程的直接链接" title="查看使用swap进程的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">for i in $(cd /proc;ls | grep &quot;^[0-9]&quot; | awk &#x27;$0&gt;100&#x27;); do awk &#x27;/Swap:/{a=a+$2}END{print &#x27;&quot;$i&quot;&#x27;,a/1024&quot;M&quot;}&#x27; /proc/$i/smaps;done| sort -k2nr | head</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复  制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="esxi-安装megacli">esxi 安装MegaCli<a href="#esxi-安装megacli" class="hash-link" aria-label="esxi 安装MegaCli的直接链接" title="esxi 安装MegaCli的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">esxcli software vib install -v=/tmp/vmware-esx-MegaCli-8.07.06.vib -f --maintenance-mode</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>链接：</p>
<ul>
<li><a href="https://www.broadcom.com/" target="_blank" rel="noopener noreferrer">https://www.broadcom.com/</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="omsa">omsa<a href="#omsa" class="hash-link" aria-label="omsa的直接链接" title="omsa的直接链接">​</a></h2>
<p><strong>简介</strong></p>
<p>OMSA全称为Dell OpenManage Server Administrator，专为系统管理员设计，可用于管理本地系统及网络中的远程系统。OMSA提供了一个全面的一对一系统管理解决方案包，可使系统管理员专注于整个网络的管理工作。</p>
<p>OMSA系统管理方案可以全面解决系统管理人员最关心的系统部署、系统监控和系统变更三大系统管理问题。它通过提供以下两种方式来对本地和远程的服务器进行管理和监控。</p>
<p>1、基于Web浏览器的集成图形用户界面(GUI)</p>
<p>2、操作系统的命令行界面(CLI)工具</p>
<p><strong>安装omsa</strong></p>
<ol>
<li>
<p>完整版安装</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#安装omsa的源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget -q -O - http://linux.dell.com/repo/hardware/latest/bootstrap.cgi | bash</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install srvadmin-all    # 安装所有软件包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install srvadmin-base    # 只安装OMSA基础服务，不包括web管理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install srvadmin-omacore    # 安装CLI命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install srvadmin-webserver    # 安装web管理组件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install srvadmin-storageservices    # 安装RAID控制卡管理组件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install srvadmin-rac4    # 安装远程控制卡4管理组件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install srvadmin-rac5    # 安装远程控制卡5管理组件</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>所有的软件包将被安装至/opt目录下，虽然 OMSA 的web端功能很强大，但是在工作当中，我们的主要目的并非是使用它的web端，更多时间只是想使用它提供的一些命令行工具来获取服务器主要组件的相关信息，比如CPU、内存、硬盘、陈列和主板温度之类的健康状况。因此，我们没有必要安装OMSA的web端，所以如果只是做监控，安装<code>srvadmin-base、srvadmin-omacore及srvadmin-storageservices</code>即可。。</p>
</li>
<li>
<p>精简版</p>
<p>正常情况下，直接Yum安装即可，但是现阶段srvadmin的源在国外，下载慢，同时还有一些内网机器不能直接通外网，只能把包下载下来，然后直接安装。参考了<a href="https://www.dell.com/support/manuals/cn/zh/cnbsd1/openmanage-software-v9.1.2/om_linux_9.1.2_install_guide/%E5%8D%95%E4%B8%AA%E7%BB%84%E4%BB%B6%E7%9A%84-rpm?guid=guid-ad662d47-9b32-4b9c-a714-90d419276a25&amp;lang=zh-cn" target="_blank" rel="noopener noreferrer">单个组件的-rpm</a>这里面的说明（或者<a href="https://topics-cdn.dell.com/pdf/openmanage-server-administrator-v93_install-guide2_zh-cn.pdf%EF%BC%89%EF%BC%8C%E5%88%B6%E4%BD%9C%E5%87%BA%E6%9D%A5%E4%BA%86%E7%B2%BE%E7%AE%80%E7%89%88%E7%9A%84omsa" target="_blank" rel="noopener noreferrer">https://topics-cdn.dell.com/pdf/openmanage-server-administrator-v93_install-guide2_zh-cn.pdf），制作出来了精简版的omsa</a> 9.3.0版本。具体的rpm的安装包如下：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">Updating / installing...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1:srvadmin-omilcore-9.3.0-3465.1481################################# [  3%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   2:srvadmin-deng-9.3.0-3465.14818.el################################# [  7%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   3:srvadmin-omacs-9.3.0-3465.14818.e################################# [ 10%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   4:srvadmin-xmlsup-9.3.0-3465.14818.################################# [ 14%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   5:srvadmin-hapi-9.3.0-3465.14818.el################################# [ 17%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   6:srvadmin-isvc-9.3.0-3465.14818.el################################# [ 21%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   7:srvadmin-sysfsutils-9.3.0-3465.14################################# [ 24%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   8:srvadmin-smcommon-9.3.0-3465.1481################################# [ 28%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   9:srvadmin-deng-snmp-9.3.0-3465.148################################# [ 31%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  10:srvadmin-isvc-snmp-9.3.0-3465.148################################# [ 34%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11:srvadmin-ominst-9.3.0-3465.14818.################################# [ 38%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  12:srvadmin-omcommon-9.3.0-3465.1481################################# [ 41%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  13:srvadmin-omacore-9.3.0-3465.14818################################# [ 45%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  14:srvadmin-storelib-sysfs-9.3.0-346################################# [ 48%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  15:srvadmin-storelib-9.3.0-3465.1481################################# [ 52%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  16:srvadmin-realssd-9.3.0-3465.14818################################# [ 55%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  17:srvadmin-nvme-9.3.0-3465.14818.el################################# [ 59%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  18:srvadmin-marvellib-9.3.0-3465.148################################# [ 62%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  19:srvadmin-storage-9.3.0-3465.14818################################# [ 66%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  20:srvadmin-storage-cli-9.3.0-3465.1################################# [ 69%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  21:srvadmin-storageservices-cli-9.3.################################# [ 72%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  22:srvadmin-storage-snmp-9.3.0-3465.################################# [ 76%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  23:srvadmin-storageservices-snmp-9.3################################# [ 79%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  24:srvadmin-argtable2-9.3.0-3465.148################################# [ 83%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  25:libsmbios-2.3.3-8.el7            ################################# [ 86%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  26:smbios-utils-bin-2.3.3-8.el7     ################################# [ 90%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  27:srvadmin-idracadm7-9.3.0-3465.148################################# [ 93%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  28:srvadmin-storageservices-9.3.0-34################################# [ 97%]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  29:syscfg-6.3.0-3465.14818.el7      ################################# [100%]</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>一共29个包，包括了<code>omreport、syscfg、racadm7</code>等命令。其中libsmbios、smbios-utils-bin可以通过yum进行安装。</p>
<p>下载包的地址：<a href="https://linux.dell.com/repo/hardware/dsu/os_dependent/" target="_blank" rel="noopener noreferrer">https://linux.dell.com/repo/hardware/dsu/os_dependent/</a> ，还有一个方法下载包，下载omsa源，然后使用<code>yumdownloader</code>的方法下载包。或者直接访问<code>https://linux.dell.com/repo/hardware/latest/mirrors.cgi?osname=el7&amp;basearch=x86_64&amp;native=1</code>会出现真实的下载地址。再次访问出现的URL就可以下载最新的OMSA的安装包了。el7表示centos7系统。</p>
</li>
</ol>
<p><strong>OMSA CLI常用命令</strong></p>
<p>查看bmc以及bios设置的查看方法：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/opt/dell/srvadmin/sbin/srvadmin-services.sh start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt/dell/srvadmin/sbin/omreport chassis bmc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt/dell/srvadmin/sbin/omreport chassis bmc config=nic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt/dell/srvadmin/sbin/omreport chassis biossetup</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其他相关命令可以使用<code>/opt/dell/srvadmin/sbin/omreport -?</code>来获取命令帮助。其他命令可以参考<a href="https://www.cnblogs.com/LuckWJL/p/10154732.html" target="_blank" rel="noopener noreferrer">戴尔服务器使用omreport（OMSA）查看监控硬件信息</a></p>
<p>查询性能模式：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost ~]# /opt/dell/srvadmin/sbin/omreport chassis biossetup |sed -n &#x27;/System Profile Settings/,/System Security/p&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System Profile Settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System Profile                                    : Performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CPU Power Management                              : Maximum Performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Memory Frequency                                  : Maximum Performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Turbo Boost                                       : Enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C1E                                               : Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C States                                          : Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Monitor/Mwait                                     : Enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Memory Patrol Scrub                               : Standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Memory Refresh Rate                               : 1x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Memory Operating Voltage                          : Auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Collaborative CPU Performance Control             : Disabled</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>racadm也是可以获取到这个信息：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost ~]# /opt/dell/srvadmin/bin/idracadm7 get BIOS.SysProfileSettings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Key=BIOS.Setup.1-1#SysProfileSettings]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MemFrequency=MaxPerf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MemPatrolScrub=Standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MemRefreshRate=1x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProcC1E=Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProcCStates=Disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProcPwrPerf=MaxPerf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProcTurboMode=Enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SysProfile=PerfOptimized</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>syscfg也是可以：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost ~]# /opt/dell/toolkit/bin/syscfg --ProcPwrPerf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProcPwrPerf=maxperf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@localhost ~]# /opt/dell/toolkit/bin/syscfg --SysProfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SysProfile=perfoptimized</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>参考：</p>
<p><a href="https://blog.51cto.com/nolinux/1664664" target="_blank" rel="noopener noreferrer">服务器硬件监控之OMSA</a></p>
<p><a href="http://www.madown.com/2017/05/23/81/" target="_blank" rel="noopener noreferrer">DELL OpenManage Server Administrator安装及使用</a></p>
<p><a href="http://linux.dell.com/repo/hardware/latest/" target="_blank" rel="noopener noreferrer">dell omsa官方店</a></p>
<p><a href="https://salogs.com/news/2018/06/21/install-dell-omsa/" target="_blank" rel="noopener noreferrer">CentOS 7.x 安装 Dell OMSA 与监控</a></p>
<p><a href="https://www.dell.com/support/home/us/en/04/product-support/product/openmanage-server-administrator-v9.3/docs" target="_blank" rel="noopener noreferrer">dell omsa官方文档</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="mysql-日志为utc时间">mysql 日志为utc时间<a href="#mysql-日志为utc时间" class="hash-link" aria-label="mysql 日志为utc时间的直接链接" title="mysql 日志为utc时间的直接链接">​</a></h2>
<p>设置为系统时间：</p>
<ul>
<li>
<p>通过配置文件</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[mysqld]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_timestamps=SYSTEM</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>在线设置</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> log_timestamps</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">SYSTEM</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>查看当前配置</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> variables </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;log_timestamps&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="kvm嵌套虚拟化">kvm嵌套虚拟化<a href="#kvm嵌套虚拟化" class="hash-link" aria-label="kvm嵌套虚拟化的直接链接" title="kvm嵌套虚拟化的直接链接">​</a></h2>
<p>虚拟机cpu模式必须为 <code>host-modle</code> 或 <code>host-passthrough</code></p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># 查看是否启用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/module/kvm_intel/parameters/nested</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 添加启用配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vi /etc/modprobe.d/kvm-nested.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options kvm-intel nested=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options kvm-intel enable_shadow_vmcs=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options kvm-intel enable_apicv=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options kvm-intel ept=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 重载模块</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modprobe -r kvm_intel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modprobe -a kvm_intel</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="run-django脚本">run django脚本<a href="#run-django脚本" class="hash-link" aria-label="run django脚本的直接链接" title="run django脚本的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">project_name=&#x27;ds_backend&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pid_path=&quot;$project_name.pid&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logs_path=&#x27;logs&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source  venv/bin/activate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stop(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ -f $pid_path ] &amp;&amp; pid=`cat $pid_path` &amp;&amp; [ `ps -ef|grep $pid|grep -v grep|wc -l` -gt 0 ] &amp;&amp; kill $pid || echo &quot;$project_name not runing&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ ! -d $logs_path ] &amp;&amp; mkdir $logs_path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gunicorn -p $pid_path --log-file $logs_path/$project_name.log --access-logfile &#x27;-&#x27; --capture-output -D $project_name.wsgi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">status(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ -f $pid_path ] &amp;&amp; pid=`cat $pid_path` &amp;&amp; [ `ps -ef|grep $pid|grep -v grep|wc -l` -gt 0 ] &amp;&amp; echo &quot;$project_name is runing: $pid&quot; || echo &quot;$project_name not runing&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">restart(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ -f $pid_path ] &amp;&amp; pid=`cat $pid_path` &amp;&amp; [ `ps -ef|grep $pid|grep -v grep|wc -l` -gt 0 ] &amp;&amp; kill $pid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">case $1 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start) restart;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stop) stop;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">status) status;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">restart) restart;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;Usage: sh $0 {start|stop|status|restart}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">esac</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴  板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="nginx静态资源配置">nginx静态资源配置<a href="#nginx静态资源配置" class="hash-link" aria-label="nginx静态资源配置的直接链接" title="nginx静态资源配置的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 图片、视频</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|flv|mp4|ico)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expires 30d;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      access_log off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 字体</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ .*\.(eot|ttf|otf|woff|svg)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expires 30d;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      access_log off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # js、css</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location ~ .*\.(js|css)?$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expires 7d;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      access_log off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="zabbix-微信脚本">zabbix 微信脚本<a href="#zabbix-微信脚本" class="hash-link" aria-label="zabbix 微信脚本的直接链接" title="zabbix 微信脚本的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#https://work.weixin.qq.com/api/doc/90000/90135/90236#%E6%96%87%E6%9C%AC%E6%B6%88%E6%81%AF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CorpID=&#x27;wxe464964f5ce6d80d&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Secret=&#x27;NUJkJytNlone5r0qDUT6Rua082yePex4uO1vazLd-UA&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GURL=&quot;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=$CorpID&amp;corpsecret=$Secret&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gtoken=$(/usr/bin/curl -s -G $GURL | awk -F\&quot; &#x27;{print $10}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PURL=&quot;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=$Gtoken&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/curl --data-ascii &quot;$(cat &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;touser&quot;: &quot;${1//,/|}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;toparty&quot;: &quot;2&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;msgtype&quot;: &quot;text&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;agentid&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;text&quot;: {&quot;content&quot;: &quot;$2\n\n${3//\&quot;/}&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)&quot; $PURL</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="jenkins-pipeline">jenkins pipeline<a href="#jenkins-pipeline" class="hash-link" aria-label="jenkins pipeline的直接链接" title="jenkins pipeline的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pipeline {  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  agent {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 执行节点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    node {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      label &#x27;master&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 定义环境变量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  environment {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 您 Docker Hub 仓库的地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REGISTRY = &#x27;docker.io&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 您的 Docker Hub 用户名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DOCKERHUB_USERNAME = &#x27;yyxx&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Docker 镜像名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    APP_NAME = &#x27;devops-go-sample&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 使用credentials 获取KubeSphere创建的凭证， docker 是您在 KubeSphere 用 Docker Hub 访问令牌创建的凭证 ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DOCKERHUB_CREDENTIAL = credentials(&#x27;docker&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 您在 KubeSphere 创建的 kubeconfig 凭证 ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    KUBECONFIG_CREDENTIAL_ID = &#x27;kubeconfig&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 您在 KubeSphere 创建的项目名称，不是 DevOps 工程名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PROJECT_NAME = &#x27;ops&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 重试3次</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options { retry(3) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  stages {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 步骤1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stage(&#x27;docker login&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      steps{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sh &#x27;echo $DOCKERHUB_CREDENTIAL_PSW  | docker login -u $DOCKERHUB_CREDENTIAL_USR --password-stdin&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 步骤2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stage(&#x27;build &amp; push&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      steps {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sh &#x27;git clone https://github.com/GavinTan/devops-go-sample.git&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sh &#x27;cd devops-go-sample &amp;&amp; docker build -t $REGISTRY/$DOCKERHUB_USERNAME/$APP_NAME .&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sh &#x27;docker push $REGISTRY/$DOCKERHUB_USERNAME/$APP_NAME&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  post {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 失败后执行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    failure {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      echo &#x27;123&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      sh &#x27;rm -rf devops-go-sample&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="终端字体">终端字体<a href="#终端字体" class="hash-link" aria-label="终端字体的直接链接" title="终端字体的直接链接">​</a></h2>
<p>添加字体到/usr/share/fonts</p>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/dejavu-fonts-ttf-2.37.zip" target="_blank" rel="noopener noreferrer">dejavu-fonts-ttf-2.37.zip</a></p>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/Menlo.zip" target="_blank" rel="noopener noreferrer">Menlo.zip</a></p>
<p>生成字体索引缓存</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mkfontscale &amp;&amp; mkfontdir &amp;&amp; fc-cache</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="django导入默认数据">django导入默认数据<a href="#django导入默认数据" class="hash-link" aria-label="django导入默认数据的直接链接" title="django导入默认数据的直接链接">​</a></h2>
<p>JSON：</p>
<div class="language-json codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-json codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;model&quot;: &quot;myapp.person&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;pk&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;fields&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;first_name&quot;: &quot;John&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;last_name&quot;: &quot;Lennon&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;model&quot;: &quot;myapp.person&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;pk&quot;: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;fields&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;first_name&quot;: &quot;Paul&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;last_name&quot;: &quot;McCartney&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>YAML：</p>
<div class="language-yaml codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-yaml codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp.person</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pk</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">fields</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">first_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> John</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">last_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Lennon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">model</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp.person</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pk</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">fields</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">first_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Paul</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">last_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> McCartney</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>导入数据：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">python manage.py loaddata data.json</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>参考：<a href="https://docs.djangoproject.com/zh-hans/3.2/howto/initial-data/" target="_blank" rel="noopener noreferrer">https://docs.djangoproject.com/zh-hans/3.2/howto/initial-data/</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="mysql查看数据库占用大小">mysql查看数据库占用大小<a href="#mysql查看数据库占用大小" class="hash-link" aria-label="mysql查看数据库占用大小的直接链接" title="mysql查看数据库占用大小的直接链接">​</a></h2>
<p>查出所有的数据库的占用空间是多少MB</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_schema </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;数据库&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_rows</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;记录数&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;数据容量(MB)&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;索引容量(MB)&#x27;</span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> table_schema</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看所有的数据库以及该数据库下各个表的占用的空间是多少MB以及各个表的记录数</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_schema </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;数据库&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_name </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;表名&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_rows </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;记录数&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;数据容量(MB)&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;索引容量(MB)&#x27;</span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> data_length </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index_length </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看某个数据库的记录数以及占用的空间是多少MB</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_schema </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;数据库&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_rows</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;记录数&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;数据容量(MB)&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;索引容量(MB)&#x27;</span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> table_schema</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;mysql&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看某个数据库的各个表占用的空间是多少MB</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_schema </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;数据库&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_name </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;表名&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_rows </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;记录数&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;数据容量(MB)&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;索引容量(MB)&#x27;</span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> table_schema</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;mysql&#x27;</span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> data_length </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index_length </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="sendmail发送邮件">sendmail发送邮件<a href="#sendmail发送邮件" class="hash-link" aria-label="sendmail发送邮件的直接链接" title="sendmail发送邮件的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SMTP_server=&#x27;smtp.163.com&#x27;    # SMTP服务器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=&#x27;good_zabbix@163.com&#x27;     # 用户名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=&#x27;URMAXCTGAXGLFIVQ&#x27;             # 密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from_email_address=&#x27;good_zabbix@163.com&#x27; # 发件人Email地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">to_email_address=&quot;$1&quot;               # 收件人Email地址，zabbix传入的第一个参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message_subject_utf8=&quot;$2&quot;           # 邮件标题，zabbix传入的第二个参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message_body_utf8=&quot;$3&quot;              # 邮件内容，zabbix传入的第三个参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 转换邮件标题为GB2312，解决邮件标题含有中文，收到邮件显示乱码的问题。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message_subject_gb2312=`iconv -t GB2312 -f UTF-8 &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$message_subject_utf8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ $? -eq 0 ] &amp;&amp; message_subject=&quot;$message_subject_gb2312&quot; || message_subject=&quot;$message_subject_utf8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 转换邮件内容为GB2312</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message_body_gb2312=`iconv -t GB2312 -f UTF-8 &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$message_body_utf8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ $? -eq 0 ] &amp;&amp; message_body=&quot;$message_body_gb2312&quot; || message_body=&quot;$message_body_utf8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 发送邮件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sendEmail=&#x27;/usr/local/sendEmail/sendEmail&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sendEmail -s &quot;$SMTP_server&quot; -xu &quot;$username&quot; -xp &quot;$password&quot; -f &quot;$from_email_address&quot; -t &quot;$to_email_address&quot; -u &quot;$message_subject&quot; -m &quot;$message_body&quot; -o message-content-type=text -o message-charset=gb2312 -o tls=no</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/sendEmail-v1.56.tar.gz" target="_blank" rel="noopener noreferrer">sendEmail-v1.56.tar.gz</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="生成随机密码">生成随机密码<a href="#生成随机密码" class="hash-link" aria-label="生成随机密码的直接链接" title="生成随机密码的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">tr -dc \~\`\!@#\$\%\^\&amp;\*\(\)\-\_\+\=\|\\\?\/\.\&gt;\,\&lt;A-Za-z0-9_ &lt; /dev/urandom|head -c *|xargs</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pwgen * 1</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mkpasswd -l *</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rand -base64 *</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>*</code>为多少位数</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="django重建表">django重建表<a href="#django重建表" class="hash-link" aria-label="django重建表的直接链接" title="django重建表的直接链接">​</a></h2>
<p>删除数据库所有表以及app目录下migrations文件夹，重新执行下面命令</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">python manage.py makemigrations --empt appname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python manage.py makemigrations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python manage.py migrate</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="tlbb">tlbb<a href="#tlbb" class="hash-link" aria-label="tlbb的直接链接" title="tlbb的直接链接">​</a></h2>
<p><a href="https://github.com/yulinzhihou/gstlenv" target="_blank" rel="noopener noreferrer">https://github.com/yulinzhihou/gstlenv</a></p>
<p><a href="https://gitee.com/zhao-kai135/one-key" target="_blank" rel="noopener noreferrer">https://gitee.com/zhao-kai135/one-key</a></p>
<p><a href="https://github.com/liuguangw/billing_go" target="_blank" rel="noopener noreferrer">https://github.com/liuguangw/billing_go</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="es修改日志按天数保留">es修改日志按天数保留<a href="#es修改日志按天数保留" class="hash-link" aria-label="es修改日志按天数保留的直接链接" title="es修改日志按天数保留的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># 默认是按大小2GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># appender.rolling.strategy.action.condition.nested_condition.type = IfAccumulatedFileSize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># appender.rolling.strategy.action.condition.nested_condition.exceeds = 2GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">appender.rolling.strategy.action.condition.nested_condition.type = IfLastModified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">appender.rolling.strategy.action.condition.nested_condition.age = 7D</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="清理cache占用大量内存">清理cache占用大量内存<a href="#清理cache占用大量内存" class="hash-link" aria-label="清理cache占用大量内存的直接链接" title="清理cache占用大量内存的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">              total        used        free      shared  buff/cache   available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mem:          125Gi       999Mi       120Gi       4.0Gi       4.2Gi       119Gi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Swap:         8.0Gi       3.0Mi       8.0Gi</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>available</code>表示应用程序还可以申请到的内存</p>
<p>首先了解下两个概念buff和cache</p>
<ul>
<li>buff（Buffer Cache）是一种I/O缓存，用于内存和硬盘的缓冲，是io设备的读写缓冲区。根据磁盘的读写设计的，把分散的写操作集中进行，减少磁盘碎片和硬盘的反复寻道，从而提高系统性能。</li>
<li>cache（Page Cache）是一种高速缓存，用于CPU和内存之间的缓冲 ,是文件系统的cache。把读取过的数据保存起来，重新读取时若命中（找到需要的数据）就不要去读硬盘了，若没有命中就读硬盘。其中的数据会根据读取频率进行组织，把最频繁读取的内容放在最容易找到的位置，把不再读的内容不断往后排，直至从中删除。</li>
</ul>
<p>它们都是占用内存。两者都是RAM中的数据。简单来说，buff是即将要被写入磁盘的，而cache是被从磁盘中读出来的。</p>
<p>目前进程正在实际被使用的内存的计算方式为used-buff/cache，通过释放buff/cache内存后，我们还可以使用的内存量free+buff/cache。通常我们在频繁存取文件后，会导致buff/cache的占用量增高。</p>
<p><strong>Linux默认使用的是lazy模式，即内存如果还够用，则不会主动释放当前的占用的buffer和cache，如果需要内存，则会自动释放buffer和cache，所以正常情况下，cache占用高不会对系统造成影响。</strong></p>
<p>手动清除：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">sync;sync;sync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 3 &gt; /proc/sys/vm/drop_caches</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>sync：将所有未写的系统缓冲区写到磁盘中，包含已修改的i-node、已延迟的块I/O和读写映射文件</li>
<li>echo 1 &gt; /proc/sys/vm/drop_caches：清除page cache</li>
<li>echo 2 &gt; /proc/sys/vm/drop_caches：清除回收slab分配器中的对象（包括目录项缓存和inode缓存）。slab分配器是内核中管理内存的一种机制，其中很多缓存数据实现都是用的pagecache。</li>
<li>echo 3 &gt; /proc/sys/vm/drop_caches：清除pagecache和slab分配器中的缓存对象。/proc/sys/vm/drop_caches的值,默认为0</li>
</ul>
<p>定时清除脚本：</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#每两小时清除一次缓存</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;开始清除缓存&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sync;sync;sync #写入硬盘，防止数据丢失</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep 10 #延迟10秒</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; /proc/sys/vm/drop_caches</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 2 &gt; /proc/sys/vm/drop_caches</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 3 &gt; /proc/sys/vm/drop_caches</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="nfs">nfs<a href="#nfs" class="hash-link" aria-label="nfs的直接链接" title="nfs的直接链接">​</a></h2>
<p>安装：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install nfs-utils</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置文件：</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/data/nfs-data 172.16.7.0/24(rw,sync,no_root_squash)</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>启动：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable rpcbind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable nfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start rpcbind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start nfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --zone=public --permanent --add-service={rpc-bind,mountd,nfs}success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --reload</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>常用：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># 重新加载/etc/exports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exportfs -r</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看nfs服务器目录列表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">showmount -e 172.16.7.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 挂载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -t nfs 172.16.7.14:/data/nfs-data /data/test</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置参数：</p>
<ul>
<li>172.16.7.0/24： 访问网段限制；</li>
<li>ro：共享目录只读；</li>
<li>rw：共享目录可读可写；</li>
<li>all_squash：所有访问用户都映射为匿名用户或用户组；</li>
<li>no_all_squash（默认）：访问用户先与本机用户匹配，匹配失败后再映射为匿名用户或用户组；</li>
<li>root_squash（默认）：将来访的root用户映射为匿名用户或用户组；</li>
<li>no_root_squash：来访的root用户保持root帐号权限；</li>
<li>anonuid=UID：指定匿名访问用户的本地用户UID，默认为nfsnobody（65534）；</li>
<li>anongid=GID：指定匿名访问用户的本地用户组GID，默认为nfsnobody（65534）；</li>
<li>secure（默认）：限制客户端只能从小于1024的tcp/ip端口连接服务器；</li>
<li>insecure：允许客户端从大于1024的tcp/ip端口连接服务器；</li>
<li>sync：将数据同步写入内存缓冲区与磁盘中，效率低，但可以保证数据的一致性；</li>
<li>async：将数据先保存在内存缓冲区中，必要时才写入磁盘；</li>
<li>wdelay（默认）：检查是否有相关的写操作，如果有则将这些写操作一起执行，这样可以提高效率；</li>
<li>no_wdelay：若有写操作则立即执行，应与sync配合使用；</li>
<li>subtree_check（默认） ：若输出目录是一个子目录，则nfs服务器将检查其父目录的权限；</li>
<li>no_subtree_check ：即使输出目录是一个子目录，nfs服务器也不检查其父目录的权限，这样可以提高效率；</li>
</ul>
<p>参考：<a href="https://segmentfault.com/a/1190000008629932" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000008629932</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="systemd-模板">systemd 模板<a href="#systemd-模板" class="hash-link" aria-label="systemd 模板的直接链接" title="systemd 模板的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt; EOF &gt; /etc/systemd/system/sshd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=OpenSSH server daemon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Documentation=man:sshd(8) man:sshd_config(5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">After=network.target sshd-keygen.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Wants=sshd-keygen.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EnvironmentFile=/etc/sysconfig/sshd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/usr/sbin/sshd -D $OPTIONS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecReload=/bin/kill -HUP $MAINPID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=simple</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KillMode=process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Restart=on-failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RestartSec=42s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=multi-user.target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt; EOF &gt; /etc/systemd/system/elasticsearch_exporter.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Prometheus elasticsearch_exporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">After=local-fs.target network-online.target network.target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Wants=local-fs.target network-online.target network.target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User=root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nice=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart = /usr/local/bin/elasticsearch_exporter -es.all -es.indices -es.timeout 20s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStop= /usr/bin/killall elasticsearch_exporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=default.target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/logstash.service" target="_blank" rel="noopener noreferrer">logstash.service</a></p>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/elasticsearch.service" target="_blank" rel="noopener noreferrer">elasticsearch.service</a></p>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/bao.service" target="_blank" rel="noopener noreferrer">bao.service</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="git-初始化提交">git 初始化提交<a href="#git-初始化提交" class="hash-link" aria-label="git 初始化提交的直接链接" title="git 初始化提交的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#初始化目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#添加提交的文件目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git add .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#打tag标签init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git tag init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#本地提交</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git commit -m &quot;first commit&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#添加仓库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git remote add origin https://github.com/GavinTan/w-backend.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#提交master分支</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push --set-upstream origin master init</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="zabbix启动中文">zabbix启动中文<a href="#zabbix启动中文" class="hash-link" aria-label="zabbix启动中文的直接链接" title="zabbix启动中文的直接链接">​</a></h2>
<p>修改文件内容，将zh_cn后面的false改成true</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"> vi /var/www/html/zabbix/include/locales.inc.php </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>拷贝字体置/var/www/html/zabbix/fonts/</p>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/simkai.ttf" target="_blank" rel="noopener noreferrer">simkai.ttf</a></p>
<p>修改配置文件</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &#x27;s/DejaVuSans/simkai/g&#x27; /var/www/html/zabbix/include/defines.inc.php</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="centos7升级内核">centos7升级内核<a href="#centos7升级内核" class="hash-link" aria-label="centos7升级内核的直接链接" title="centos7升级内核的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#安装elrepo repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#安装新内核</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum --enablerepo=elrepo-kernel install -y kernel-ml.x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#安装新内核相关软件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum --disablerepo=* --enablerepo=elrepo-kernel install -y kernel-ml-devel kernel-ml-tools kernel-ml-tools-libs kernel-ml-tools-libs-devel kernel-ml-headers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#查看所有内核</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">awk -F \&#x27; &#x27;$1==&quot;menuentry &quot; {print i++ &quot; : &quot; $2}&#x27; /etc/grub2.cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#查看默认内核</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grub2-editenv list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#将新内核设为默认grbu启动项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grub2-set-default 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#生成 grub 配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grub2-mkconfig -o /etc/grub2.cfg</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>参考：<a href="http://elrepo.org/tiki/HomePage" target="_blank" rel="noopener noreferrer">http://elrepo.org/tiki/HomePage</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="smokeping">smokeping<a href="#smokeping" class="hash-link" aria-label="smokeping的直接链接" title="smokeping的直接链接">​</a></h2>
<p>图表说明：</p>
<ol>
<li>X轴表示时间，Y轴表示Ping请求时长</li>
<li>网络丢包和延迟不同的颜色和阴影表示，阴影块越大说明波动越大</li>
<li>图表中曲线上不同颜色表示丢包数、延迟不同，点击图表并选中范围可以放大</li>
</ol>
<p>参数说明：</p>
<ul>
<li>med RTT：av md 平均中位数、av ls 平均损失、av sd 每轮中多次测量的平均标准偏差、am/as 平均中位数和平均标准差的比率</li>
<li>median rtt：avg 平均值、max 最大值、min 最小值、now 当前中位数、sd 中位数的标准差、am 平均中位数与标准差的比率</li>
<li>packet loss：avg 平均值、max 最大值、min 最小值、now 当前丢包率</li>
<li>loss color：丢包颜色表示 0表示不丢包 1/20表示丢一个包</li>
<li>probe：发送的探针数据包</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="jdbc">jdbc<a href="#jdbc" class="hash-link" aria-label="jdbc的直接链接" title="jdbc的直接链接">​</a></h2>
<p>MySQL 8.0 开始数据库相比常用的 5.X 版本发生了比较大的变化，我们在连接数据库的过程中许多地方也要发生一些变化。</p>
<p>总结一下，想要利用 mysql-connector-java 与 MySQL 8.X 版本建立连接，有以下四个方面与 MySQL 5.X 版本相比发生了变化。</p>
<ol>
<li>
<p>MySQL 8.0 以上版本驱动包版本 mysql-connector-java-8.X.jar</p>
<p>MySQL 版本和 mysql-connector-java 版本对应关系如下，MySQL官方也是推荐使用 mysql-connector-java-8.X.jar 去连接 MySQL 8.0 的版本</p>
<table><thead><tr><th><strong>Connector/J version</strong></th><th><strong>Driver Type</strong></th><th><strong>JDBC version</strong></th><th><strong>MySQL Server version</strong></th><th><strong>Status</strong></th></tr></thead><tbody><tr><td>5.1</td><td>4</td><td>3.0, 4.0, 4.1, 4.2</td><td>5.6*, 5.7*, 8.0*</td><td>General availability</td></tr><tr><td>8.0</td><td>4</td><td>4.2</td><td>5.6, 5.7, 8.0</td><td>General availability. Recommended version</td></tr></tbody></table>
</li>
<li>
<p>com.mysql.jdbc.Driver 更换为 com.mysql.cj.jdbc.Driver。</p>
</li>
<li>
<p>MySQL 8.0 以上版本不需要建立 SSL 连接的，需要显式关闭。</p>
<p>MySQL 5.7 之前版本，安全性做的并不够好，比如安装时生成的root空密码账号、存在任何用户都能连接上的 test 库等，导致数据库存在较大的安全隐患。从5.7版本开始MySQL官方对这些问题逐步进行了修复，到了 MySQL 8.0 以上版本已经不需要使用 SSL 进行连接加密了。但是高版本仍然保留了这个接口，所以需要在连接的时候手动写明是否需要进行 SSL 连接，这里我们手动关闭 SSL 连接加密就OK。</p>
<p>useSSL=false</p>
</li>
<li>
<p>最后还需要设置 CST。也就是设置时区。</p>
<p>serverTimezone=UTC</p>
</li>
</ol>
<div class="language-java codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-java codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">conn=DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/test_demo?useSSL=false&amp;serverTimezone=UTC&quot;,&quot;root&quot;,&quot;password&quot;);</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="yum源">yum源<a href="#yum源" class="hash-link" aria-label="yum源的直接链接" title="yum源的直接链接">​</a></h2>
<p>阿里源：</p>
<p><a href="https://developer.aliyun.com/mirror/centos" target="_blank" rel="noopener noreferrer">https://developer.aliyun.com/mirror/centos</a>
<a href="https://developer.aliyun.com/mirror/epel" target="_blank" rel="noopener noreferrer">https://developer.aliyun.com/mirror/epel</a></p>
<p>centos6 Vault yum源：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#替换为官方Vault源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget -O /etc/yum.repos.d/CentOS-Base.repo https://static.lty.fun/%E5%85%B6%E4%BB%96%E8%B5%84%E6%BA%90/SourcesList/Centos-6-Vault-Official.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#替换为阿里云Vault镜像</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget -O /etc/yum.repos.d/CentOS-Base.repo https://static.lty.fun/%E5%85%B6%E4%BB%96%E8%B5%84%E6%BA%90/SourcesList/Centos-6-Vault-Aliyun.repo</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux生成随机数">Linux生成随机数<a href="#linux生成随机数" class="hash-link" aria-label="Linux生成随机数的直接链接" title="Linux生成随机数的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">head -c 32 /dev/random | base64</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rand -hex 32</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="python-简单http服务与ftp服务">Python 简单http服务与ftp服务<a href="#python-简单http服务与ftp服务" class="hash-link" aria-label="Python 简单http服务与ftp服务的直接链接" title="Python 简单http服务与ftp服务的直接链接">​</a></h2>
<p>http服务：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pip install SimpleHTTPAuthServer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#当前所在的文件夹设置为默认的Web目录启动http服务器，不接端口默认8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#如果当前文件夹有index.html文件，会默认显示该文件；否则，会以文件列表的形式显示目录下所有文件.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python -m SimpleHTTPServer 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#带验证的http服务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python -m SimpleHTTPAuthServer 88 ops:ops.ops123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#python3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python -m http.server 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ftp服务：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pip install pyftpdlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#当前所在的文件夹设置为默认的ftp目录启动ftp服务器，不接端口默认随机一个端口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python -m pyftpdlib -p 21</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="红帽cockpit-web管理服务器">红帽cockpit web管理服务器<a href="#红帽cockpit-web管理服务器" class="hash-link" aria-label="红帽cockpit web管理服务器的直接链接" title="红帽cockpit web管理服务器的直接链接">​</a></h2>
<p>多服务器管理</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y cockpit-dashboard</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>磁盘管理</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y cockpit-storaged</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>docker管理</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y cockpit-docker</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>kvm管理</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y cockpit-machines</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-设置时区">linux 设置时区<a href="#linux-设置时区" class="hash-link" aria-label="linux 设置时区的直接链接" title="linux 设置时区的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">export TZ=Asia/Shanghai</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="weedfs-mount">weedfs mount<a href="#weedfs-mount" class="hash-link" aria-label="weedfs mount的直接链接" title="weedfs mount的直接链接">​</a></h2>
<p>错误：mount: fusermount: exec: &quot;fusermount&quot;: executable file not found in $PATH</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install fuse</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>挂载后删除不了执行下面命令</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">fusermount -uz /data</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="获取linux-cpu核数">获取Linux cpu核数<a href="#获取linux-cpu核数" class="hash-link" aria-label="获取Linux cpu核数的直接链接" title="获取Linux cpu核数的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo $(nproc)</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="生成-100w-记录的数据文件导入mysql">生成 100w 记录的数据文件导入mysql<a href="#生成-100w-记录的数据文件导入mysql" class="hash-link" aria-label="生成 100w 记录的数据文件导入mysql的直接链接" title="生成 100w 记录的数据文件导入mysql的直接链接">​</a></h2>
<p>生成数据文件：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">python -c &quot;for i in range(1, 1+1000000): print(i)&quot; &gt; /tmp/base.txt</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>导入mysql：</p>
<div class="language-sql codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-sql codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> mydb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> tmp_table </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> id </span><span class="token keyword" style="color:#00009f">INT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">load</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">data</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">local</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">infile</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/tmp/base.txt&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">replace</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> tmp_table</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="docker安装及相关设置">docker安装及相关设置<a href="#docker安装及相关设置" class="hash-link" aria-label="docker安装及相关设置的直接链接" title="docker安装及相关设置的直接链接">​</a></h2>
<p>安装最新版（17.04 及以后的版本）：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#脚本安装</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CHANNEL=stable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -fsSL https://get.docker.com/ | sh -s -- --mirror Aliyun</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#yum安装</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install yum-utils device-mapper-persistent-data lvm2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install docker-ce</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>CentOS 7 配置加速器：</p>
<p>在文件中找到 ExecStart= 这一行，并且在其行尾添加上registry-mirror</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/usr/bin/dockerd --registry-mirror=https://registry.docker-cn.com</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="keepalived配置双机热备">keepalived配置双机热备<a href="#keepalived配置双机热备" class="hash-link" aria-label="keepalived配置双机热备的直接链接" title="keepalived配置双机热备的直接链接">​</a></h2>
<p>Master 配置：</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">! Configuration File for keepalived</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">global_defs {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   notification_email {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     acassen@firewall.loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     failover@firewall.loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     sysadmin@firewall.loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   notification_email_from Alexandre.Cassen@firewall.loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   smtp_server 192.168.200.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   smtp_connect_timeout 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   router_id LVS_DEVEL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   vrrp_skip_check_adv_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #vrrp_strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   vrrp_garp_interval 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   vrrp_gna_interval 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vrrp_script chk_nginx {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    script &quot;[ `netstat -tnulp|grep 80|wc -l` -eq 0 ] &amp;&amp; exit 1 || exit 0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interval 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight -50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fall 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vrrp_instance VI_1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state MASTER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interface ens33</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    virtual_router_id 51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    priority 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    advert_int 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    authentication {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        auth_type PASS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        auth_pass 1111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    virtual_ipaddress {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        192.168.1.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    track_script {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        chk_nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Backup 配置：</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">! Configuration File for keepalived</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">global_defs {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   notification_email {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     acassen@firewall.loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     failover@firewall.loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     sysadmin@firewall.loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   notification_email_from Alexandre.Cassen@firewall.loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   smtp_server 192.168.200.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   smtp_connect_timeout 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   router_id LVS_DEVEL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   vrrp_skip_check_adv_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #vrrp_strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   vrrp_garp_interval 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   vrrp_gna_interval 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vrrp_script chk_nginx {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    script &quot;[ `netstat -tnulp|grep 80|wc -l` -eq 0 ] &amp;&amp; exit 1 || exit 0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interval 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    weight -50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fall 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vrrp_instance VI_1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state MASTER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interface ens33</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    virtual_router_id 51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    priority 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    advert_int 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    authentication {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        auth_type PASS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        auth_pass 1111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    virtual_ipaddress {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        192.168.1.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    track_script {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        chk_nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="内网穿透">内网穿透<a href="#内网穿透" class="hash-link" aria-label="内网穿透的直接链接" title="内网穿透的直接链接">​</a></h2>
<p>1.自带随机外网域名</p>
<p><a href="https://ngrok.com/download" target="_blank" rel="noopener noreferrer">https://ngrok.com/download</a></p>
<p>2.frpc需要一台外网服务器</p>
<p><a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noopener noreferrer">https://github.com/fatedier/frp/releases</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="生成mipsel架构clash解决illegal-instruction错误">生成mipsel架构clash解决Illegal instruction错误<a href="#生成mipsel架构clash解决illegal-instruction错误" class="hash-link" aria-label="生成mipsel架构clash解决Illegal instruction错误的直接链接" title="生成mipsel架构clash解决Illegal instruction错误的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#go 安装路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOROOT=/usr/local/go/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#生成路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOPATH=/root/go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOOS=linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOARCH=mipsle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export GOMIPS=softfloat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go get -u -v github.com/Dreamacro/clash</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="openwrt">openwrt<a href="#openwrt" class="hash-link" aria-label="openwrt的直接链接" title="openwrt的直接链接">​</a></h2>
<p>修改lan ip：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ssh 192.168.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uci set network.lan.ipaddr=192.168.199.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uci commit network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifup lan</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>替换opkg源：</p>
<p>opkg源：</p>
<ul>
<li>中国科技大学教育网官方主镜像网站：<a href="http://mirrors.ustc.edu.cn/OpenWrt" target="_blank" rel="noopener noreferrer">http://mirrors.ustc.edu.cn/OpenWrt</a></li>
<li>源教育网高速镜像站点：<a href="http://openwrt.proxy.ustclug.org/" target="_blank" rel="noopener noreferrer">http://openwrt.proxy.ustclug.org/</a></li>
<li>清华大学开源软件镜像站：<a href="https://mirrors.tuna.tsinghua.edu.cn/" target="_blank" rel="noopener noreferrer">https://mirrors.tuna.tsinghua.edu.cn/</a></li>
</ul>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#替换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &#x27;s/downloads.openwrt.org/mirrors.tuna.tsinghua.edu.cn\/lede/g&#x27; /etc/opkg/distfeeds.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#还原</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &#x27;s/mirrors.tuna.tsinghua.edu.cn\/lede/downloads.openwrt.org/g&#x27; /etc/opkg/distfeeds.conf</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>管理界面中文包：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">opkg update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opkg install luci-i18n-base-zh-cn</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>wget https支持：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">opkg update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opkg install wget ca-certificates openssl-util ca-bundle</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>安装sftp：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">opkg update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opkg install openssh-sftp-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#如果你想用Bonjour/Zeroconf在网络上公布服务，让Cyberduck找到它，你可以安装公布包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opkg install announce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/init.d/announce enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/init.d/announce start</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>挂载sd /overlay：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#opkg install block-mount kmod-fs-ext4 kmod-usb-storage-extras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">opkg install kmod-sdhci kmod-sdhci-mt7620 block-mount kmod-fs-ext4 e2fsprogs fdisk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#fdisk -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.ext4 /dev/mmcblk0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount /dev/mmcblk0 /mnt </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar -C /overlay -cvf - . | tar -C /mnt -xf - </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">umount /mnt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block detect &gt; /etc/config/fstab</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">config &#x27;global&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  anon_swap       &#x27;0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  anon_mount      &#x27;0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  auto_swap       &#x27;1&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  auto_mount      &#x27;1&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  delay_root      &#x27;5&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  check_fs        &#x27;0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config &#x27;mount&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  target  &#x27;/overlay&#x27;    # 挂着路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  uuid    &#x27;f2e07f24-88e4-47a6-8635-84e6a1da2953&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option  enabled &#x27;1&#x27;  # 启用</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>创建swap：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#创建要作为swap分区的文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dd if=/dev/zero of=/root/swapfile bs=1G count=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#格式化为交换分区文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkswap /root/swapfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#启用swap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">swapon /root/swapfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#关闭swap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">swapoff</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">config swap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    option device   /root/swapfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    option enabled  1</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="命令行json格式化输出">命令行json格式化输出<a href="#命令行json格式化输出" class="hash-link" aria-label="命令行json格式化输出的直接链接" title="命令行json格式化输出的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://www.example.com | python -m json.tool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;{&quot;action&quot;: &quot;update_db&quot;, &quot;data&quot;: {&quot;project&quot;: &quot;dalmatian&quot;, &quot;env&quot;: &quot;test&quot;,&quot;sqlfile_list&quot;: [&quot;t3.sql&quot;]}}&#x27; | python -m json.tool</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="docker添加中文支持">docker添加中文支持<a href="#docker添加中文支持" class="hash-link" aria-label="docker添加中文支持的直接链接" title="docker添加中文支持的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># docker-compose.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version: &#x27;3.3&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lam:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    build: .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #image: ldapaccountmanager/lam:stable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - &quot;8088:80&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#      LC_ALL: &quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#      LANG: &quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#      LANGUAGE: &quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Dockerfile  - debian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM ldapaccountmanager/lam:stable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get install -y locales locales-all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV LC_ALL  zh_CN.utf8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV LANG  zh_CN.utf8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV LANGUAGE  zh_CN.utf8</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="git撤销commit到未提交状态">git撤销commit到未提交状态<a href="#git撤销commit到未提交状态" class="hash-link" aria-label="git撤销commit到未提交状态的直接链接" title="git撤销commit到未提交状态的直接链接">​</a></h2>
<p>如何把最后一次commit撤销回Changes not staged和Untracked files区呢？</p>
<p>有3种情况：</p>
<ol>
<li>
<p>把最后的commit切回<strong>Changes to be committed</strong>状态，使用命令：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">git reset --soft HEAD^</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>把最后的commit切回<strong>Changes not staged for commit</strong>状态，使用命令：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">git reset HEAD^</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>把<strong>Changes to be committed</strong>状态切回<strong>Changes not staged for commit</strong>状态，使用命令：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">git reset HEAD &lt;file&gt;... # 单个文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git reset HEAD -- . # 所有Changes to be committed的文件</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>参考：<a href="https://www.awaimai.com/2383.html" target="_blank" rel="noopener noreferrer">https://www.awaimai.com/2383.html</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="git上传可执行文件">git上传可执行文件<a href="#git上传可执行文件" class="hash-link" aria-label="git上传可执行文件的直接链接" title="git上传可执行文件的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># Stage the script.sh file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git add script.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Flag it as executable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git update-index --chmod=+x script.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Commit the change</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git commit -m &quot;Make script.sh executable.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Push the commit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="python命令行不能使用方向键">python命令行不能使用方向键<a href="#python命令行不能使用方向键" class="hash-link" aria-label="python命令行不能使用方向键的直接链接" title="python命令行不能使用方向键的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">apt install libreadline-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt install libncurses-dev</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>编译python之前安装上面两个包</code></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="nginx配置websocket">nginx配置websocket<a href="#nginx配置websocket" class="hash-link" aria-label="nginx配置websocket的直接链接" title="nginx配置websocket的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_pass http://backend;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_http_version 1.1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header Upgrade $http_upgrade;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header Connection &quot;upgrade&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>proxy_read_timeout 60s;       # 默认情况下，如果代理服务器在60秒内未传输任何数据，则将关闭连接，可修改此参数增加超时时间</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装twisted模块">安装twisted模块<a href="#安装twisted模块" class="hash-link" aria-label="安装twisted模块的直接链接" title="安装twisted模块的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m pip install git+git://github.com/twisted/twisted.git</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="删除git上指定目录">删除git上指定目录<a href="#删除git上指定目录" class="hash-link" aria-label="删除git上指定目录的直接链接" title="删除git上指定目录的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#将远程仓库里面的项目拉下来</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git pull origin master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#删除target文件夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git rm -r --cached target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#提交</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git commit -m &#x27;删除了target&#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#将本次更改更新到git上去</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push -u origin master</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>本地项目中的target文件夹不收操作影响,删除的只是远程仓库中的target</code></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="进入目录自动载入-python-虚拟环境配置">进入目录自动载入 Python 虚拟环境配置<a href="#进入目录自动载入-python-虚拟环境配置" class="hash-link" aria-label="进入目录自动载入 Python 虚拟环境配置的直接链接" title="进入目录自动载入 Python 虚拟环境配置的直接链接">​</a></h2>
<p>using git:</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/kennethreitz/autoenv.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;source /opt/autoenv/activate.sh&#x27; &gt;&gt; ~/.bashrc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/.bashrc</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>using pip:</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pip install autoenv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;source `which activate.sh`&quot; &gt;&gt; ~/.bashrc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source ~/.bashrc</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置目录下.env文件：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;source /opt/py3/bin/activate&quot; &gt; /opt/jumpserver/.env</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/activate.sh" target="_blank" rel="noopener noreferrer">activate.sh</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="生成ssh密钥">生成ssh密钥<a href="#生成ssh密钥" class="hash-link" aria-label="生成ssh密钥的直接链接" title="生成ssh密钥的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen -t rsa</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="tutum">tutum<a href="#tutum" class="hash-link" aria-label="tutum的直接链接" title="tutum的直接链接">​</a></h2>
<p>mba811/tutum-hello-world</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="mongodb数据迁移">mongodb数据迁移<a href="#mongodb数据迁移" class="hash-link" aria-label="mongodb数据迁移的直接链接" title="mongodb数据迁移的直接链接">​</a></h2>
<p>导出数据：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mongodump -h ip:port -u testUser -p testPwd -d testDB -o /tmp/mongodb/test.dump</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>导入数据：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mongorestore -u testUser -p testPwd -d testDB /tmp/mongodb/test.dump/testDB</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="percona-server-57-安装">percona-server-5.7 安装<a href="#percona-server-57-安装" class="hash-link" aria-label="percona-server-5.7 安装的直接链接" title="percona-server-5.7 安装的直接链接">​</a></h2>
<p>编译安装：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#安装所需组件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y zlib-devel readline-devel ncurses-devel gcc-c++ gcc git libaio-devel cmake</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#编译</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar zxf percona-server-5.7.21-20.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd percona-server-5.7.21-20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/percona -DCMAKE_BUILD_TYPE=RelWithDebInfo -DBUILD_CONFIG=mysql_release -DFEATURE_SET=community -DWITH_EMBEDDED_SERVER=OFF -DDOWNLOAD_BOOST=1 -DWITH_BOOST=.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make -j &amp;&amp; make install</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>yum安装：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install http://www.percona.com/downloads/percona-release/redhat/0.1-4/percona-release-0.1-4.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install Percona-Server-server-57</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>初始化：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#获取默认临时密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /var/log/mysqld.log | grep &quot;A temporary password&quot; | awk -F &quot; &quot; &#x27;{print$11}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#修改安全策略密码复杂度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 0     【长度】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1     【 长度;数字、小写/大写和特殊字符】  默认</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2     【 长度;数字、小写/大写和特殊字符;字典文件】</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql -uroot -p -e &#x27;set global validate_password_policy=0;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#安全配置向导</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql_secure_installation</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="find使用">find使用<a href="#find使用" class="hash-link" aria-label="find使用的直接链接" title="find使用的直接链接">​</a></h2>
<p>find获取文件名：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">find /root -name *.jpg -printf &quot;%f\n&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查找包含指定内容的文件：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">find . -type f -exec grep -l &quot;Hello World&quot; {} \;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#grep -Ilr &quot;Hello World&quot; ./</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查找指定时间范围内的文件：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">find -name *.java -newermt &#x27;2015-12-25 08:00:00&#x27; ! -newermt &#x27;2015-12-25 21:00:00&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ls -alR --full-time * | grep &quot;2015-12-25&quot;| grep &quot;.java&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="zabbix执行远程命令">zabbix执行远程命令<a href="#zabbix执行远程命令" class="hash-link" aria-label="zabbix执行远程命令的直接链接" title="zabbix执行远程命令的直接链接">​</a></h2>
<p>客户端配置文件添加配置：</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">EnableRemoteCommands=1		#启用远程命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LogRemoteCommands=1			#启用远程命令日志</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置sudo权限：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">visudo </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#授权zabbix用户使用sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zabbix  ALL=(ALL)       NOPASSWD: /usr/bin/systemctl restart myservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#如果存在Defaults    requiretty配置存在需要配置zabbix用户或者组不需要终端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Defaults:zabbix !requiretty		#zabbix用户不需要终端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Defaults:%zabbix !requiretty	#zabbix组不需要终端</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="lvm卷组">LVM卷组<a href="#lvm卷组" class="hash-link" aria-label="LVM卷组的直接链接" title="LVM卷组的直接链接">​</a></h2>
<blockquote>
<p>创建</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#创建物理卷</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvcreate /dev/sdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#创建逻辑卷组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vgcreate volGroup00 /dev/sdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#创建逻辑卷剩下所有空间都给逻辑卷</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lvcreate -l +100%FREE -n LogVol01 volGroup00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#创建逻辑卷(356为Total PE 数)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lvcreate -l 356 -n LogVol01 volGroup00</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>扩容</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#创建物理卷</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvcreate /dev/sdc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#添加物理卷进卷组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vgextend volGroup00 /dev/sdc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#扩展所有空间给逻辑卷</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vextend -l +100%FREE -n LogVol01 volGroup00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#扩 展指定10G空间给逻辑卷</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vextend -L +10G /dev/volGroup00/LogVol01</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>重定义大小（df -h看不到空间变化）</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#ext2 ext3 ext4文件系统使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resize2fs -p /dev/volGroup00/LogVol01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#xfs文件系统使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xfs_growfs  /dev/volGroup00/LogVol01</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>缩容</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#卸载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">umount /dev/volGroup00/LogVol01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#检查</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e2fsck -f /dev/volGroup00/LogVol01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#缩小文件系统为50g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resize2fs  /dev/volGroup00/LogVol01 50g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#缩小lv容量为50g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lvreduce -L 50G  /dev/volGroup00/LogVol01</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>删除</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#删逻辑卷</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lvremove /dev/volGroup00/LogVol01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#删卷组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vgremove volGroup00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#删物理卷</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvremove /dev/sdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#清除无效的卷</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vgreduce --removemissing --force volGroup00</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>挂载</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.ext4 /dev/volGroup00/LogVol01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount /dev/mapper/volGroup00-LogVol01 /data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vi /etc/fstab </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/mapper/volGroup00-LogVol01 /data                   ext4    defaults        1 2</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>pvdisplay：显示物理卷信息</li>
<li>vgdisplay：显示卷组信息</li>
<li>lvdisplay：显示逻辑卷信息</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="vsftp-出现报错530-login-incorrect">vsftp 出现报错530 Login incorrect<a href="#vsftp-出现报错530-login-incorrect" class="hash-link" aria-label="vsftp 出现报错530 Login incorrect的直接链接" title="vsftp 出现报错530 Login incorrect的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#使用下面命令查看pam库是否有加载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldd /usr/local/sbin/vsftpd|grep pam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#未加载安装pam后重新再编译vsftp安装</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install pam-devel </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="yum删除重复软件包">yum删除重复软件包<a href="#yum删除重复软件包" class="hash-link" aria-label="yum删除重复软件包的直接链接" title="yum删除重复软件包的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#列出重复的包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">package-cleanup --dupes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#删除重复的包</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">package-cleanup --cleandupes</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="yum下载rpm包">yum下载rpm包<a href="#yum下载rpm包" class="hash-link" aria-label="yum下载rpm包的直接链接" title="yum下载rpm包的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install --downloadonly --downloaddir=/tmp &lt;package-name&gt; </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-scoket5代理转换http代理">linux scoket5代理转换http代理<a href="#linux-scoket5代理转换http代理" class="hash-link" aria-label="linux scoket5代理转换http代理的直接链接" title="linux scoket5代理转换http代理的直接链接">​</a></h2>
<p>安装：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">wget  https://www.irif.fr/~jch/software/files/polipo/polipo-1.1.1.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar zxf polipo-1.1.1.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd polipo-1.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y texinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make all &amp;&amp; make install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp config.sample /etc/texinfo.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vi /etc/texinfo.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">socksParentProxy = &quot;192.168.120.110:10000&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">socksProxyType = socks5</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>启动：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">polipo -c /etc/texinfo.conf</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>设置http代理：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">export http_proxy=127.0.0.1:8123 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-连接vpnpptp">linux 连接vpn（pptp）<a href="#linux-连接vpnpptp" class="hash-link" aria-label="linux 连接vpn（pptp）的直接链接" title="linux 连接vpn（pptp）的直接链接">​</a></h2>
<p>安装：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install ppp pptp pptp-setup</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>创建VPN连接：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">modprobe ppp_mppe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pptpsetup --create vpn名称 --server ip地址 --username 账号 --password 密码 --start</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>连接VPN连接：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">pppd call vpn名称</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>添加路由：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">route add -net 192.168.200.0/24 dev ppp0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>断开vpn连接：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/init.d/network restart</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>VPN开启关闭脚本：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cp /usr/share/doc/ppp-2.4.5/scripts/pon /usr/sbin/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp /usr/share/doc/ppp-2.4.5/scripts/poff /usr/sbin/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x /usr/sbin/pon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x /usr/sbin/poff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">poff test      #关闭vpn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pon test      #开启vpn</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>错误：</p>
<p><code>Using interface ppp0Connect: ppp0 &lt;--&gt; /dev/pts/3CHAP authentication succeededLCP terminated by peer (MPPE required but peer refused)Modem hangup</code></p>
<p>解决方法：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># test为创建的vpn名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;require-mppe-128&#x27; &gt;&gt; /etc/ppp/peers/test</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>错误（CentOS7）：</p>
<p><code>LCP: timeout sending Config-RequestsConnection terminated.Modem hangup</code></p>
<p>解决方法：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">modprobe nf_conntrack_pptp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modprobe nf_conntrack_proto_gre</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="nginx-http强制跳转https">nginx http强制跳转https<a href="#nginx-http强制跳转https" class="hash-link" aria-label="nginx http强制跳转https的直接链接" title="nginx http强制跳转https的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">return 301 https://$server_name$request_uri; </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="shadowsocks安装">shadowsocks安装<a href="#shadowsocks安装" class="hash-link" aria-label="shadowsocks安装的直接链接" title="shadowsocks安装的直接链接">​</a></h2>
<p><strong>1.安装</strong></p>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/shadowsocks-all.sh" target="_blank" rel="noopener noreferrer">shadowsocks-all.sh</a></p>
<p><a href="https://github.com/shadowsocks/shadowsocks-libev" target="_blank" rel="noopener noreferrer">https://github.com/shadowsocks/shadowsocks-libev</a></p>
<p><strong>2.bbr加速脚本</strong></p>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/bbr.sh" target="_blank" rel="noopener noreferrer">bbr.sh</a></p>
<p>wget --no-check-certificate <a href="https://github.com/teddysun/across/raw/master/bbr.sh" target="_blank" rel="noopener noreferrer">https://github.com/teddysun/across/raw/master/bbr.sh</a> &amp;&amp; chmod +x bbr.sh &amp;&amp; ./bbr.sh</p>
<p>安装完成后，脚本会提示需要重启 VPS，输入 y 并回车后重启。重启完成后，进入 VPS，验证一下是否成功安装最新内核并开启 TCP BBR，输入以下命令：</p>
<p>查看内核版本，含有 4.13 就表示 OK 了</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">uname -r</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看返回值是否为 net.ipv4.tcp_available_congestion_control = bbr cubic reno</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">sysctl net.ipv4.tcp_available_congestion_control</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看返回值是否为 net.ipv4.tcp_congestion_control = bbr</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">sysctl net.ipv4.tcp_congestion_control</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看返回值是否为 net.core.default_qdisc = fq</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">sysctl net.core.default_qdisc</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回值有 tcp_bbr 模块即说明 bbr 已启动。注意：并不是所有的 VPS 都会有此返回值，若没有也属正常。</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">lsmod | grep bbr</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>参考链接：<a href="https://teddysun.com/489.html" target="_blank" rel="noopener noreferrer">https://teddysun.com/489.html</a></p>
<p><strong>3.混淆插件simple-obfs</strong></p>
<p><a href="https://github.com/shadowsocks/simple-obfs" target="_blank" rel="noopener noreferrer">https://github.com/shadowsocks/simple-obfs</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-大于2tb磁盘创建">linux 大于2TB磁盘创建<a href="#linux-大于2tb磁盘创建" class="hash-link" aria-label="linux 大于2TB磁盘创建的直接链接" title="linux 大于2TB磁盘创建的直接链接">​</a></h2>
<p>用part命令对3T硬盘进行分区</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">parted /dev/sdb </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mklabel gpt			#用gpt格式可以将3TB弄在一个分区里</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  unit TB				#设置单位为TB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mkpart primary 0 3	#设置为一个主分区,大小为3TB，开始是0，结束是3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print					#显示设置的分区大小</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  quit					#退出parted程序</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>格式化</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.xfs  /dev/sdb1</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="网站压力测试">网站压力测试<a href="#网站压力测试" class="hash-link" aria-label="网站压力测试的直接链接" title="网站压力测试的直接链接">​</a></h2>
<p>对baidu进行，1000次请求，并发用户10的压力测试</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ab -n 1000 -c 10 http://www.baidu.com</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="vi-去空格">vi 去空格<a href="#vi-去空格" class="hash-link" aria-label="vi 去空格的直接链接" title="vi 去空格的直接链接">​</a></h2>
<ul>
<li>删除空格行：非编辑状态下输入 <!-- -->:g<!-- -->/^$/d</li>
<li>删除行首空格：非编辑状态下输入: %s/^\s*//g</li>
<li>删除行尾空格：非编辑状态下输入: %s/\s*$//g</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看文件权限">查看文件权限<a href="#查看文件权限" class="hash-link" aria-label="查看文件权限的直接链接" title="查看文件权限的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">stat -c %a test.txt</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>常用的参数：</p>
<ul>
<li>%a Access rights in octal        8进制显示访问权限，0644</li>
<li>%A Access rights in human readable form        以人类可读的形式输出，</li>
<li>%F File type        文件的类型</li>
<li>%g Group ID of owner        所属组gid的号码</li>
<li>%G Group name of owner        所属组的名称</li>
<li>%h Number of hard links        硬连接的数量</li>
<li>%i Inode number        inode的值</li>
<li>%n File name        文件名</li>
<li>%o I/O block size        IO块大小</li>
<li>%s Total size, in bytes        文件的总大小，字节显示；</li>
<li>%u User ID of owner        所属主的uid号码</li>
<li>%U User name of owner        所属主的名称</li>
<li>%x Time of last access        最后访问的时间</li>
<li>%X Time of last access as seconds since Epoch        最后访问时间的时间戳</li>
<li>%y Time of last modification        最后修改的时间</li>
<li>%Y Time of last modification as seconds since Epoch        最后修改时间的时间戳</li>
<li>%z Time of last change        最后更改的时间</li>
<li>%Z Time of last change as seconds since Epoch        最后更改的时间的时间戳</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="shell-字符串变量值的替换">shell 字符串变量值的替换<a href="#shell-字符串变量值的替换" class="hash-link" aria-label="shell 字符串变量值的替换的直接链接" title="shell 字符串变量值的替换的直接链接">​</a></h2>
<p>file=/dir1/dir2/dir3/my.file.txt</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># 将第一个dir替换为path：/path1/dir2/dir3/my.file.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${file/dir/path}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#将全部的dir替换为path：/path1/path2/path3/my.file.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${file//dir/path}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>$<!-- --> 的一些功能：</p>
<ul>
<li><code>${file#*/}</code>：拿掉第一条 / 及其左边的字符串：dir1/dir2/dir3/my.file.txt</li>
<li><code>${file##*/}</code>：拿掉最后一条 / 及其左边的字符串：my.file.txt</li>
<li><code>${file#*.}</code>：拿掉第一个 . 及其左边的字符串：file.txt</li>
<li><code>${file##*.}</code>：拿掉最后一个 . 及其左边的字符串：txt</li>
<li><code>${file%/*}</code>：拿掉最后条 / 及其右边的字符串：/dir1/dir2/dir3</li>
<li><code>${file%%/*}</code>：拿掉第一条 / 及其右边的字符串：(空值)</li>
<li><code>${file%.*}</code>：拿掉最后一个 . 及其右边的字符串：/dir1/dir2/dir3/my.file</li>
<li><code>${file%%.*}</code>：拿掉第一个 . 及其右边的字符串：/dir1/dir2/dir3/my</li>
</ul>
<p>说明：</p>
<ol>
<li># 是去掉左边(在键盘上 # 在 $ 之左边)</li>
<li>% 是去掉右边(在键盘上 % 在 $ 之右边)</li>
<li>单一个符号（# 或 %）是最小匹配，两个符号（# 或 %）是最大匹配</li>
</ol>
<p>参考链接： <a href="http://wiki.jikexueyuan.com/project/13-questions-of-shell/eight.html" target="_blank" rel="noopener noreferrer">http://wiki.jikexueyuan.com/project/13-questions-of-shell/eight.html</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux获取外网ip">linux获取外网ip<a href="#linux获取外网ip" class="hash-link" aria-label="linux获取外网ip的直接链接" title="linux获取外网ip的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">curl -s http://geoiplookup.net/ |grep -b1 ISP |head -n1|awk -F &quot;&gt;&quot; &#x27;{print $2}&#x27;|awk -F &quot;&lt;&quot; &#x27;{print $1}&#x27;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">curl my.tanwen.net/ip</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="locale-编码报错">locale 编码报错<a href="#locale-编码报错" class="hash-link" aria-label="locale 编码报错的直接链接" title="locale 编码报错的直接链接">​</a></h2>
<p>locale: Cannot set LC_CTYPE to default locale: No such file or directory</p>
<p>locale: Cannot set LC_ALL to default locale: No such file or directory</p>
<p>解决方法：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install glibc-common</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="http://blog.csdn.net/wave_1102/article/details/45116783" target="_blank" rel="noopener noreferrer">http://blog.csdn.net/wave_1102/article/details/45116783</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="windows下编辑的shell脚本在linux无法执行">Windows下编辑的shell脚本在Linux无法执行<a href="#windows下编辑的shell脚本在linux无法执行" class="hash-link" aria-label="Windows下编辑的shell脚本在Linux无法执行的直接链接" title="Windows下编辑的shell脚本在Linux无法执行的直接链接">​</a></h2>
<p>在windows下编辑的shell脚本放到Linux环境下比如手机中运行时就会出一些莫名其妙的错误，一些非常简单的shell命令也会报错。其实错误的原因只有一个就是格式问题，在windows下编辑出的shell脚本格式为dos格式，而linux只能执行格式为unix格式的脚本。因为在dos/window下按一次回车键实际上输入的是“回车（CR)”和“换行（LF）”，即&#x27;\r\n&#x27;，而Linux/unix下按一次回车键只输入“换行（LF）”，即&#x27;\n&#x27;，所以修改的sh文件在每行都会多了一个CR，所  以Linux下运行时就会报错找不到命令。</p>
<p>解决这个问题的方法有几种：</p>
<ol>
<li>通过vi工具修改格式 在linux下通过vi打开该文件。在命令模式下使用set ff命令，可以看到该文件的格式为fileformat=dos  cat -A filename  可以看到每行尾都用^M 然后修改文件格式：<strong>set ff=unix</strong>，最后保存退出就可以了。</li>
<li>用fromdos命令转换 fromdos命令是ubuntu下进行dos格式文件转换成linux系统可以使用的文件格式的命令。  windows下很大编辑器本身也可以支持linux格式的文件编辑保存，不过默认并不是linux格式的 最简单的办法就是</li>
<li>找一个已经是linux格式的shell脚本文件，在此基础上进行修改保存，这样保存之后仍然也是linux格式的。</li>
<li>使用dos2unix命令转换</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="pip-安装">pip 安装<a href="#pip-安装" class="hash-link" aria-label="pip 安装的直接链接" title="pip 安装的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python get-pip.py</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">curl https://bootstrap.pypa.io/get-pip.py|python</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="脚本取得网站状态码">脚本取得网站状态码<a href="#脚本取得网站状态码" class="hash-link" aria-label="脚本取得网站状态码的直接链接" title="脚本取得网站状态码的直接链接">​</a></h2>
<p>shell</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">curl -I -m 10 -o /dev/null -s -w %{http_code} www.baidu.com</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>python</p>
<div class="language-python codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-python codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> urllib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">status</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">urlopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;http://www.baidu.com&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token plain"> status</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查找指定日期文件">查找指定日期文件<a href="#查找指定日期文件" class="hash-link" aria-label="查找指定日期文件的直接链接" title="查找指定日期文件的直接链接">​</a></h2>
<p>要在一个目录中查找2015-12-25创建的Java文件</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">find -name *.java -newermt &#x27;2015-12-25 08:00:00&#x27; ! -newermt &#x27;2015-12-25 21:00:00&#x27;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ls -alR --full-time * | grep &quot;2015-12-25&quot;| grep &quot;.java&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="centos7-创建自定义服务">centos7 创建自定义服务<a href="#centos7-创建自定义服务" class="hash-link" aria-label="centos7 创建自定义服务的直接链接" title="centos7 创建自定义服务的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description= ads rank web server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=simple</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/work/jbp_ads_server/jbp_ads_server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecReload=/bin/kill -HUP $MAINPID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KillMode=control-group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Restart=on-failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RestartSec=3s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PrivateTmp=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mv adsrankweb.service /usr/lib/systemd/system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start adsrankweb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop adsrankweb</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="screen--保存日志">screen  保存日志<a href="#screen--保存日志" class="hash-link" aria-label="screen  保存日志的直接链接" title="screen  保存日志的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;logfile /tmp/screenlog_%t.log&#x27; &gt;&gt; /etc/screenrc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">screen -L -t vod -S run    </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="内存缓存">内存缓存<a href="#内存缓存" class="hash-link" aria-label="内存缓存的直接链接" title="内存缓存的直接链接">​</a></h2>
<p>Cache，译作“缓存”，指 CPU 和内存之间高速缓存。</p>
<p>Buffer，译作“缓冲区”，指在写入磁盘前的存储再内存中的内容。在本文中，Buffer 和 Cache 有时候会通指。</p>
<p>#仅清除页面缓存（PageCache）  生产环境适用</p>
<p>sync; echo 1 &gt; /proc/sys/vm/drop_caches
#清除目录项和inodesync; echo 2 &gt; /proc/sys/vm/drop_caches
#清除页面缓存，目录项和inodesync; echo 3 &gt; /proc/sys/vm/drop_caches</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="git-免密码">git 免密码<a href="#git-免密码" class="hash-link" aria-label="git 免密码的直接链接" title="git 免密码的直接链接">​</a></h2>
<p>永久保存</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">git config --global credential.helper store</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>l临时，默认保存15分钟</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">git config --global credential.helper cache</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>或者修改config</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vi .git/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url = http://username:password@xiaohulu.hub520.com/yinzhonghua/xhl_newguild.git</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-l2tp-安装脚本">linux l2tp 安装脚本<a href="#linux-l2tp-安装脚本" class="hash-link" aria-label="linux l2tp 安装脚本的直接链接" title="linux l2tp 安装脚本的直接链接">​</a></h2>
<p>Ubuntu &amp; Debian</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://git.io/vpnsetup</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/vpnsetup" target="_blank" rel="noopener noreferrer">vpnsetup</a></p>
<p>CentOS &amp; RHEL</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://git.io/vpnsetup-centos</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://raw.githubusercontent.com/GavinTan/files/master/picgo/vpnsetup-centos" target="_blank" rel="noopener noreferrer">vpnsetup-centos</a></p>
<p>github:   <a href="https://github.com/hwdsl2/setup-ipsec-vpn" target="_blank" rel="noopener noreferrer">https://github.com/hwdsl2/setup-ipsec-vpn</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-查找">linux 查找<a href="#linux-查找" class="hash-link" aria-label="linux 查找的直接链接" title="linux 查找的直接链接">​</a></h2>
<ul>
<li>find      #查找所有文件</li>
<li>locate    #跟find类似速度较快直接搜索 locatedb数据库</li>
<li>which    #通过环境变量查找</li>
<li>whereis   #搜索程序二进制文件</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-测试网速">linux 测试网速<a href="#linux-测试网速" class="hash-link" aria-label="linux 测试网速的直接链接" title="linux 测试网速的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python speedtest.py</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="cobbler-安装错误">cobbler 安装错误<a href="#cobbler-安装错误" class="hash-link" aria-label="cobbler 安装错误的直接链接" title="cobbler 安装错误的直接链接">​</a></h2>
<p>File &quot;setup.py&quot;, line 373, in run  path = os.path.join(self.root + libpath, &#x27;webui_sessions&#x27;)TypeError: unsupported operand type(s) for +: &#x27;NoneType&#x27; and &#x27;str&#x27;</p>
<p><img loading="lazy" src="https://raw.githubusercontent.com/GavinTan/files/master/picgo/202201111534183.png" alt="Image" class="img_uPvX"></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux文本处理命令">linux文本处理命令<a href="#linux文本处理命令" class="hash-link" aria-label="linux文本处理命令的直接链接" title="linux文本处理命令的直接链接">​</a></h2>
<ul>
<li>sor</li>
<li>tr</li>
<li>cut</li>
<li>paste</li>
<li>uniq</li>
<li>tee</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="升级php56">升级php5.6<a href="#升级php56" class="hash-link" aria-label="升级php5.6的直接链接" title="升级php5.6的直接链接">​</a></h2>
<p>方法1：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">rpm -Uvh http://mirror.webtatic.com/yum/el6/latest.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install php56w php56w-opcache php56w-fpm php56w-mysql  php56w-bcmath php56w-mbstring php56w-gd php56w-xmlwriter </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>方法2：</p>
<p>配置yum源</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">rpm -Uvh http://ftp.iij.ad.jp/pub/linux/fedora/epel/6/x86_64/epel-release-6-8.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>以下是CentOS 7.0的源。</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install epel-releaserpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用yum list命令查看可安装的包(Packege)</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum list --enablerepo=remi --enablerepo=remi-php56 | grep php</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>安装PHP5.6.x</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install --enablerepo=remi --enablerepo=remi-php56 php php-opcache php-devel php-mbstring php-mcrypt php-mysqlnd php-phpunit-PHPUnit php-pecl-xdebug php-pecl-xhprof</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="后台任务">后台任务<a href="#后台任务" class="hash-link" aria-label="后台任务的直接链接" title="后台任务的直接链接">​</a></h2>
<p>&amp;  nohup  screen   #后台执行</p>
<p>jobs  #查看后台任务</p>
<p>fg    #将程序放在前台执行（切换后台任务到前台）</p>
<p>bg   #将程序放在后台执行</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="saltstack安装">saltstack安装<a href="#saltstack安装" class="hash-link" aria-label="saltstack安装的直接链接" title="saltstack安装的直接链接">​</a></h2>
<p>CentOS 6:</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install https://repo.saltstack.com/yum/redhat/salt-repo-latest-1.el6.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install salt-master salt-minion salt-ssh salt-syndic salt-cloud salt-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service salt-minion restart</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>CentOS 7:</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install https://repo.saltstack.com/yum/redhat/salt-repo-latest-1.el7.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install salt-master salt-minion salt-ssh salt-syndic salt-cloud salt-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart salt-minion</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="ubuntu安装桌面环境">Ubuntu安装桌面环境<a href="#ubuntu安装桌面环境" class="hash-link" aria-label="Ubuntu安装桌面环境的直接链接" title="Ubuntu安装桌面环境的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install xinit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install gdm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install ubuntu-desktop</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="ubuntu提示w-mdadm-etcmdadmmdadmconf-defines-no-arrays">Ubuntu提示W: mdadm: /etc/mdadm/mdadm.conf defines no arrays<a href="#ubuntu提示w-mdadm-etcmdadmmdadmconf-defines-no-arrays" class="hash-link" aria-label="Ubuntu提示W: mdadm: /etc/mdadm/mdadm.conf defines no arrays的直接链接" title="Ubuntu提示W: mdadm: /etc/mdadm/mdadm.conf defines no arrays的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mv /etc/mdadm/mdadm.conf /etc/mdadm/mdadm.conf.bak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">update-initramfs -u</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="mysql-56-mycnf-参数说明">MySQL 5.6 my.cnf 参数说明<a href="#mysql-56-mycnf-参数说明" class="hash-link" aria-label="MySQL 5.6 my.cnf 参数说明的直接链接" title="MySQL 5.6 my.cnf 参数说明的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># 以下选项会被MySQL客户端应用读取。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 注意只有MySQL附带的客户端应用程序保证可以读取这段内容。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你想你自己的MySQL应用程序获取这些值。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 需要在MySQL客户端库初始化的时候指定这些选项。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[client]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#password = [your_password]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = @MYSQL_TCP_PORT@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">socket = @MYSQL_UNIX_ADDR@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># *** 应用定制选项 ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL 服务端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[mysqld]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 一般配置选项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = @MYSQL_TCP_PORT@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">socket = @MYSQL_UNIX_ADDR@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># back_log 是操作系统在监听队列中所能保持的连接数,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 队列保存了在 MySQL 连接管理器线程处理之前的连接.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你有非常高的连接率并且出现 “connection refused” 报错,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你就应该增加此处的值.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 检查你的操作系统文档来获取这个变量的最大值.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果将back_log设定到比你操作系统限制更高的值,将会没有效果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">back_log = 300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 不在 TCP/IP 端口上进行监听.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果所有的进程都是在同一台服务器连接到本地的 mysqld,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这样设置将是增强安全的方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 所有 mysqld 的连接都是通过 Unix Sockets 或者命名管道进行的.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 注意在 Windows下如果没有打开命名管道选项而只是用此项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (通过 “enable-named-pipe” 选项) 将会导致 MySQL 服务没有任何作用!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#skip-networking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL 服务所允许的同时会话数的上限</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 其中一个连接将被 SUPER 权限保留作为管理员登录.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 即便已经达到了连接数的上限.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_connections = 3000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 每个客户端连接最大的错误允许数量,如果达到了此限制.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这个客户端将会被 MySQL 服务阻止直到执行了 “FLUSH HOSTS” 或者服务重启</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 非法的密码以及其他在链接时的错误会增加此值.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看 “Aborted_connects” 状态来获取全局计数器.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_connect_errors = 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 所有线程所打开表的数量.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 增加此值就增加了 mysqld 所需要的文件描述符的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这样你需要确认在 [mysqld_safe] 中 “open-files-limit” 变量设置打开文件数量允许至少等于 table_cache 的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_open_cache = 4096</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 允许外部文件级别的锁. 打开文件锁会对性能造成负面影响</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 所以只有在你在同样的文件上运行多个数据库实例时才使用此选项(注意仍会有其他约束!)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 或者你在文件层面上使用了其他一些软件依赖来锁定 MyISAM 表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#external-locking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 服务所能处理的请求包  的最大大小以及服务所能处理的最大的请求大小(当与大的 BLOB 字段一起工作时相当必要)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 每个连接独立的大小，大小动态增加</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_allowed_packet = 32M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在一个事务中 binlog 为了记录 SQL 状态所持有的 cache 大小</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你经常使用大的,多声明的事务,你可以增加此值来获取更大的性能.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 所有从事务来的状态都将被缓冲在 binlog 缓冲中然后在提交后一次性写入到 binlog 中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果事务比此值大, 会使用磁盘上的临时文件来替代.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此缓冲在每个连接的事务第一次更新状态时被创建</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog_cache_size = 4M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 独立的内存表所允许的最大容量.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此选项为了防止意外创建一个超大的内存表导致永尽所有的内存资源.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_heap_table_size = 128M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 随机读取数据缓冲区使用内存(read_rnd_buffer_size)：和顺序读取相对应，</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当 MySQL 进行非顺序读取（随机读取）数据块的时候，会利用&gt;这个缓冲区暂存读取的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如根据索引信息读取表数据，根据排序后的结果集与表进行 Join 等等</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 总的来说，就是当数据块的读取需要满足&gt;一定的顺序的情况下，MySQL 就需要产生随机读取，进而使用到 read_rnd_buffer_size 参数所设置的内存缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_rnd_buffer_size = 16M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 排序缓冲被用来处理类似 ORDER BY 以及 GROUP BY 队列所引起的排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果排序后的数据无法放入排序缓冲,一个用来替代的基于磁盘的合并分类会被使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看 “Sort_merge_passes” 状态变量.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在排序发生时由每个线程分配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort_buffer_size = 16M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此缓冲被使用来优化全联合(FULL JOINS 不带索引的联合).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 类似的联合在极大多数情况下有非常糟糕的性能表现,但是将此值设大能够减轻性能影响.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 通过 “Select_full_join” 状态变量查看全联合的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当全联合发生时,在每个线程中分配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">join_buffer_size = 16M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 我们在 cache 中保留多少线程用于重用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当一个客户端断开连接后,如果 cache 中的线程还少于 thread_cache_size,则客户端线程被放入cache 中.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这可以在你需要大量新连接的时候极大的减少线程创建的开销</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (一般来说如果你有好的线程模型的话,这不会有明显的性能提升.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread_cache_size = 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此允许应用程序  给予线程系统一个提示在同一时间给予渴望被运行的线程的数量.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此值只对于支持 thread_concurrency() 函数的系统有意义( 例如Sun Solaris).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你可可以尝试使用 [CPU数量]*(2..4) 来作为 thread_concurrency 的值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread_concurrency = 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查询缓冲常被用来缓冲 SELECT 的结果并且在下一次同样查询的时候不再执行直接返回结果.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开查询缓冲可以极大的提高服务器速度, 如果你有大量的相同的查询并且很少修改表.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查看 “Qcache_lowmem_prunes” 状态变量来检查是否当前值对于你的负载来说是否足够高.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 注意: 在你表经常变化的情况下或者如果你的查询原文每次都不同,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 查询缓冲也许引起性能下降而不是性能提升.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">query_cache_size = 128M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 只有小于此设定值的结果才会被缓冲</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此设置用来保护查询缓冲,防止一个极大的结果集将其他所有的查询结果都覆盖.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">query_cache_limit = 4M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 被全文检索索引的最小的字长.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你也许希望减少它,如果你需要搜索更短字的时候.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 注意在你修改此值之后,你需要重建你的 FULLTEXT 索引</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ft_min_word_len = 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你的系统支持 memlock() 函数,你也许希望打开此选项用以让运行中的 mysql 在在内存高度紧张的时候,数据在内存中保持锁定并且防止可能被 swapping out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此选项对于性能有益</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#memlock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当创建新表时作为默认使用的表类型,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果在创建表示没有特别执行表类型,将会使用此值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_table_type = InnoDB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 线程使用的堆大小. 此容量的内存在每次连接时被预留.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL 本身常不会需要超过 64K 的内存</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你使用你自己的需要大量堆的 UDF 函数或者你的操作系统对于某些操作需要更多的堆,你也许需要将其设置的更高一点.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread_stack = 512K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 设定默认的事务隔离级别.可用的级别如下:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">transaction_isolation = REPEATABLE-READ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 内部(内存中)临时表的最大大小</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果一个表增长到比此值更大,将会自动转换为基于磁盘的表.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此限制是针对单个表的,而不是总和.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmp_table_size = 128M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开二进制日志功能.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在复制(replication)配置中,作为 MASTER 主服务器必须打开此项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你需要从你最后的备份中做基于时间点的恢复,你也同样需要二进制日志.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log-bin=mysql-bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你在使用链式从服务器结构的复制模式 (A-&gt;B-&gt;C),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你需要在服务器B上打开此项.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此选项打开在从线程上重做过的更新的日志, 并将其写入从服务器的二进制日志.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#log_slave_updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开全查询日志. 所有的由服务器接收到的查询 (甚至对于一个错误语法的查询)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 都会被记录下来. 这对于调试非常有用, 在生产环境中常常关闭此项.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 将警告打印输出到错误 log 文件. 如果你对于 MySQL 有任何问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你应该打开警告 log 并且仔细审查错误日志,查出可能的原因.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#log_warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 记录慢速查询. 慢速查询是指消耗了比 “long_query_time” 定义的更多时间的查询.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果 log_long_format 被打开,那些没有使用索引的查询也会被记录.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你经常增加新查询到已有的系统内的话. 一般来说这是一个好主意,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_slow_queries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 所有的使用了比这个时间(以秒为单位)更多的查询会被认为是慢速查询.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 不要在这里使用“1″, 否则会导致所有的查询,甚至非常快的查询页被记录下来(由于 MySQL 目前时间的精确度只能达到秒的级别).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long_query_time = 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在慢速日志中记录更多的信息.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 一般此项最好打开.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开此项会记录使得那些没有使用索引的查询也被作为到慢速查询附加到慢速日志里</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_long_format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此目录被MySQL用来保存临时文件.例如,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 它被用来处理基于磁盘的大型排序,和内部排序一样.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 以及简单的临时表.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你不创建非常大的临时文件,将其放置到 swapfs/tmpfs 文件系统上也许比较好</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 另一种选择是你也可以将其放置在独立的磁盘上.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你可以使用”;”来放置多个路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 他们会按照 roud-robin 方法被轮询使用.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#tmpdir = /tmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># *** 主从复制相关的设置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 唯一的服务辨识号,数值位于 1 到 2^32-1之间.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此值在master和slave上都需要设置.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果 “master-host” 没有被设置,则默认为1, 但是如果忽略此选项,MySQL不会作为master生效.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server-id = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 复制的Slave (去掉master段的注释来使其生效)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 为了配置此主机作为复制的slave服务器,你可以选择两种方法:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1) 使用 CHANGE MASTER TO 命令 (在我们的手册中有完整描述) -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 语法如下:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CHANGE MASTER TO MASTER_HOST=, MASTER_PORT=,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MASTER_USER=, MASTER_PASSWORD= ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你需要替换掉 , , 等被尖括号包围的字段以及使用master的端口号替换 (默认3306).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 例子:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CHANGE MASTER TO MASTER_HOST=’125.564.12.1′, MASTER_PORT=3306,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MASTER_USER=’joe’, MASTER_PASSWORD=’secret’;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 或者</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2) 设置以下的变量. 不论如何, 在你选择这种方法的情况下, 然后第一次启动复制(甚至不成功的情况下,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 例如如果你输入错密码在master-password字段并且slave无法连接),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># slave会创建一个 master.info 文件,并且之后任何对于包含在此文件内的参数的变化都会被忽略</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 并且由 master.info 文件内的内容覆盖, 除非你关闭slave服务, 删除 master.info 并且重启slave 服务.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 由于这个原因,你也许不想碰一下的配置(注释掉的) 并且使用 CHANGE MASTER TO (查看上面) 来代替</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 所需要的唯一id号位于 2 和 2^32 – 1之间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (并且和master不同)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果master-host被设置了.则默认值是2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 但是如果省略,则不会生效</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#server-id = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 复制结构中的master – 必须</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#master-host =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当连接到master上时slave所用来认证的用户名 – 必须</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#master-user =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当连接到master上时slave所用来认证的密码 – 必须</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#master-password =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># master监听的端口.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 可选 – 默认是3306</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#master-port =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 使得slave只读.只有用户拥有SUPER权限和在上面的slave线程能够修改数据.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你可以使用此项去保证没有应用程序会意外的修改slave而不是master上的数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#read_only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#*** MyISAM 相关选项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 关键词缓冲的大小, 一般用来缓冲 MyISAM 表的索引块.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 不要将其设置大于你可用内存的30%,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 因为一部分内存同样被OS用来缓冲行数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 甚至在你并不使用 MyISAM 表的情况 下, 你也需要仍旧设置起 8-64M 内存由于它同样会被内部临时磁盘表使用.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key_buffer_size = 128M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 用来做 MyISAM 表全表扫描的缓冲大小.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当全表扫描需要时,在对应线程中分配.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_buffer_size = 8M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当在排序之后,从一个已经排序好的序列中读取行时,行数据将从这个缓冲中读取来防止磁盘寻道.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你增高此值,可以提高很多 ORDER BY 的性能.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当需要时由每个线程分配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_rnd_buffer_size = 64M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MyISAM 使用特殊的类似树的 cache 来使得突发插入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (这些插入是,INSERT … SELECT, INSERT … VALUES (…), (…), …, 以及 LOAD DATA INFILE) 更快.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此变量 限制每个进程中缓冲树的字节数.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 设置为 0 会关闭此优化.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 为了最优化不要将此值设置大于 “key_buffer_size”.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当突发插入被检测到时此缓冲将被分配.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bulk_insert_buffer_size = 256M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此缓冲当 MySQL 需要在 REPAIR, OPTIMIZE, ALTER 以及 LOAD DATA INFILE 到一个空表中引起重建索引时被分配.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这在每个线程中被分配.所以在设置大值时需要小心.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myisam_sort_buffer_size = 256M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL 重建索引时所允许的最大临时文件的大小 (当 REPAIR, ALTER TABLE 或者 LOAD DATA INFILE).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果文件大小比此值更大,索引会通过键值缓冲创建(更慢)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myisam_max_sort_file_size = 10G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果被用来更快的索引创建索引所使用临时文件大于制定的值,那就使用键值缓冲方法.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这主要用来强制在大表中长字串键去使用慢速的键值缓冲方法来创建索引.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myisam_max_extra_sort_file_size = 10G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果一个表拥有超过一个索引, MyISAM 可以通过并行排序使用超过一个线程去修复他们.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这对于拥有多个 CPU 以及大量内存情况的用户,是一个很好的选择.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myisam_repair_threads = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 自动检查和修复没有适当关闭的 MyISAM 表.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myisam_recover</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 默认关闭 Federated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skip-federated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># *** BDB 相关选项 ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你运行的MySQL服务有BDB支持但是你不准备使用的时候使用此选项. 这会节省内存并且可能加速一些事.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skip-bdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># *** INNODB 相关选项 ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你的 MySQL 服务包含 InnoDB 支持但是并不打算使用的话,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 使用此选项会节省内存以及磁盘空间,并且加速某些部分</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#skip-innodb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 附加的内存池被 InnoDB 用来保存 metadata 信息(5.6中不再推荐使用)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果 InnoDB 为此目的需要更多的内存,它会开始从 OS 这里申请内存.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 由于这个操作在大多数现代操作系统上已经足够快, 你一般不需要修改此值.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SHOW INNODB STATUS 命令会显示当先使用的数量.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_additional_mem_pool_size = 64M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB使用一个缓冲池来保存索引和原始数据, 不像 MyISAM.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这里你设置越大,这能保证你在大多数的读取操作时使用的是内存而不是硬盘,在存取表里面数据时所需要的磁盘 I/O 越少.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在一个独立使用的数据库服务器上,你可以设置这个变量到服务器物理内存大小的80%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 不要设置过大,否则,由于物理内存的竞争可能导致操作系统的换页颠簸.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 注意在32位系统上你每个进程可能被限制在 2-3.5G 用户层面内存限制,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 所以不要设置的太高.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_buffer_pool_size = 6G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB 将数据保存在一个或者多个数据文件中成为表空间.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你只有单个逻辑驱动保存你的数据,一个单个的自增文件就足够好了.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 其他情况下.每个设备一个文件一般都是个好的选择.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你也可以配置 InnoDB 来使用裸盘分区 – 请参考手册来获取更多相关内容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_data_file_path = ibdata1:10M:autoextend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 设置此选项如果你希望InnoDB表空间文件被保存在其他分区.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 默认保存在MySQL的datadir中.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_data_home_dir =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 用来同步IO操作的IO线程的数量.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此值在Unix下被硬编码为8,但是在Windows磁盘I/O可能在一个大数值下表现的更好.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_file_io_threads = 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你发现 InnoDB 表空间损坏, 设置此值为一个非零值可能帮助你导出你的表.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 从1开始并且增加此值知道你能够成功的导出表.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_force_recovery=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在 InnoDb 核心内的允许线程数量.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 最优值依赖于应用程序,硬件以及操作系统的调度方式.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 过高的值可能导致线程的互斥颠簸.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_thread_concurrency = 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果设置为1 ,InnoDB 会在每次提交后刷新(fsync)事务日志到磁盘上,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这提供了完整的 ACID 行为.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你愿意对事务安全折衷, 并且你正在运行一个小的事物, 你可以设置此值到0或者2来减少由事务日志引起的磁盘I/O</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 0代表日志只大约每秒写入日志文件并且日志文件刷新到磁盘.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2代表日志写入日志文件在每次提交后,但是日志文件只有大约每秒才会刷新到磁盘上.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_flush_log_at_trx_commit = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">（说明：如果是游戏服务器，建议此 值设置为2；如果是对数据安全要求极高的应用，建议设置为1；设置为0性能最高，但如果发生故障，数据可能会有丢失的危险！默认值1的意思是每一次事务提交或事务外的指令都需要把日志写入（flush）硬盘，这是很费时的。特别是使用电池供电缓存（Battery backed up cache）时。设成2对于很多运用，特别是从MyISAM表转过来的是可以的，它的意思是不写入硬盘而是写入系统缓存。日志仍然会每秒flush到硬盘，所以你一般不会丢失超过1-2秒的更新。设成0会更快一点，但安全方面比较差，即使MySQL挂了也可能会丢失事务的数据。而值2只会在整个操作系统挂了时才可能丢数据。）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 加速 InnoDB 的关闭. 这会阻止 InnoDB 在关闭时做全清除以及插入缓冲合并.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这可能极大增加关机时间, 但是取而代之的是 InnoDB 可能在下次启动时做这些操作.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_fast_shutdown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 用来缓冲日志数据的缓冲区的大小.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当此值快满时, InnoDB 将必须刷新数据到磁盘上.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 由于基本上每秒都会刷新一次,所以没有必要将此值设置的太大(甚至对于长事务而言)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_log_buffer_size = 16M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在日志组中每个日志文件的大小.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你应该设置日志文件总合大小到你缓冲池大小的25%~100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 来避免在日志文件覆写上不必要的缓冲池刷新行为.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 不论如何, 请注意一个大的日志文件大小会增加恢复进程所需要的时间.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_log_file_size = 512M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在日志组中的文件总数.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 通常来说2~3是比较好的.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_log_files_in_group = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB 的日志文件所在位置. 默认是 MySQL 的 datadir.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你可以将其指定到一个独立的硬盘上或者一个RAID1卷上来提高其性能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_log_group_home_dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在 InnoDB 缓冲池中最大允许的脏页面的比例.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果达到限额, InnoDB 会开始刷新他们防止他们妨碍到干净数据页面.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这是一个软限制,不被保证绝对执行.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_max_dirty_pages_pct = 90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB 用来刷新日志的方法.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 表空间总是使用双重写入刷新方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 默认值是 “fdatasync”, 另一个是 “O_DSYNC”.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 一般来说，如果你有硬件 RAID 控制器，并且其独立缓存采用 write-back 机制，并有着电池断电保护，那么应该设置配置为 O_DIRECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 否则，大多数情况下应将其设为 fdatasync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#innodb_flush_method=fdatasync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在被回滚前,一个 InnoDB 的事务应该等待一个  锁被批准多久.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB 在其拥有的锁表中自动检测事务死锁并且回滚事务.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果你使用 LOCK TABLES 指令, 或者在同样事务中使用除了 InnoDB 以外的其他事务安全的存储引擎</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 那么一个死锁可能发生而 InnoDB 无法注意到.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这种情况下这个 timeout 值对于解决这种问题就非常有帮助.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_lock_wait_timeout = 120</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这项设置告知InnoDB是否需要将所有表的数据和索引存放在共享表空间里（innodb_file_per_table = OFF） 或者为每张表的数据单独放在一个.ibd文件（innodb_file_per_table = ON）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 每张表一个文件允许你在drop、truncate或者rebuild表时回收磁盘空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这对于一些高级特性也是有必要的，比如数据压缩,但是它不会带来任何性能收益</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_file_per_table = on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[mysqldump]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 不要在将内存中的整个结果写入磁盘之前缓存. 在导出非常巨大的表时需要此项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quick</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_allowed_packet = 32M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[mysql]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">no-auto-rehash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 仅仅允许使用键值的 UPDATEs 和 DELETEs .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#safe-updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[myisamchk]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key_buffer = 16M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort_buffer_size = 16M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_buffer = 8M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write_buffer = 8M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[mysqlhotcopy]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interactive-timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[mysqld_safe]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 增加每个进程的可打开文件数量.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 警告: 确认你已经将全系统限制设定的足够高!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开大量表需要将此值设大</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">open-files-limit = 8192</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="mysql-56版本适合在1gb内存vps上的mycnf配置文件">MySQL 5.6版本适合在1GB内存VPS上的my.cnf配置文件<a href="#mysql-56版本适合在1gb内存vps上的mycnf配置文件" class="hash-link" aria-label="MySQL 5.6版本适合在1GB内存VPS上的my.cnf配置文件的直接链接" title="MySQL 5.6版本适合在1GB内存VPS上的my.cnf配置文件的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[client] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 3306 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">socket = /tmp/mysql.sock </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[mysqld] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 3306 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">socket = /tmp/mysql.sock </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basedir = /usr/local/mysql </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">datadir = /data/mysql </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pid-file = /data/mysql/mysql.pid </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user = mysql </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bind-address = 0.0.0.0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server-id = 1 #表示是本机的序号为1,一般来讲就是master的意思 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skip-name-resolve </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 禁止MySQL对外部连接进行DNS解析，使用这一选项可以消除MySQL进行DNS解析的时间。但需要注意，如果开启该选项， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 则所有远程主机连接授权都要使用IP地址方式，否则MySQL将无法正常处理连接请求 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#skip-networking </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">back_log = 600 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL能有的连接数量。当主要MySQL线程在一个很短时间内得到非常多的连接请求，这就起作用， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 然后主线程花些时间(尽管很短)检查连接并且启动一个新线程。back_log值指出在MySQL暂时停止回答新请求之前的短时间内多少个请求可以被存在堆栈中。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果期望在一个短时间内有很多连接，你需要增加它。也就是说，如果MySQL的连接数据达到max_connections时，新来的请求将会被存在堆栈中， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 以等待某一连接释放资源，该堆栈的数量即back_log，如果等待连接的数量超过back_log，将不被授予连接资源。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 另外，这值（back_log）限于您的操作系统对到来的TCP/IP连接的侦听队列的大小。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 你的操作系统在这个队列大小上有它自己的限制（可以检查你的OS文档找出这个变量的最大值），试图设定back_log高于你的操作系统的限制将是无效的。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_connections = 1000 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL的最大连接数，如果服务器的并发连接请求量比较大，建议调高此值，以增加并行连接数量，当然这建立在机器能支撑的情况下，因为如果连接数越多，介于MySQL会为每个连接提供连接缓冲区，就会开销越多的内存，所以要适当调整该值，不能盲目提高设值。可以过&#x27;conn%&#x27;通配符查看当前状态的连接数量，以定夺该值的大小。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_connect_errors = 6000 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 对于同一主机，如果有超出该参数值个数的中断错误连接，则该主机将被禁止连接。如需对该主机进行解禁，执行：FLUSH HOST。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">open_files_limit = 65535 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL打开的文件描述符限 制，默认最小1024;当open_files_limit没有被配置的时候，比较max_connections*5和ulimit -n的值，哪个大用哪个， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当open_file_limit被配置的时候，比较open_files_limit和max_connections*5的值，哪个大用哪个。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_open_cache = 128 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL每打开一个表，都会读入一些数据到table_open_cache缓存中，当MySQL在这个缓存中找不到相应信息时，才会去磁盘上读取。默认值64 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 假定系统有200个并发连接，则需将此参数设置为200*N(N为每个连接所需的文件描述符数目)； </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当把table_open_cache设置为很大时，如果系统处理不了那么多文件描述符，那么就会出现客户端失效，连接不上 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_allowed_packet = 4M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 接受的数据包大小；增加该变量的值十分安全，这是因为仅当需要时才会分配额外内存。例如，仅当你发出长查询或MySQLd必须返回大的结果行时MySQLd才会分配更多内存。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 该变量之所以取较小默认值是一种预防措施，以捕获客户端和服务器之间的错误信息包，并确保不会因偶然使用大的信息包而导致内存溢出。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog_cache_size = 1M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 一个事务，在没有提交的时候，产生的日志，记录到Cache中；等到事务提交需要提交的时候，则把日志持久化到磁盘。默认binlog_cache_size大小32K </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_heap_table_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 定义了用户可以创建的内存表(memory table)的大小。这个值用来计算内存表的最大行数值。这个变量支持动态改变 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmp_table_size = 16M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL的heap（堆积）表缓冲大小。所有联合在一个DML指令内完成，并且大多数联合甚至可以不用临时表即可以完成。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 大多数临时表是基于内存的(HEAP)表。具有大的记录长度的临时表 (所有列的长度的和)或包含BLOB列的表存储在硬盘上。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果某个内部heap（堆积）表大小超过tmp_table_size，MySQL可以根据需要自动将内存中的heap表改为基于硬盘的MyISAM表。还可以通过设置tmp_table_size选项来增加临时表的大小。也就是说，如果调高该值，MySQL同时将增加heap表的大小，可达到提高联接查询速度的效果 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_buffer_size = 2M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL读入缓冲区大小。对表进行顺序扫描的请求将分配一个读入缓冲区，MySQL会为它分配一段内存缓冲区。read_buffer_size变量控制这一缓冲区的大小。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果对表的顺序扫描请求非常频繁，并且你认为频繁扫描进行得太慢，可以通过增加该变量值以及内存缓冲区大小提高其性能 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_rnd_buffer_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL的随机读缓冲区大小。当按任意顺序读取行时(例如，按照排序顺序)，将分配一个随机读缓存区。进行排序查询时， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL会首先扫描一遍该缓冲，以避免磁盘搜索，提高查询速度，如果需要排序大量数据，可适当调高该值。但MySQL会为每个客户连接发放该缓冲空间，所以应尽量适当设置该值，以避免内存开销过大 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort_buffer_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL执行排序使用的缓冲大小。如果想要增加ORDER BY的速度，首先看是否可以让MySQL使用索引而不是额外的排序阶段。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果不能，可以尝试增加sort_buffer_size变量的大小 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">join_buffer_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 联合查询操作所能使用的缓冲区大小，和sort_buffer_size一样，该参数对应的分配内存也是每连接独享 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread_cache_size = 8 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这个值（默认8）表示可以重新利用保存在缓存中线程的数量，当断开连接时如果缓存中还有空间，那么客户端的线程将被放到缓存中， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果线程重新被请求，那么请求将从缓存中读取,如果缓存中是空的或者是新的请求，那么这个线程将被重新创建,如果有很多新的线程， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 增加这个值可以改善系统性能.通过比较Connections和Threads_created状态的变量，可以看到这个变量的作用。(–&gt;表示要调整的值) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 根据物理内存设置规则如下 ： </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1G  —&gt; 8 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2G  —&gt; 16 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3G  —&gt; 32 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 大于3G  —&gt; 64 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">query_cache_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#MySQL的查询缓冲大小（从4.0.1开始，MySQL提供了查询缓冲机制）使用查询缓冲，MySQL将SELECT语句和查询结果存放在缓冲区中， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 今后对于同样的SELECT语句（区分大小写），将直接从缓冲区中读取结果。根据MySQL用户手册，使用查询缓冲最多可以达到238%的效率。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 通过检查状态值&#x27;Qcache_%&#x27;，可以知道query_cache_size设置是否合理：如果Qcache_lowmem_prunes的值非常大，则表明经常出现缓冲不够的情况， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果Qcache_hits的值也非常大，则表明查询缓冲使用非常频繁，此时需要增加缓冲大小；如果Qcache_hits的值不大，则表明你的查询重复率很低， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这种情况下使用查询缓冲反而会影响效率，那么可以考虑不用查询缓冲。此外，在SELECT语句中加入SQL_NO_CACHE可以明确表示不使用查询缓冲 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">query_cache_limit = 2M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#指定单个查询能够使用的缓冲区大小，默认1M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key_buffer_size = 4M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#指定用于索引的缓冲区大小，增加它可得到更好处理的索引(对所有读和多重写)，到你能负担得起那样多。如果你使它太大， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 系统将开始换页并且真的变慢了。对于内存在4GB左右的服务器该参数可设置为384M或512M。通过检查状态值Key_read_requests和Key_reads， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 可以知道key_buffer_size设置是否合理。比例key_reads/key_read_requests应该尽可能的低， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 至少是1:100，1:1000更好(上述状态值可以使用SHOW STATUS LIKE &#x27;key_read%&#x27;获得)。注意：该参数值设置的过大反而会是服务器整体效率降低 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ft_min_word_len = 4 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 分词词汇最小长度，默认4 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">transaction_isolation = REPEATABLE-READ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL支持4种事务隔离级别，他们分别是： </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如没有指定，MySQL默认采用的是REPEATABLE-READ，ORACLE默认的是READ-COMMITTED </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_bin = mysql-bin </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">binlog_format = mixed </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expire_logs_days = 30 #超过30天的binlog删除 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_error = /data/mysql/mysql-error.log #错误日志路径 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slow_query_log = 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long_query_time = 1 #慢查询时间 超过1秒则为慢查询 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">slow_query_log_file = /data/mysql/mysql-slow.log </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">performance_schema = 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">explicit_defaults_for_timestamp </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#lower_case_table_names = 1 #不区分大小写 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skip-external-locking #MySQL选项以避免外部锁定。该选项默认开启 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default-storage-engine = InnoDB #默认存储引擎 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_file_per_table = 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB为独立表空间模式，每个数据库的每个表都会生成一个数据空间 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 独立表空间优点： </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1．每个表都有自已独立的表空间。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2．每个表的数据和索引都会存在自已的表空间中。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3．可以实现单表在不同的数据库中移动。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4．空间可以回收（除drop table操作处，表空不能自已回收） </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 缺点： </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 单表增加过大，如超过100G </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 结论： </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 共享表空间在Insert操作上少有优势。其它都没独立表空间表现好。当启用独立表空间时，请合理调整：innodb_open_files </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_open_files = 500 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 限制Innodb能打开的表的数据，如果库里的表特别多的情况，请增加这个。这个值默认是300 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_buffer_pool_size = 64M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB使用一个缓冲池来保存索引和原始数据, 不像MyISAM. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 这里你设置越大,你在存取表里面数据时所需要的磁盘I/O越少. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在一个独立使用的数据库服务器上,你可以设置这个变量到服务器物理内存大小的80% </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 不要设置过大,否则,由于物理内存的竞争可能导致操作系统的换页颠簸. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 注意在32位系统上你每个进程可能被限制在 2-3.5G 用户层面内存限制, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 所以不要设置的太高. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_write_io_threads = 4 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_read_io_threads = 4 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># innodb使用后台线程处理数据页上的读写 I/O(输入输出)请求,根据你的 CPU 核数来更改,默认是4 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 注:这两个参数不支持动态改变,需要把该参数加入到my.cnf里，修改完后重启MySQL服务,允许值的范围从 1-64 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_thread_concurrency = 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 默认设置为 0,表示不限制并发数，这里推荐设置为0，更好去发挥CPU多核处理能力，提高并发量 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_purge_threads = 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB中的清除操作是一类定期回收无用数据的操作。在之前的几个版  本中，清除操作是主线程的一部分，这意味着运行时它可能会堵塞其它的数据库操作。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 从MySQL5.5.X版本开始，该操作运行于独立的线程中,并支持更多的并发数。用户可通过设置innodb_purge_threads配置参数来选择清除操作是否使用单 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 独线程,默认情况下参数设置为0(不使用单独线程),设置为 1 时表示使用单独的清除线程。建议为1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_flush_log_at_trx_commit = 2 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 0：如果innodb_flush_log_at_trx_commit的值为0,log buffer每秒就会被刷写日志文件到磁盘，提交事务的时候不做任何操作（执行是由mysql的master thread线程来执行的。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 主线程中每秒会将重做日志缓冲写入磁盘的重做日志文件(REDO LOG)中。不论事务是否已经提交）默认的日志文件是ib_logfile0,ib_logfile1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1：当设为默认值1的时候，每次提交事务的时候，都会将log buffer刷写到日志。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2：如果设为2,每次提交事务都会写日志，但并不会执行刷的操作。每秒定时会刷到日志文件。要注意的是，并不能保证100%每秒一定都会刷到磁盘，这要取决于进程的调度。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 每次事 务提交的时候将数据写入事务日志，而这里的写入仅是调用了文件系统的写入操作，而文件系统是有 缓存的，所以这个写入并不能保证数据已经写入到物理磁盘 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 默认值1是为了保证完整的ACID。当然，你可以将这个配置项设为1以外的值来换取更高的性能，但是在系统崩溃的时候，你将会丢失1秒的数据。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 设为0的话，mysqld进程崩溃的时候，就会丢失最后1秒的事务。设为2,只有在操作系统崩溃或者断电的时候才会丢失最后1秒的数据。InnoDB在做恢复的时候会忽略这个值。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 总结 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 设为1当然是最安全的，但性能页是最差的（相对其他两个参数而言，但不是不能接受）。如果对数据一致性和完整性要求不高，完全可以设为2，如果只最求性能，例如高并发写的日志服务器，设为0来获得更高性能 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_log_buffer_size = 2M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此参数确定些日志文件所用的内存大小，以M为单位。缓冲区更大能提高性能，但意外的故障将会丢失数据。MySQL开发人员建议设置为1－8M之间 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_log_file_size = 32M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 此参数确定数据日志文件的大小，更大的设置可以提高性能，但也会增加恢复故障数据库所需的时间 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_log_files_in_group = 3 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 为提高性能，MySQL可以以循环方式将日志文件写到多个文件。推荐设置为3 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_max_dirty_pages_pct = 90 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># innodb主线程刷新缓存池中的数据，使脏数据比例小于90% </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">innodb_lock_wait_timeout = 120   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># InnoDB事务在被回滚之前可以等待一个锁定的超时秒数。InnoDB在它自己的锁定表中自动检测事务死锁并且回滚事务。InnoDB用LOCK TABLES语句注意到锁定设置。默认值是50秒 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bulk_insert_buffer_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 批量插入缓存大小， 这个参数是针对MyISAM存储引擎来说的。适用于在一次性插入100-1000+条记录时， 提高效率。默认值是8M。可以针对数据量的大小，翻倍增加。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myisam_sort_buffer_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MyISAM设置恢复表之时使用的缓冲区的尺寸，当在REPAIR TABLE或用CREATE INDEX创建索引或ALTER TABLE过程中排序 MyISAM索引分配的缓冲区 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myisam_max_sort_file_size = 10G </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果临时文件会变得超过索引，不要使用快速排序索引方法来创建一个索引。注释：这个参数以字节的形式给出 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myisam_repair_threads = 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果该值大于1，在Repair by sorting过程中并行创建MyISAM表索引(每个索引在自己的线程内)   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interactive_timeout = 28800 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 服务器关闭交互式连接前等待活动的秒数。交互式客户端定义为在mysql_real_connect()中使用CLIENT_INTERACTIVE选项的  客户端。默认值：28800秒（8小时） </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wait_timeout = 28800 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 服务器关闭非交互连接之前等待活动的秒数。在线程启动时，根据全局wait_timeout值或全局interactive_timeout值初始化会话wait_timeout值， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 取决于客户端类型(由mysql_real_connect()的连接选项CLIENT_INTERACTIVE定义)。参数默认值：28800秒（8小时） </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL服务器所支持的最大连接数是有上限的，因为每个连接的建立都会消耗内存，因此我们希望客户端在连接到MySQL Server处理完相应的操作后， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 应该断开连接并释放占用的内存。如果你的MySQL Server有大量的闲置连接，他们不仅会白白消耗内存，而且如果连接一直在累加而不断开， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 最终肯定会达到MySQL Server的连接上限数，这会报&#x27;too many connections&#x27;的错误。对于wait_timeout的值设定，应该根据系统的运行情况来判断。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 在系统运行一段时间后，可以通过show processlist命令查看当前系统的连接状态，如果发现有大量的sleep状态的连接进程，则说明该参数设置的过大， </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 可以进行适当的调整小些。要同时设置interactive_timeout和wait_timeout才会生效。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[mysqldump] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quick </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_allowed_packet = 16M #服务器发送和接受的最大包长度 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[myisamchk] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">key_buffer_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sort_buffer_size = 8M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read_buffer = 4M </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write_buffer = 4M </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-加密脚本">Linux 加密脚本<a href="#linux-加密脚本" class="hash-link" aria-label="Linux 加密脚本的直接链接" title="Linux 加密脚本的直接链接"> ​</a></h2>
<p>gzexe会把原来没有加密的文件备份为 test.sh~ ，同时test.sh 即被变成加密文件</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">gzexe  test.sh </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>gzexe解密</p>
<p>提取解密后的压缩文件1.gz到/tmp目录，其中的+44为上面的示例脚本中对应的乱码开始</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/tail -n +44 file.sh &gt;/tmp/1.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gunzip /tmp/1.gz</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>shc安装</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">wget http://www.datsi.fi.upm.es/~frosal/sources/shc-3.8.9.tgz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar xzvf shc-3.8.9.tgz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd shc-3.8.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p /usr/local/man/man1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make install</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>shc加密</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">shc -r -f test.sh  </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>运行后会生成两个文件test.sh.x 和 test.sh.x.c
test.sh.x：是加密后的可执行的二进制文件./test.sh.x 即可运行.
test.sh.x.c：是生成test.sh.x的原文件(c语言,可以直接删掉)</p>
<p>参数</p>
<ul>
<li>-e:  指定过期时间为20/10/2020（2020年10月20日）</li>
<li>-m: 过期后打印出的信息；</li>
<li>-v:  编译的详细情况</li>
<li>-r:  可在相同操作系统的不同主机上执行</li>
<li>-f:  指定源shell</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="dell服务器硬件信息查看">DELL服务器硬件信息查看<a href="#dell服务器硬件信息查看" class="hash-link" aria-label="DELL服务器硬件信息查看的直接链接" title="DELL服务器硬件信息查看的直接链接">​</a></h2>
<p>查看机器型号</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dmidecode | grep &quot;Product&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看厂商</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dmidecode | grep  &quot;Manufacturer&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看序列号</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dmidecode | grep  &quot;Serial Number&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看CPU信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dmidecode | grep  &quot;CPU&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看CPU个数</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dmidecode | grep  &quot;Socket Designation: CPU&quot; |wc –l</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看出厂日期</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dmidecode | grep &quot;Date&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看充电状态</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -AdpBbuCmd -GetBbuStatus -aALL |grep &quot;Charger Status&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示BBU状态信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -AdpBbuCmd -GetBbuStatus –aALL</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示BBU容量信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -AdpBbuCmd -GetBbuCapacityInfo –aALL</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示当前BBU属性</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -AdpBbuCmd -GetBbuProperties –aALL</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看充电进度百分比</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -AdpBbuCmd -GetBbuStatus -aALL |grep &quot;Relative State of Charge&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查询Raid阵列数</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -cfgdsply -aALL |grep &quot;Number of DISK GROUPS:&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示Raid卡型号，Raid设置，Disk相关信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -cfgdsply –aALL</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示所有物理信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDList -aALL</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示所有逻辑磁盘组信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDInfo -LALL –aAll</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看物理磁盘重建进度(重要)</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDRbld -ShowProg -PhysDrv [1:5] -a0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看适配器个数</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli –adpCount</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看适配器时间</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -AdpGetTime –aALL</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示所有适配器信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -AdpAllInfo –aAll</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看Cache 策略设置</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -cfgdsply -aALL |grep Polic</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>硬盘方面：</p>
<p><strong>1、查看所有物理磁盘信息</strong></p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDList -aALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter #0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enclosure Number: 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot Number: 5 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device Id: 5 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sequence Number: 2 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Media Error Count: 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Other Error Count: 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Predictive Failure Count: 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last Predictive Failure Event Seq Number: 0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Raw Size: 140014MB [0x11177328 Sectors] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Non Coerced Size: 139502MB [0x11077328 Sectors] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Coerced Size: 139392MB [0x11040000 Sectors] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Firmware state: Hotspare </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SAS Address(0): 0x5000c50008e5cca9 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SAS Address(1): 0x0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Inquiry Data: SEAGATE ST3146855SS     S5273LN4Y1X0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">..... </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>2、查看磁盘缓存策略</strong></p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDGetProp -Cache -L0 -a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter 0-VD 0: Cache Policy:WriteBack, ReadAheadNone, Direct </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDGetProp -Cache -L1 -a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter 0-VD 1: Cache Policy:WriteBack, ReadAheadNone, Direct </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDGetProp -Cache -LALL -a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter 0-VD 0: Cache Policy:WriteBack, ReadAheadNone, Direct </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter 0-VD 1: Cache Policy:WriteBack, ReadAheadNone, Direct </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDGetProp -Cache -LALL -aALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter 0-VD 0: Cache Policy:WriteBack, ReadAheadNone, Direct </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter 0-VD 1: Cache Policy:WriteBack, ReadAheadNone, Direct </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDGetProp -DskCache -LALL -aALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter 0-VD 0: Disk Write Cache : Disk&#x27;s Default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adapter 0-VD 1: Disk Write Cache : Disk&#x27;s Default </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>3、设置磁盘缓存策略</strong></p>
<ul>
<li>WT    (Write through)</li>
<li>WB    (Write back)</li>
<li>NORA  (No read ahead)</li>
<li>RA    (Read ahead)</li>
<li>ADRA  (Adaptive read ahead)</li>
</ul>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDSetProp WT|WB|NORA|RA|ADRA -L0 -a0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDSetProp -Cached|-Direct -L0 -a0 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enable / disable disk cache </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDSetProp -EnDskCache|-DisDskCache -L0 -a0 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>4、创建/删除 阵列</strong></p>
<p>创建一个 raid5 阵列，由物理盘 2,3,4 构成，该阵列的热备盘是物理盘 5</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -CfgLdAdd -r5 [1:2,1:3,1:4] WB Direct -Hsp[1:5] –a0 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>创建阵列，不指定热备</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -CfgLdAdd -r5 [1:2,1:3,1:4] WB Direct –a0 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>删除阵列</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -CfgLdDel -L1 –a0 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在线添加磁盘</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDRecon -Start -r5 -Add -PhysDrv[1:4] -L1 -a0 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>意思是，重建逻辑磁盘组1，raid级别是5，添加物理磁盘号：1:4。重建完后，新添加的物理磁盘会自动处于重建(同步)状态，这个 时候 fdisk -l是看不到阵列的空间变大的，只有在系统重启后才能看见。</p>
<p><strong>5、查看阵列初始化信息</strong></p>
<p>阵列创建完后，会有一个初始化同步块的过程，可以看看其进度。</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDInit -ShowProg -LALL -aALL </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>或者以动态可视化文字界面显示</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDInit -ProgDsply -LALL –aALL </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看阵列后台初始化进度</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDBI -ShowProg -LALL -aALL </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>或者以动态可视化文字界面显示</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -LDBI -ProgDsply -LALL -aALL </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>6、创建全局热备</strong>
指定第 5 块盘作为全局热备</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDHSP -Set [-EnclAffinity] [-nonRevertible] -PhysDrv[1:5] -a0 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>也可以指定为某个阵列的专用热备</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDHSP -Set [-Dedicated [-Array1]] [-EnclAffinity] [-nonRevertible] -PhysDrv[1:5] -a0 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>7、删除全局热备</strong></p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDHSP -Rmv -PhysDrv[1:5] -a0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪 贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>8、将某块物理盘下线/上线</strong></p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDOffline -PhysDrv [1:4] -a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDOnline -PhysDrv [1:4] -a0 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>9、查看物理磁盘重建进度</strong></p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">MegaCli -PDRbld -ShowProg -PhysDrv [1:5] -a0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="普通账号后再使用su--命令切换回root提示incorrect-password">普通账号后再使用su -命令切换回root提示&quot;incorrect password&quot;<a href="#普通账号后再使用su--命令切换回root提示incorrect-password" class="hash-link" aria-label="普通账号后再使用su -命令切换回root提示&quot;incorrect password&quot;的直接链接" title="普通账号后再使用su -命令切换回root提示&quot;incorrect password&quot;的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 4755 /bin/su</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="不打印空行和注释">不打印空行和注释<a href="#不打印空行和注释" class="hash-link" aria-label="不打印空行和注释的直接链接" title="不打印空行和注释的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">grep &#x27;^[a-Z]&#x27; filename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">egrep -v &quot;(^#|^$)&quot; filename</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="虚拟机在线添加磁盘">虚拟机在线添加磁盘<a href="#虚拟机在线添加磁盘" class="hash-link" aria-label="虚拟机在线添加磁盘的直接链接" title="虚拟机在线添加磁盘的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;- - -&quot; &gt; /sys/class/scsi_host/host2/scan</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="iptables通过lokkit开放端口">iptables通过lokkit开放端口<a href="#iptables通过lokkit开放端口" class="hash-link" aria-label="iptables通过lokkit开放端口的直接链接" title="iptables通过lokkit开放端口的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install -y lokkit</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>开放8000端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">lokkit -p 8000:tcp</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看libstdc库对应版本型号">查看libstdc库对应版本型号<a href="#查看libstdc库对应版本型号" class="hash-link" aria-label="查看libstdc库对应版本型号的直接链接" title="查看libstdc库对应版本型号的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">strings /usr/lib64/libstdc++.so.6  | grep GLIBCXX </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="fork-炸弹">fork 炸弹<a href="#fork-炸弹" class="hash-link" aria-label="fork 炸弹的直接链接" title="fork 炸弹的直接链接">​</a></h2>
<p>linux：</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">:(){ :|:&amp; };:</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>windows：</p>
<div class="language-powershell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-powershell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cmd /c @cd /d %temp% &amp; echo @start /min cmd ^&amp; cmd &gt; cmd.bat &amp; cmd</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="多个外网ip指定出口ip">多个外网ip指定出口ip<a href="#多个外网ip指定出口ip" class="hash-link" aria-label="多个外网ip指定出口ip的直接链接" title="多个外网ip指定出口ip的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -t nat -A POSTROUTING -s 0.0.0.0/0 -j SNAT --to-source 出口地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iptables -t nat -I POSTROUTING -d 0.0.0.0/0 -s 默认出口地址 -j SNAT --to-source 指定出口地址</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="ssh反向代理">ssh反向代理<a href="#ssh反向代理" class="hash-link" aria-label="ssh反向代理的直接链接" title="ssh反向代理的直接链接">​</a></h2>
<p>局域网主机：</p>
<p>ServerA / Linux / user userA / ip192.168.0.123 / ssh port 22</p>
<p>ServerB / Linux / user userB / ip192.168.0.125 / ssh port 22</p>
<p>PC / Windows / ip 192.168.0.128 / 远程桌面 port3389</p>
<p>远程主机：</p>
<p>MyServer / Linux / user me / ip 1.2.3.4 /ssh port 22</p>
<p>ssh参数：</p>
<ul>
<li>-N：不执行何指令</li>
<li>-f：后台执行</li>
<li>-R：建立reverse tunnel</li>
</ul>
<p>示例1：从MyServer ssh连回ServerA</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[userA@ServerA] $ ssh -NfR2222:localhost:22 me@MyServer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[me@MyServer] $ netstat -tnl | grep 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp       0      0 127.0.0.1:2222              0.0.0.0:*                   LISTEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[me@MyServer] $ ssh userA@127.0.0.1 -p 2222</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>MyServer连到2222 port会转向ServerA的ssh port，成功连接到ServerA</p>
<p>示例2：从MyServer ssh连回ServerB</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[userA@ServerA] $ ssh -NfR 2244:192.168.0.125:22me@MyServer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[me@MyServer] $ netstat -tnl | grep127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp       0      0 127.0.0.1:2244              0.0.0.0:*                   LISTEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[me@MyServer] $ ssh userB@127.0.0.1 -p 2244</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>MyServer连接到本机的2244 port会转向到ServerB的ssh port，成功连接到ServerB</p>
<p>示例3：从MyServer远程桌面PC</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[userA@ServerA] $ ssh -NfR2266:192.168.0.128:3389 me@MyServer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[me@MyServer] $ netstat -tnl | grep127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp       0      0 127.0.0.1:2266              0.0.0.0:*                   LISTEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[me@MyServer] $ rdesktop 127.0.0.1:2266</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>若你在Linux的桌面环境则可以直接display远程桌面PC，不然就export DISPLAY到其他主机。</p>
<p>此外，为了防止反向的Tunnel断开，还需要一个autossh工具，它可以帮助断线后自动重连。这个对我相当的重要，事实上我现在很少去B集群所在的地方。</p>
<p>对示例一做autossh可以如此做：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">[userA@ServerA] $ autossh -M 12345-NfR2222:localhost:22 me@MyServer</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当然，为了防止集群重启或断电等问题，可以将上语句写到开机启动脚本里。</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux端口转发">linux端口转发<a href="#linux端口转发" class="hash-link" aria-label="linux端口转发的直接链接" title="linux端口转发的直接链接">​</a></h2>
<p>开启数据包转发</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>转发本地端口8081到8080</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -t nat -A PREROUTING -p tcp --dport 8081 -j REDIRECT --to-port 8080</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>转发TCP 8081到xx.xx.xx.xx的80端口</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -t nat -I PREROUTING -p tcp --dport 8081 -j DNAT --to xx.xx.xx.xx:80</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使转发数据包实现“双向通路”，给数据包设置一个正确的返回通道</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -t nat -I POSTROUTING -p tcp --dport 8081 -j MASQUERADE</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将规则保存到/etc/sysconfig/iptables文件</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">service iptables save</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>重启iptables使刚才添加的规则生效</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">service iptables restart</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将访问192.168.10.10主机888端口的请求转发至22端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewll-cmd --permanent --zone=public --add-forward-port=port=888:proto=ssh:toport=22:toaddr=192.168.10.10</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>另外流量均衡技术也是常用的技术，比如将一台主机作为网站的前端服务器，将访问流量分流至内网中3台不同的主机上。</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A PREROUTING -i eth0 -p tcp --dport 80 -m state --state NEW -m nth --counter 0 --every 3 --packet 0 -j DNAT --to-destination 192.168.10.10:80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A PREROUTING -i eth0 -p tcp --dport 80 -m state --state NEW -m nth --counter 0 --every 3 --packet 0 -j DNAT --to-destination 192.168.10.11:80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A PREROUTING -i eth0 -p tcp --dport 80 -m state --state NEW -m nth --counter 0 --every 3 --packet 0 -j DNAT --to-destination 192.168.10.12:80</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="乱码名字文件通过inode修改文件名字">乱码名字文件通过inode修改文件名字<a href="#乱码名字文件通过inode修  改文件名字" class="hash-link" aria-label="乱码名字文件通过inode修改文件名字的直接链接" title="乱码名字文件通过inode修改文件名字的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ls -i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find -inum 文件的inode -exec mv {} 新名称 \;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="shell参数">Shell参数<a href="#shell参数" class="hash-link" aria-label="Shell参数的直接链接" title="Shell参数的直接链接">​</a></h2>
<p><strong>文件测试</strong></p>
<ul>
<li>
<p>[ -d /etc/fstab ]         测试/etc/fstab/是否为文件</p>
</li>
<li>
<p>-d                               测试是否为目录</p>
</li>
<li>
<p>-e                               测试文件或目录是否存在</p>
</li>
<li>
<p>-f                                判断是否为文件</p>
</li>
<li>
<p>-r                                测试当前用户是否有权限读取</p>
</li>
<li>
<p>-w                               测试当前用户是否有权限写入</p>
</li>
<li>
<p>-x                                测试当前用户是否有权限执行</p>
</li>
</ul>
<p><strong>逻辑测试</strong></p>
<ul>
<li>&amp;&amp;                              逻辑的与，“而且”的意思</li>
<li>||                                 逻辑的或，“或者”的意思</li>
<li>！                               逻辑的否</li>
</ul>
<p><strong>整数值比较</strong></p>
<ul>
<li>
<p>[ 10 -eq 10 ]               比较10是否等于10</p>
</li>
<li>
<p>-eq                             判断是否等于</p>
</li>
<li>
<p>-ne                             判断是否不等于</p>
</li>
<li>
<p>-gt                              判断是否大于</p>
</li>
<li>
<p>-lt                               判断是否小于</p>
</li>
<li>
<p>-le                              判断是否等于或小于</p>
</li>
<li>
<p>-ge                             判断是否大于或等于</p>
</li>
</ul>
<p><strong>字符串比较</strong></p>
<ul>
<li>
<p>[ -z $test ]                          判断变量是否为空值</p>
</li>
<li>
<p>[ $LANG != &quot;en.US&quot; ]         判断当前系统语言是否为英文</p>
</li>
<li>
<p>=                                         比较字符串内容是否相同</p>
</li>
<li>
<p>!=                                        比较字符串内容是否不同</p>
</li>
<li>
<p>-z                                        判断字符串内容是否为空</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="升级zabbix">升级zabbix<a href="#升级zabbix" class="hash-link" aria-label="升级zabbix的直接链接" title="升级zabbix的直接链接">​</a></h2>
<p>备份zabbix数据库</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mysqldump -u root -p123456 --opt --skip-lock-tables --flush-logs --database zabbix &gt; zabbix.sql</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>备份php源代码</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cd /usr/local/apache2/htdocs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mv zabbix zabbix.bak</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将原PHP源代码目录下的配置文件拷到新目录下</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cp zabbix.bak/conf/zabbix.conf.php zabbix/conf/</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>关闭zabbix系统服务(服务端和客户端)</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/init.d/zabbix_server stop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/init.d/zabbix_agentd stop</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>安装新zabbix</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">tar zxvf zabbix-2.2.0rc2.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd zabbix-2.2.0rc2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./configure --enable-server --enable-agent --with-mysql --enable-ipv6 --with-net-snmp --with-libcurl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make install</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux网页管理工具">Linux网页管理工具<a href="#linux网页管理工具" class="hash-link" aria-label="Linux网页管理工具的直接链接" title="Linux网页管理工具的直接链接">​</a></h2>
<p>webmin（ Unix系统管理工具）</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">wget http://prdownloads.sourceforge.net/webadmin/webmin-1.740.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar zxf webmin-1.740.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd webmin-1.740</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./setup.sh /usr/local/webmin</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://127.0.0.1:10000" target="_blank" rel="noopener noreferrer">https://127.0.0.1:10000</a></p>
<p>AppNode（高扩展 Linux 服务器管理面板）</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">bash -c &quot;$(curl http://dl.appnode.com/install.sh)&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="http://127.0.0.1:8888" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8888</a></p>
<p>Ajenti（ 轻型Linux 服务器管理面板 ）</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">bash -c &quot;$(curlhttps://raw.githubusercontent.com/Eugeny/ajenti/master/scripts/install-rhel.sh)&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://127.0.0.1:8000" target="_blank" rel="noopener noreferrer">https://127.0.0.1:8000</a></p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="centos65升级到centos7">centos6.5升级到centos7<a href="#centos65升级到centos7" class="hash-link" aria-label="centos6.5升级到centos7的直接链接" title="centos6.5升级到centos7的直接链接">​</a></h2>
<p>redhat提供了一个redhat-upgrade-tool的升级工具</p>
<p>配置软件源</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vi /etc/yum.repos.d/upgrade.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[upgrade]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name=upgrade</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseurl=http://dev.centos.org/centos/6/upg/x86_64/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enable=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgcheck=0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>安装软件工具</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install preupgrade-assistant-contents redhat-upgrade-tool preupgrade-assistant</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>升级前检查潜在问题</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">preupg</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>开始升级</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">rpm --import http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redhat-upgrade-tool --network 7.0 --instrepo http://centos.excellmedia.net/7.0.1406/os/x86_64/</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>重启</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">reboot</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装zabbix报错解决方法">安装zabbix报错解决方法<a href="#安装zabbix报错解决方法" class="hash-link" aria-label="安装zabbix报错解决方法的直接链接" title="安装zabbix报错解决方法的直接链接">​</a></h2>
<p>configure: error: Jabber library not found</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install iksemel-devel</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>configure: error: LIBXML2 library not found</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install libxml2-devel</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>configure: error: unixODBC library not found</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install unixODBC-devel</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>configure: error: Invalid OPENIPMI directory - unable to findipmiif.h</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install OpenIPMI-devel</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>configure:error: Unable to find &quot;javac&quot; executable in path</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install java*</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>configure: error: Curl library not found</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install curl-devel</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="调整根分区大小">调整根分区大小<a href="#调整根分区大小" class="hash-link" aria-label="调整根分区大小的直接链接" title="调整根分区大小的直接链接">​</a></h2>
<p>使用光盘进入Rescue installed system 依次选择不加载网络不挂载文件系统进入命令行</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vgscan                                                  #显示卷组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vgchange -ay /dev/volGroup00                            #卷组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e2fsck -f /dev/volGroup00/LogVol00                      #检查磁盘是否正确</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resize2fs -p /dev/volGroup00/LogVol00 10G               #设置LogVol00卷组大小为10G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fsck /dev/volGroup00/LogVol00                           #修复错误</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lvreduce -L 10G /dev/volGroup00/LogVol00                #收缩LogVol00卷组大小为10G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">umount /data                                            #取消挂载</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lvextend -L +4G /dev/volGroup00/LogVol01                #增加LogVol01卷组大小</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resize2fs -p /dev/volGroup00/LogVol01                   #df看不到空间增加使 用此命令激活</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux连接wpa加密的wifi">linux连接wpa加密的wifi<a href="#linux连接wpa加密的wifi" class="hash-link" aria-label="linux连接wpa加密的wifi的直接链接" title="linux连接wpa加密的wifi的直接链接">​</a></h2>
<p>生成psk</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">wpa_passphrase ssid passwd</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>把生成的psk加入配置文件/etc/wpa_supplicant.conf</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ctrl_interface=/var/run/wpa_supplicant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ctrl_interface_group=wheel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network={</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ssid=&quot;TP-LINK_413&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #psk=&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  psk=e69abb9b46dcbf8df67738a2eda466c54b3f12043e54157d58e097c3e19fa2e3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  proto=RSN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  key_mgmt=WPA-PSK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pairwise=CCMP TKIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  group=CCMP TKIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>连接wifi</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">wpa_supplicant -Dwext -iwlan0 -c/etc/wpa_supplicant.conf -dd -B</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="系统初始化脚本">系统初始化脚本<a href="#系统初始化脚本" class="hash-link" aria-label="系统初始化脚本的直接链接" title="系统初始化脚本的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ $(id -u) != 0 ];then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	echo &quot;Must be root can do this.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	exit 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># set privileges</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 600 /etc/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 600 /etc/shadow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 600 /etc/group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 600 /etc/gshadow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Set important files privileges sucessfully&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#close ctrl+alt+del</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &quot;s/ca::ctrlaltdel:\/sbin\/shutdown -t3 -r now/#ca::ctrlaltdel:\/sbin\/shutdown -t3 -r now/&quot; /etc/inittab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &#x27;s/^id:5:initdefault:/id:3:initdefault:/&#x27; /etc/inittab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#close ipv6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;alias net-pf-10 off&quot; &gt;&gt; /etc/modprobe.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;alias ipv6 off&quot; &gt;&gt; /etc/modprobe.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/sbin/chkconfig --level 35 ip6tables off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo -e &quot;\033[031m ipv6 is disabled.\033[0m&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#shutdown SELinux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &#x27;/SELINUX/s/enforcing/disabled/&#x27; /etc/selinux/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo -e &quot;\033[31m selinux is disabled,if you need,you must reboot.\033[0m&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &quot;8 s/^/alias vi=&#x27;vim&#x27;/&quot; /root/.bashrc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;syntax on&#x27; &gt; /root/.vimrc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#update yum source</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mv -f /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -s http://mirrors.163.com/.help/CentOS6-Base-163.repo -o /etc/yum.repos.d/CentOS-Base.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum clean all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum makecache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#install common software</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install openssh-clients man wget yum-utils vim-enhanced lrzsz telnet traceroute glibc-headers gcc make autoconf libtool automake gcc-c++ openssl openssl-devel unzip zip lrzsz openssl openssl-devel pcre pcre-devel gcc make automake vim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Turn off unnecessary services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service=($(ls /etc/init.d/))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in ${service[@]}; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	case $i in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		sshd|network|syslog|crond)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			chkconfig $i on;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			chkconfig $i off;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	esac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#set ulimit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt;&gt; /etc/security/limits.conf &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* soft nofile 165535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* hard nofile 165535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># set sysctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/sysctl.conf &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.ip_forward = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.conf.default.rp_filter = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.conf.default.accept_source_route = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel.sysrq = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel.core_uses_pid = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel.msgmnb = 65536</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel.msgmax = 65536</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel.shmmax = 68719476736</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel.shmall = 4294967296</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_max_tw_buckets = 6000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_sack = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_window_scaling = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_rmem = 4096 87380 4194304</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_wmem = 4096 16384 4194304</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.core.wmem_default = 8388608</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.core.rmem_default = 8388608</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.core.rmem_max = 16777216</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.core.wmem_max = 16777216</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.core.netdev_max_backlog = 262144</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.core.somaxconn = 262144</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_max_orphans = 3276800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_syncookies = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_max_syn_backlog = 262144</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_timestamps = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_synack_retries = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_syn_retries = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_tw_recycle = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_tw_reuse = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_mem = 94500000 915000000 927000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_fin_timeout = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.tcp_keepalive_time = 1200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net.ipv4.ip_local_port_range = 1024 65535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vm.swappiness = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;0 0 * * * /usr/sbin/ntpdate cn.pool.ntp.org &amp;&gt;/dev/null&quot; &gt;&gt;/var/spool/cron/root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;All things is init ok! &quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看cpu信息">查看cpu信息<a href="#查看cpu信息" class="hash-link" aria-label="查看cpu信息的直接链接" title="查看cpu信息的直接链接">​</a></h2>
<p><strong>总核数 = 物理CPU个数 X 每颗物理CPU的核数</strong></p>
<p><strong>总逻辑CPU数 = 物理CPU个数 X 每颗物理CPU的核数 X 超线程数</strong></p>
<p>查看物理CPU个数</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/cpuinfo| grep &quot;physical id&quot;| sort| uniq| wc -l</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看每个物理CPU中core的个数(即核数)</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/cpuinfo| grep &quot;cpu cores&quot;| uniq</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看逻辑CPU的个数</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/cpuinfo| grep &quot;processor&quot;| wc -l</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看CPU信息（型号 ）</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看所有cpu信息</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">lscpu</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="svn迁移">svn迁移<a href="#svn迁移" class="hash-link" aria-label="svn迁移的直接链接" title="svn迁移的直接链接">​</a></h2>
<p>如果不包括日志，只需要checkout最新版本，svn export出干净的项目，然后import到新的服务器的svn.
如果需要日志，方法如下：</p>
<p>把项目的各个版本dump出来</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">svnadmin dump /path/to/repository &gt; repo_name.svn_dump</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在新的服务器上创建新的知识库</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">svnadmin create /path/to/repository</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>把项目载入到知识库里</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">svnadmin load /path/to/repository &lt; repo_name.svn_dump</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>拷贝源服务器上的配置文件
authz
passwd
svnserve.conf</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="vim-快捷键">vim 快捷键<a href="#vim-快捷键" class="hash-link" aria-label="vim 快捷键的直接链接" title="vim 快捷键的直接链接">​</a></h2>
<table><thead><tr><th style="text-align:center">命令</th><th style="text-align:center">功能</th></tr></thead><tbody><tr><td style="text-align:center">u</td><td style="text-align:center">撤销上一步的操作</td></tr><tr><td style="text-align:center">Ctrl+r</td><td style="text-align:center">恢复上一步被撤销的操作</td></tr><tr><td style="text-align:center">:%s/^ //</td><td style="text-align:center">删除行首空格</td></tr><tr><td style="text-align:center">:%s/r//g</td><td style="text-align:center">删除DOS方式的回车^M</td></tr><tr><td style="text-align:center">:%s= *$==</td><td style="text-align:center">删除行尾空白</td></tr><tr><td style="text-align:center">:%s/^(.*)n1/1$/</td><td style="text-align:center">删除重复行</td></tr><tr><td style="text-align:center">:%s/^.pdf/new.pdf/</td><td style="text-align:center">只是删除第一个pdf</td></tr><tr><td style="text-align:center">:g<!-- -->/^s*$/d</td><td style="text-align:center">删除所有空行</td></tr><tr><td style="text-align:center">:g<!-- -->!/^dd/d</td><td style="text-align:center">删除不含字符串&#x27;dd&#x27;的行</td></tr><tr><td style="text-align:center">:v<!-- -->/^dd/d</td><td style="text-align:center">同上 （译释：v == g!，就是不匹配！）</td></tr><tr><td style="text-align:center">:g<!-- -->/str1/,/str2/d</td><td style="text-align:center">删除所有第一个含str1到第一个含str2之间的行</td></tr><tr><td style="text-align:center">:v<!-- -->/./.,/./-1join</td><td style="text-align:center">合并连续空行</td></tr><tr><td style="text-align:center">:g<!-- -->/^$/,/./-j</td><td style="text-align:center">合并连续空行</td></tr><tr><td style="text-align:center">ndw 或 ndW</td><td style="text-align:center">删除光标处开始及其后的 n-1 个字符</td></tr><tr><td style="text-align:center">d0</td><td style="text-align:center">删至行首</td></tr><tr><td style="text-align:center">d$</td><td style="text-align:center">删至行尾</td></tr><tr><td style="text-align:center">ndd</td><td style="text-align:center">删除当前行及其后 n-1 行</td></tr><tr><td style="text-align:center">x 或 X</td><td style="text-align:center">删除一个字符</td></tr><tr><td style="text-align:center">Ctrl+u</td><td style="text-align:center">输入模式下删除当前所输入的文本</td></tr><tr><td style="text-align:center">^R</td><td style="text-align:center">恢复u的操作</td></tr><tr><td style="text-align:center">J</td><td style="text-align:center">把下一行合并到当前行尾</td></tr><tr><td style="text-align:center">V</td><td style="text-align:center">选择一行</td></tr><tr><td style="text-align:center">^V</td><td style="text-align:center">按下^V后即可进行矩形的选择了</td></tr><tr><td style="text-align:center">aw</td><td style="text-align:center">选择单词</td></tr><tr><td style="text-align:center">iw</td><td style="text-align:center">内部单词(无空格)</td></tr><tr><td style="text-align:center">as</td><td style="text-align:center">选择句子</td></tr><tr><td style="text-align:center">is</td><td style="text-align:center">选择句子(无空格)</td></tr><tr><td style="text-align:center">ap</td><td style="text-align:center">选择段落</td></tr><tr><td style="text-align:center">ip</td><td style="text-align:center">选择段落(无空格)</td></tr><tr><td style="text-align:center">D</td><td style="text-align:center">删除到行尾</td></tr><tr><td style="text-align:center">x,y</td><td style="text-align:center">删除与复制包含高亮区</td></tr><tr><td style="text-align:center">dl</td><td style="text-align:center">删除当前字符（与x命令功能相同）</td></tr><tr><td style="text-align:center">d0</td><td style="text-align:center">删除到某一行的开始位置</td></tr><tr><td style="text-align:center">d^</td><td style="text-align:center">删除到某一行的第一个字符位置（不包括空格或TAB字符）</td></tr><tr><td style="text-align:center">dw</td><td style="text-align:center">删除到某个单词的结尾位置</td></tr><tr><td style="text-align:center">d3w</td><td style="text-align:center">删除到第三个单词的结尾位置</td></tr><tr><td style="text-align:center">db</td><td style="text-align:center">删除到某个单词的开始位置</td></tr><tr><td style="text-align:center">dW</td><td style="text-align:center">删除到某个以空格作为分隔符的单词的结尾位置</td></tr><tr><td style="text-align:center">dB</td><td style="text-align:center">删除到某个以空格作为分隔符的单词的开始位置</td></tr><tr><td style="text-align:center">d7B</td><td style="text-align:center">删除到前面7个以空格作为分隔符的单词的开始位置</td></tr><tr><td style="text-align:center">d)</td><td style="text-align:center">删除到某个语句的结尾位置</td></tr><tr><td style="text-align:center">d4)</td><td style="text-align:center">删除到第四个语句的结尾位置</td></tr><tr><td style="text-align:center">d(</td><td style="text-align:center">删除到某个语句的开始位置</td></tr><tr><td style="text-align:center">d)</td><td style="text-align:center">删除到某个段落的结尾位置</td></tr><tr><td style="text-align:center">d{</td><td style="text-align:center">删除到某个段落的开始位置</td></tr><tr><td style="text-align:center">d7{</td><td style="text-align:center">删除到当前段落起始位置之前的第7个段落位置</td></tr><tr><td style="text-align:center">dd</td><td style="text-align:center">删除当前行</td></tr><tr><td style="text-align:center">d/text</td><td style="text-align:center">删除从文本中出现“text”中所指定字样的位置，一直向前直到下一个该字样所出现的位置（但不包括该字样）之间的内容</td></tr><tr><td style="text-align:center">dfc</td><td style="text-align:center">删除从文本中出现字符“c”的位置，一直向前直到下一个该字符所出现的位置（包括该字符）之间的内容</td></tr><tr><td style="text-align:center">dtc</td><td style="text-align:center"> 删除当前行直到下一个字符“c”所出现位置之间的内容</td></tr><tr><td style="text-align:center">D</td><td style="text-align:center">删除到某一行的结尾</td></tr><tr><td style="text-align:center">d$</td><td style="text-align:center">删除到某一行的结尾</td></tr><tr><td style="text-align:center">5dd</td><td style="text-align:center">删除从当前行所开始的5行内容</td></tr><tr><td style="text-align:center">dL</td><td style="text-align:center">删除直到屏幕上最后一行的内容</td></tr><tr><td style="text-align:center">dH</td><td style="text-align:center">删除直到屏幕上第一行的内容</td></tr><tr><td style="text-align:center">dG</td><td style="text-align:center">删除直到工作缓存区结尾的内容</td></tr><tr><td style="text-align:center">d1G</td><td style="text-align:center">删除直到工作缓存区开始的内容</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="挂载ntfs分区">挂载ntfs分区<a href="#挂载ntfs分区" class="hash-link" aria-label="挂载ntfs分区的直接链接" title="挂载ntfs分区的直接链接">​</a></h2>
<p>步骤一：解压安装NTFS-3G。
tar -xvzf ntfs-3g_ntfsprogs-2012.1.15.tgz
cd ntfs-3g_ntfsprogs-2012.1.15
执行安装过程如下所示:
　　./configure
　　make
　　make install
之后系统会提示安装成功，下面就可以用ntfs-3g来实现对NTFS分区的读写了</p>
<p>步骤二:配置挂载NTFS格式的移动硬盘</p>
<ol>
<li>
<p>首先得到NTFS分区的信息
fdisk -l | grep NTFS</p>
</li>
<li>
<p>设置挂载点，用如下命令实现挂载
mount -t ntfs-3g  [NTFS Partition] [Mount Point]</p>
</li>
</ol>
<p>例如得到的NTFS分区信息为/dev/sdc1，挂载点设置在/mnt/usb下，可以用
mount -t ntfs-3g /dev/sdc1 /mnt/usb
或者直接用
ntfs-3g ntfs-3g /dev/sdc1 /mnt/usb</p>
<ol start="3">
<li>如果想实现开机自动挂载，可以在/etc/fstab里面添加如下格式语句
[NTFS Partition]  [Mount Point] ntfs-3g silent,umask=0,locale=zh_CN.utf8 0 0
这样可以实现NTFS分区里中文文件名的显示。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="修改单个用户字符集">修改单个用户字符集<a href="#修改单个用户字符集" class="hash-link" aria-label="修改单个用户字符集的直接链接" title="修改单个用户字符集的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vi ~/.bashrc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export LC_CTYPE=&quot;zh_CN.gbk&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看服务器硬件信息">查看服务器硬件信息<a href="#查看服务器硬件信息" class="hash-link" aria-label="查看服务器硬件信息的直接链接" title="查看服务器硬件信息的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install epel-release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install inxi</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>inxi -A 显示音频信息</li>
<li>inxi -G 显示显卡信息</li>
<li>inxi -D 显示硬盘信息</li>
<li>inxi -M 显示主板信息</li>
<li>inxi -r 显示可用仓库列表</li>
<li>inxi -F 显示全部信息</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="zabbix监控exsi">zabbix监控exsi<a href="#zabbix监控exsi" class="hash-link" aria-label="zabbix监控exsi的直接链接" title="zabbix监控exsi的直接链接">​</a></h2>
<p>编译安装</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">./configure --prefix=/usr/local/zabbix --enable-server --enable-agent --with-mysql --with-net-snmp --with-libcurl --with-libxml2</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>配置文件添加参数</p>
<div class="language-tilte=zabbix_server.conf codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-tilte=zabbix_server.conf codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">StartVMwareCollectors=50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VMwareFrequency=60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VMwareCacheSize=128M</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="服务器网络死掉">服务器网络死掉<a href="#服务器网络死掉" class="hash-link" aria-label="服务器网络死掉的直接链接" title="服务器网络死掉的直接链接">​</a></h2>
<p>查看网卡流量状况，是哪个ip</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptraf</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>发现流量不正常的IP,使用iptables封掉</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -I OUTPUT -d IP地址 -j DROP</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>封掉所有UDP端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -I OUTPUT -p UDP -j DROP</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看网络连接数">查看网络连接数<a href="#查看网络连接数" class="hash-link" aria-label="查看网络连接数的直接链接" title="查看网络连接数的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">netstat -n | awk &#x27;/^tcp/ {n=split($(NF-1),array,&quot;:&quot;);if(n&lt;=2)++S[array[(1)]];else++S[array[(4)]];++s[$NF];++N} END {for(a in S){printf(&quot;%-20s %s\n&quot;, a, S[a]);++I}printf(&quot;%-20s %s\n&quot;,&quot;TOTAL_IP&quot;,I);for(a in s) printf(&quot;%-20s %s\n&quot;, a, s[a]);printf(&quot;%-20s %s\n&quot;,&quot;TOTAL_LINK&quot;,N);}&#x27;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="批量修改服务器密码">批量修改服务器密码<a href="#批量修改服务器密码" class="hash-link" aria-label="批量修改服务器密码的直接链接" title="批量修改服务器密码的直接链接">​</a></h2>
<p>创建服务器列表文件，格式如下(前边是IP，中间是当前登陆密码，第三列是要修改的密码)</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vi iplist.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.1.100 123456 123abc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.1.101 654321 abc123</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>创建expect交互式脚本</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/expect -f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set IP [lindex $argv 0]    ##设置IP为第一个带入项，也就是上边脚本的$i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set PASSWORD [lindex $argv 1]  ##同理，第二个带入项，$y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set NEWPASSWORD [lindex $argv 2]  ##同理，第三个带入项，$z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spawn ssh $IP &quot; echo &#x27;$NEWPASSWORD&#x27;| passwd --stdin root &quot;  ##spawn后边跟要执行的命令，此例是把root密码改成iplist.txt中的第三列的数值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expect {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &quot;(yes/no)&quot; { send &quot;yes\r&quot;; exp_continue }   ##如果第一次登陆，就发送yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &quot;password:&quot; { send &quot;$PASSWORD\r&quot;; exp_continue }    ##发送登陆密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &quot;*?&quot; { send &quot;\r&quot; }  ##没有交互直接发个回车</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>创建一个bash脚本，通过for循环读取IP和密码，然后给expect脚本</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in `awk &#x27;{print $1}&#x27; iplist.txt`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y=`awk /${i}/&#x27;{print $2}&#x27; iplist.txt`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    z=`awk /${i}/&#x27;{print $3}&#x27; iplist.txt`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ./expect.sh ${i} ${y} ${z}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="配置ssh信任关系">配置ssh信任关系<a href="#配置ssh信任关系" class="hash-link" aria-label="配置ssh信任关系的直接链接" title="配置ssh信任关系的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen -t rsa</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-copy-id root@172.16.1.3</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="ansible使用">ansible使用<a href="#ansible使用" class="hash-link" aria-label="ansible使用的直接链接" title="ansible使用的直接链接">​</a></h2>
<p>远程文件信息查看</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ansible storm_cluster -m command -a &quot;ls -al /tw/test.sh&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将本地文件<code>/etc/ansible/ansible.cfg</code>复制到远程服务器</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ansible storm_cluster -m copy -a &quot;src=/etc/ansible/ansible.cfg dest=/tmp/ansible.cfg owner=root group=root mode=0644&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在远程主机上执行命令</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ansible storm_cluster -m command -a &quot;uptime&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>远程执行脚本</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ansible storm_cluster -m shell -a &quot;/tmp/test.sh&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看设备oid值">查看设备OID值<a href="#查看设备oid值" class="hash-link" aria-label="查看设备OID值的直接链接" title="查看设备OID值的直接链接">​</a></h2>
<p>安装snmpwalk</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install net-snmp-utils</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>获取端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">snmpwalk 10.6.9.1 -v1 -c public|grep -i ifinoctet</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注:默认端口排序WAN1(256)、WAN2(257)、VLAN1(258)、LAN1(1794)、LAN2(1795)......LAN10、Loopback(2816)</p>
<p>查看端口oid</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">snmpget -v1 -c public -On 10.6.9.1 ifInOctets.256</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="ssh登录错误次数较多的ip用iptables封掉脚本">ssh登录错误次数较多的IP用iptables封掉脚本<a href="#ssh登录错误次数较多的ip用iptables封掉脚本" class="hash-link" aria-label="ssh登录错误次数较多的IP用iptables封掉脚本的直接链接" title="ssh登录错误次数较多的IP用iptables封掉脚本的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num=10 #上限</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in `awk &#x27;/Failed/{print $(NF-3)}&#x27; /var/log/secure|sort|uniq -c|sort -rn|awk &#x27;{if ($1&gt;$num){print $2}}&#x27;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iptables -I INPUT -p tcp -s $i --dport 22 -j DROP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="  复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="iptables添加多个端口脚本">iptables添加多个端口脚本<a href="#iptables添加多个端口脚本" class="hash-link" aria-label="iptables添加多个端口脚本的直接链接" title="iptables添加多个端口脚本的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SERVICES=&quot;80 22 25 110 8000 23 20 21 3306&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for x in $SERVICES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iptables -A INPUT -p tcp --dport $x -m state --state NEW -j ACCEPT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="ssh连接只显示-bash-41">ssh连接只显示-bash-4.1#<a href="#ssh连接只显示-bash-41" class="hash-link" aria-label="ssh连接只显示-bash-4.1#的直接链接" title="ssh连接只显示-bash-4.1#的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vi ~/.bash_profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PS1=&#x27;[\u@\h \W]\$’</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="iptables-设置限制mac地址">iptables 设置限制mac地址<a href="#iptables-设置限制mac地址" class="hash-link" aria-label="iptables 设置限制mac地址的直接链接" title="iptables 设置限制mac地址的直接链接">​</a></h2>
<p>允许MAC地址为XX:XX:XX:XX:XX<!-- -->:XX<!-- -->主机访问22端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -A INPUT -p tcp --destination-port 22 -m mac --mac-source XX:XX:XX:XX:XX:XX -j ACCEPT</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="不重启关闭selinux">不重启关闭selinux<a href="#不重启关闭selinux" class="hash-link" aria-label="不重启关闭selinux的直接链接" title="不重启关闭selinux的直接链接">​</a></h2>
<p>设置SELinux 成为enforcing模式</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">setenforce 1</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>设置SELinux 成为permissive模式</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">setenforce 0</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="添加高级路由">添加高级路由<a href="#添加高级路由" class="hash-link" aria-label="添加高级路由的直接链接" title="添加高级路由的直接链接">​</a></h2>
<p>路由表目录: /etc/iproute2/rt_tables</p>
<p>创建一个路由表test</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;252 test&quot; &gt;&gt; /etc/iproute2/rt_tables</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>定义test表默认路由去往10.10.0.1网关</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ip route add default via 10.10.0.1 dev em1 table test</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>10.10.10.2应用test路由表</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ip rule add from 10.10.10.2 table test</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>10.0.0.0/16这个段ip应用test路由表（pref 1000为优先级）</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ip rule add to 10.0.0.0/16 pref 1000 table test</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查询ip路由信息">查询ip路由信息<a href="#查询ip路由信息" class="hash-link" aria-label="查询ip路由信息的直接链接" title="查询ip路由信息的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">ip route get 8.8.8.8 </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">mtr 8.8.8.8</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="修改ssh基于密码验证">修改ssh基于密码验证<a href="#修改ssh基于密码验证" class="hash-link" aria-label="修改ssh基于密码验证的直接链接" title="修改ssh基于密码验证的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vi /etc/ssh/sshd_config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PasswordAuthentication yes</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装logwatch">安装logwatch<a href="#安装logwatch" class="hash-link" aria-label="安装logwatch的直接链接" title="安装logwatch的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">rpm -Uvh ftp://ftp.kaybee.org/pub/redhat/RPMS/noarch/logwatch-7.3.6-1.noarch.rpm</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="you-have-new-mail-in-varspoolmailroot-解决方法">You have new mail in /var/spool/mail/root 解决方法<a href="#you-have-new-mail-in-varspoolmailroot-解决方法" class="hash-link" aria-label="You have new mail in /var/spool/mail/root 解决方法的直接链接" title="You have new mail in /var/spool/mail/root 解决方法的直接链接">​</a></h2>
<div class="language-json codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-json codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;unset MAILCHECK&quot; &gt;&gt; /etc/profile</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="设置自动同步时间">设置自动同步时间<a href="#设置自动同步时间" class="hash-link" aria-label="设置自动同步时间的直接链接" title="设置自动同步时间的直接链接">​</a></h2>
<p>crontab -e  加入
*/30 * * * * /usr/sbin/ntpdate time.windows.com  （每30分钟同步一次）
*/30 * * * * /usr/sbin/ntpdate us.pool.ntp.org
*/30 * * * * /usr/sbin/ntpdate time.nist.gov</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装sz-rz命令">安装sz rz命令<a href="#安装sz-rz命令" class="hash-link" aria-label="安装sz rz命令的直接链接" title="安装sz rz命令的直接链接">​</a></h2>
<div class="language-json codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-json codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install lrzsz</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="yum无pptpd">yum无pptpd<a href="#yum无pptpd" class="hash-link" aria-label="yum无pptpd的直接链接" title="yum无pptpd的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">rpm -Uvh http://poptop.sourceforge.net/yum/stable/pptp-release-current.noarch.rpm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install pptpd</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="升级gcc后使用filezilla报错">升级GCC后使用filezilla报错<a href="#升级gcc后使用filezilla报错" class="hash-link" aria-label="升级GCC后使用filezilla报错的直接链接" title="升级GCC后使用filezilla报错的直接链接">​</a></h2>
<p>执行命令查看有没有相应的库</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"> strings /usr/lib64/libstdc++.so.6 | grep GLIBCXX</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-安装dns">linux 安装DNS<a href="#linux-安装dns" class="hash-link" aria-label="linux 安装DNS的直接链接" title="linux 安装DNS的直 接链接">​</a></h2>
<p>caching-nameserver（除bind以外的另一个安装包）</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装本地rpm包">安装本地rpm包<a href="#安装本地rpm包" class="hash-link" aria-label="安装本地rpm包的直接链接" title="安装本地rpm包的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum localinstall --nogpgcheck rpmname</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="ipsec安装">ipsec安装<a href="#ipsec安装" class="hash-link" aria-label="ipsec安装的直接链接" title="ipsec安装的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y install openswan</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="测试硬盘读写速度">测试硬盘读写速度<a href="#测试硬盘读写速度" class="hash-link" aria-label="测试硬盘读写速度的直接链接" title="测试硬盘读写速度的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dd if=/root/1Gb.file bs=64k | dd of=/dev/null</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dd if=/dev/zero of=/root/1Gb.file bs=1024 count=1000000</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通过上两个命令输出的执行时间，可以计算出测试硬盘的读／写速度</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="销毁磁盘数据">销毁磁盘数据<a href="#销毁磁盘数据" class="hash-link" aria-label="销毁磁盘数据的直接链接" title="销毁磁盘数据的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">dd if=/dev/urandom of=/dev/hda1</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>利用随机的数据填充硬盘，在某些必要的场合可以用来销毁数据。执行此操作以后，/dev/hda1将无法挂载，创建和拷贝操作无法执行。</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看系统所有用户和组">查看系统所有用户和组<a href="#查看系统所有用户和组" class="hash-link" aria-label="查看系统所有用户和组的直接链接" title="查看系统所有用户和组的直接链接">​</a></h2>
<p>所有用户</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cut -d: -f1 /etc/passwd</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>所有组</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cut -d: -f1 /etc/group</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看用户登录日志">查看用户登录日志<a href="#查看用户登录日志" class="hash-link" aria-label="查看用户登录日志的直接链接" title="查看用户登录日志的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">last</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看系统版本">查看系统版本<a href="#查看系统版本" class="hash-link" aria-label="查看系统版本的直接链接" title="查看系统版本的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/redhat-release</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">lsb_release -a</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>yum install -y redhat-lsb </code>安装lsb_release命令</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="输出最为常用的十条命令">输出最为常用的十条命令<a href="#输出最为常用的十条命令" class="hash-link" aria-label="输出最为常用的十条命令的直接链接" title="输出最为常用的十条命令的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">history|awk &#x27;{CMD[$2]++;count++;} END {for(a in CMD)print CMD[a]&quot; &quot;CMD[a]/count*100 &quot;% &quot; a}&#x27;|grep -v &quot;./&quot;|column -c3 -s &quot; &quot; -t|sort -nr|nl|head -n10</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="anaconda-kscfg">anaconda-ks.cfg<a href="#anaconda-kscfg" class="hash-link" aria-label="anaconda-ks.cfg的直接链接" title="anaconda-ks.cfg的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"># Kickstart file automatically generated by anaconda.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#version=DEVEL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cdrom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lang en_US.UTF-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keyboard us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network --onboot no --device em1 --bootproto dhcp --noipv6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network --onboot no --device em2 --bootproto dhcp --noipv6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rootpw abcu123456</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firewall --disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">authconfig --enableshadow --passalgo=sha512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selinux --disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timezone --utc Asia/Shanghai</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bootloader --location=mbr --driveorder=sda --append=&quot;crashkernel=auto rhgb quiet&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The following is the partition information you requested</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Note that any partitions you deleted are not expressed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># here so unless you clear all partitions first, this is</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># not guaranteed to work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#clearpart --none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clearpart --all --initlabel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zerombr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">part /boot --fstype=ext4 --size=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">part swap --size=32000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">part pv.008003 --grow --size=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ignoredisk --only-use=sda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volgroup volGroup00 --pesize=4096 pv.008003</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logvol / --fstype=ext4 --name=LogVol00 --vgname=volGroup00 --size=200000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logvol /data --fstype=ext4 --name=LogVol01 --vgname=volGroup00 --size=1655232</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reboot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#repo --name=&quot;CentOS&quot;  --baseurl=cdrom:sr0 --cost=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%packages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@chinese-support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@server-policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%end</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux-卸载rpm">linux 卸载rpm<a href="#linux-卸载rpm" class="hash-link" aria-label="linux 卸载rpm的直接链接" title="linux 卸载rpm的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">rpm -aq|grep rpmname |xargs rpm -e --nodeps</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装gbd出现--cc1plus-warnings-being-treated-as-errors-错误解决方法">安装GBD出现  cc1plus: warnings being treated as errors 错误解决方法<a href="#安装gbd出现--cc1plus-warnings-being-treated-as-errors-错误解决方法" class="hash-link" aria-label="安装GBD出现  cc1plus: warnings being treated as errors 错误解决方法的直接链接" title="安装GBD出现  cc1plus: warnings being treated as errors 错误解决方法的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">./configure --prefix=/usr/local/gdb --with-mpc=/usr/local/mpc --with=mpfr=/usr/local/mpfr --with-gmp=/usr/local/gmp/ --disable-werror</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="沒有nslookuphostdig命令">沒有nslookup、host、dig命令<a href="#沒有nslookuphostdig命令" class="hash-link" aria-label="沒有nslookup、host、dig命令的直接链接" title="沒有nslookup、host、dig命令的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install bind-utils</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="配置多个tomcat">配置多个tomcat<a href="#配置多个tomcat" class="hash-link" aria-label="配置多个tomcat的直接链接" title="配置多个tomcat的直接链接">​</a></h2>
<p>1、两个tomcat路径</p>
<p>/usr/local/tomcat
/usr/local/tomcat2</p>
<p>2、配置环境变量，在/etc/profile最后添加：</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">TOMCAT_HOME_1=/usr/local/tomcat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CATALINA_BASE_1=/usr/local/tomcat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CATALINA_HOME_1=/usr/local/tomcat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export TOMCAT_HOME_1 CATALINA_BASE_1 CATALINA_HOME_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TOMCAT_HOME_2=/usr/local/tomcat2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CATALINA_BASE_2=/usr/local/tomcat2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CATALINA_HOME_2=/usr/local/tomcat2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export TOMCAT_HOME_2 CATALINA_BASE_2 CATALINA_HOME_2</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3、修改tomcat2启动、关闭脚本，最后分别添加如下：</p>
<p>/usr/local/tomcat2/bin/start.sh
/usr/local/tomcat2/bin/shutdown.sh</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">export JAVA_HOME=/usr/local/java</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PATH=$PATH:$JAVA_HOME/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CLASSPATH=$JAVA_HOME/lib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CATALINA_HOME=$CATALINA_HOME_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CATALINA_BASE=$CATALINA_BASE_2</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>4、修改tomcat2配置文件，主要修改端口：</p>
<p>/usr/local/tomcat2/conf/server.xml</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Server port=&quot;8006&quot; shutdown=&quot;SHUTDOWN&quot;&gt; #此处的8005已改为8006</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Connector port=&quot;8081&quot; protocol=&quot;HTTP/1.1&quot; connectionTimeout=&quot;20000&quot; redirectPort=&quot;8443&quot; /&gt; #此处的8080已改为8081</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Connector port=&quot;8010&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; /&gt; #此处的8009已改为8010</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>端口说明：</p>
<ul>
<li>8080 默认的连接端口</li>
<li>8443 SSL的连接端口</li>
<li>8009 Apache的侦听端口</li>
<li>8005 用于停止Tomcat的端口</li>
</ul>
<p>5、重启系统生效，#source /etc/profile没作用
6、测试
浏览器访问
<a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">http://localhost:8080</a>
<a href="http://localhost:8081" target="_blank" rel="noopener noreferrer">http://localhost:8081</a>
都能看到那只猫表示正常！</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="修改fstab文件出错系统无法启动">修改FSTAB文件出错系统无法启动<a href="#修改fstab文件出错系统无法启动" class="hash-link" aria-label="修改FSTAB文件出错系统无法启动的直接链接" title="修改FSTAB文件出错系统无法启动的直接链接">​</a></h2>
<p>问题的解决过程中，重新mount /是比较关键的一步（mount -n -o remount,rw /）。如果没有此步操作，则文件系统处于只读状态，导致不能修改配置文件并保存，修复存在的问题</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装svn">安装SVN<a href="#安装svn" class="hash-link" aria-label="安装SVN的直接链接" title="安装SVN的直接链接">​</a></h2>
<p>出现configure: error: We require OpenSSL; try --with-openssl</p>
<p>需要安装openssl  和  openssl-devel</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="svn启动">svn启动<a href="#svn启动" class="hash-link" aria-label="svn启动的直接链接" title="svn启动的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">svnserve -d -r 目录 --listen-port 端口</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="安装java修改profile">安装JAVA修改profile<a href="#安装java修改profile" class="hash-link" aria-label="安装JAVA修改profile的直接链接" title="安装JAVA修改profile的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">JAVA_HOME=&quot;/usr/local/java&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JRE_HOME=&quot;/usr/local/java/jre&quot;PATH=/usr/local/java/jre/bin:/usr/local/java/bin:/usr/local/Percona/bin:/usr/local/apache-ant-1.7.1/bin:$PATHCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export JAVA_HOME JRE_HOME PATH CLASSPATH</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看当前正在删除的进程">查看当前正在删除的进程<a href="#查看当前正在删除的进程" class="hash-link" aria-label="查看当前正在删除的进程的直接链接" title="查看当前正在删除的进程的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">lsof|grep delete</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看目录大小">查看目录大小<a href="#查看目录大小" class="hash-link" aria-label="查看目录大小的直接链接" title="查看目录大小的直接链接">​</a></h2>
<p>查看目录大小</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">du -sh dir</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示目录下所有子目录大小</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">du --max-depth=1 -h dir</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="isolinuxcfg">isolinux.cfg<a href="#isolinuxcfg" class="hash-link" aria-label="isolinux.cfg的直接链接" title="isolinux.cfg的直接链接">​</a></h2>
<div class="language-title=isolinux.cfg codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-title=isolinux.cfg codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">default linux ks=cdrom:/anaconda-ks.cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#default vesamenu.c32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#prompt 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timeout 600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display boot.msg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu background splash.jpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu title Welcome to CentOS 6.3!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu color border 0 #ffffffff #00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu color sel 7 #ffffffff #ff000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu color title 0 #ffffffff #00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu color tabmsg 0 #ffffffff #00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu color unsel 0 #ffffffff #00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu color hotsel 0 #ff000000 #ffffffff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu color hotkey 7 #ffffffff #ff000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">menu color scrollbar 0 #ffffffff #00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">label linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  menu label ^Install or upgrade an existing system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  menu default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kernel vmlinuz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  append initrd=initrd.img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">label vesa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  menu label Install system with ^basic video driver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kernel vmlinuz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  append initrd=initrd.img xdriver=vesa nomodeset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">label rescue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  menu label ^Rescue installed system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kernel vmlinuz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  append initrd=initrd.img rescue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">label local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  menu label Boot from ^local drive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  localboot 0xffff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">label memtest86</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  menu label ^Memory test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kernel memtest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  append -</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="打包目录脚本">打包目录脚本<a href="#打包目录脚本" class="hash-link" aria-label="打包目录脚本的直接链接" title="打包目录脚本的直接链接">​</a></h2>
<p>打包data目录在/tw目录下</p>
<div class="language-bash codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-bash codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">#! /bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">year=`date +%Y`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">month=`date +%m`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">time=`date +%Y-%m-%d_%H:%M:%S`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BACKDIR=/tw/$year/$month</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p $BACKDIR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar -zcvf $BACKDIR/$time.tar.gz /data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;End !&#x27;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="关闭ipv6">关闭IPV6<a href="#关闭ipv6" class="hash-link" aria-label="关闭IPV6的直接链接" title="关闭IPV6的直接链接">​</a></h2>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vi /etc/modprobe.d/dist.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options ipv6 disable=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alias net-pf-10 off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vi /etc/sysconfig/network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NETWORKING_IPV6=off</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看服务监听的IP中是否有IPv6格式的地址</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">netstat -tuln</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看后台任务">查看后台任务<a href="#查看后台任务" class="hash-link" aria-label="查看后台任务的直接链接" title="查看后台任务的直接链接">​</a></h2>
<p>查看使用<code>ctrl+z</code>或<code>&amp;</code>在后台运行的任务</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">jobs</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将任务切换到前台</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">fg 12</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将任务切换到后台</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">bg 12</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="使用二进制源安装后终端无命令">使用二进制源安装后终端无命令<a href="#使用二进制源安装后终端无命令" class="hash-link" aria-label="使用二进制源安装后终端无命令的直接链接" title="使用二进制源安装后终端无命令的直接链接">​</a></h2>
<p>mysql 为例，当前终端有效</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">export PATH=$PATH:/usr/local/mysql/bin</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>永久生效</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;PATH=$PATH:/usr/local/mysql/bin/&quot; &gt;&gt; /etc/profile</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="防火墙打开端口">防火墙打开端口<a href="#防火墙打开端口" class="hash-link" aria-label="防火墙打开端口的直接链接" title="防火墙打开端口的直接链接">​</a></h2>
<blockquote>
<p>iptables</p>
</blockquote>
<p>参数：</p>
<ul>
<li>-I 在头部插入一条</li>
<li>-A 在末尾添加一条</li>
</ul>
<p>打开80端口</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -I INPUT -p tcp --dport 80 -j ACCEPT</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>关闭80端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -I INPUT -p tcp --dport 80 -j DROP</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>直接修改配置文件</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">vi /etc/sysconfig/iptables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>保存策略</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"> /etc/init.d/iptables save</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>重启防火墙</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">service iptables restart</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看端口状态</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"> /etc/init.d/iptables status</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>firewall</p>
</blockquote>
<p>开放80端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>允许192.168.1.10访问所有端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --zone=public --add-rich-rule &#x27;rule family=&quot;ipv4&quot; source address=&quot;192.168.1.10&quot; accept&#x27; --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>允许192.168.2.0/24访问所有端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --zone=public --add-rich-rule &#x27;rule family=&quot;ipv4&quot; source address=&quot;192.168.2.0/24&quot; accept&#x27; --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>允许192.168.1.10访问22端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --zone=public --add-rich-rule &#x27;rule family=&quot;ipv4&quot; source address=&quot;192.168.1.10&quot; port port=22 protocol=tcp accept&#x27; --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>移除开放的80端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --zone=public --remove-port=80/tcp --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>移除默认的ssh策略</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --remove-service=ssh --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>移除192.168.1.10所有访问所有端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --zone=public --remove-rich-rule &#x27;rule family=&quot;ipv4&quot; source address=&quot;192.168.1.10&quot; accept&#x27; --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>拒绝192.168.1.10访问22端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --zone=public --remove-rich-rule &#x27;rule family=&quot;ipv4&quot; source address=&quot;192.168.1.10&quot; port port=22 protocol=tcp reject&#x27; --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>拒绝192.168.1.10访问</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --permanent --add-rich-rule=&#x27;rule family=&quot;ipv4&quot; source address=&quot;192.168.1.10&quot; reject&#x27; --permanent</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>拒绝所有流量，远程连接会立即断开，只有本地能登陆</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --panic-on </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制 代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>取消应急模式，但需要重启firewalld后才可以远程ssh</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --panic-off</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看是否为应急模式</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">firewall-cmd --query-panic</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看打开端口">查看打开端口<a href="#查看打开端口" class="hash-link" aria-label="查看打开端口的直接链接" title="查看打开端口的直接链接">​</a></h2>
<p>列出所有端口</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">netstat -ntulp</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="设置分辨率">设置分辨率<a href="#设置分辨率" class="hash-link" aria-label="设置分辨率的直接链接" title="设置分辨率的直接链接">​</a></h2>
<p>显示系统分辨率选项</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xrandr</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>设置系统分辨率</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">xrandr -s 800x600</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="设置开机启动">设置开机启动<a href="#设置开机启动" class="hash-link" aria-label="设置开机启动的直接链接" title="设置开机启动的直接链接">​</a></h2>
<blockquote>
<p>centos6</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">chkconfig servicename on</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>centos7</p>
</blockquote>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable servicename</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>servicename</code>为服务名称</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="创建或修改文件时间">创建或修改文件时间<a href="#创建或修改文件时间" class="hash-link" aria-label="创建或修改文件时间的直接链接" title="创建或修改文件时间的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">touch file</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>参数：</p>
<ul>
<li>-a 只更改访问时间</li>
<li>-c 不创建任何文件</li>
<li>-d 使用指定字符串表示时间替代当前时间</li>
<li>-m 只更改修改时间</li>
</ul>
<p>将文件修改为指定时间</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">touch -d &#x27;2020-12-13 22:10:30&#x27; file</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="linux时间日期">linux时间日期<a href="#linux时间日期" class="hash-link" aria-label="linux时间日期的直接链接" title="linux时间日期的直接链接">​</a></h2>
<p>显示当前日期时间</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">date</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>显示格式化后时间</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">date &quot;+%Y-%m-%d %H:%M:%S&quot;</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>修改时间</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">date -s 14:15:00</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>本月月历</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">cal</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="禁止文件修改删除">禁止文件修改删除<a href="#禁止文件修改删除" class="hash-link" aria-label="禁止文件修改删除的直接链接" title="禁止文件修改删除的直接链接">​</a></h2>
<p>禁止修改删除</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">chattr +i filename </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>取消禁止</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">chattr -i filename </span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看设置特殊属性</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">lsattr</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="立即生效文件">立即生效文件<a href="#立即生效文件" class="hash-link" aria-label="立即生效文件的直接链接" title="立即生效文件的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">source /etc/profile</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="修改开机默认启动方式">修改开机默认启动方式<a href="#修改开机默认启动方式" class="hash-link" aria-label="修改开机默认启动方式的直接链接" title="修改开机默认启动方式的直接链接">​</a></h2>
<blockquote>
<p>centos6</p>
</blockquote>
<p>vi  /etc/inittab</p>
<p>id:3  (单用户模式）</p>
<p>id:5  (GUI)</p>
<blockquote>
<p>centos7</p>
</blockquote>
<p>查看当前的开机默认运行方式</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl get-default</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>multi-user.target：相当于之前的更改运行级别为3，意思就是命令行</li>
<li>graphical.target：相当于之前的更改运行级别为5，意思就是图形界面（graphical中文意思是图形）</li>
</ul>
<p>设 置启动方式</p>
<div class="codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-text codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl set-default multi-user.target</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="scp安装">scp安装<a href="#scp安装" class="hash-link" aria-label="scp安装的直接链接" title="scp安装的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">yum install openssh-clients</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="top查看实时进程信息">top查看实时进程信息<a href="#top查看实时进程信息" class="hash-link" aria-label="top查看实时进程信息的直接链接" title="top查看实时进程信息的直接链接">​</a></h2>
<p>每两秒列新一次</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">top -d 2</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看某个PID</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">top -d -2 -p3690</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将top的信息进行2次，然后将结果输出到/tmp/top.txt</p>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain"> top -b -n 2 &gt;/tmp/top.txt</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看linux系统信息">查看linux系统信息<a href="#查看linux系统信息" class="hash-link" aria-label="查看linux系统信息的直接链接" title="查看linux系统信息的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">uname</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>参数:</p>
<ul>
<li>-a 显示所有信息</li>
<li>-r 显示版本号</li>
<li>-n 显示主机名</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="显示用户过去命用的命令">显示用户过去命用的命令<a href="#显示用户过去命用的命令" class="hash-link" aria-label="显示用户过去命用的命令的直接链接" title="显示用户过去命用的命令的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">history</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="查看文件内容">查看文件内容<a href="#查看文件内容" class="hash-link" aria-label="查看文件内容的直接链接" title="查看文件内容的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">head -n file</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_ee_x theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_NFit"><pre tabindex="0" class="prism-code language-shell codeBlock_WVOr thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_rhkP"><span class="token-line" style="color:#393A34"><span class="token plain">tail -n file</span><br></span></code></pre><div class="buttonGroup_HJm9"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_yc5O" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_oit3"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_tZ6Z"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>n</code>需要查看的行数 <code>file</code>查看的文件</p>
<h2 class="anchor anchorWithStickyNavbar_AGbz" id="ftp">ftp<a href="#ftp" class="hash-link" aria-label="ftp的直接链接" title="ftp的直接链接">​</a></h2>
<p>get 文件名 下载</p>
<p>put 文件名 上传</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/gavintan/notes/docs/笔记/linux.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_acTV" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_MT5K"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--next" href="/docs/笔记/windows"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">windows</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_LyAc thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#shell变量含义" class="table-of-contents__link toc-highlight">shell变量含义</a></li><li><a href="#es修复分片" class="table-of-contents__link toc-highlight">es修复分片</a></li><li><a href="#haproxy停用启用server" class="table-of-contents__link toc-highlight">haproxy停用启用server</a></li><li><a href="#mysql导出文件" class="table-of-contents__link toc-highlight">mysql导出文件</a></li><li><a href="#xtrabackup备份" class="table-of-contents__link toc-highlight">xtrabackup备份</a></li><li><a href="#linux中文支持" class="table-of-contents__link toc-highlight">linux中文支持</a></li><li><a href="#logrotate日志切割" class="table-of-contents__link toc-highlight">logrotate日志切割</a></li><li><a href="#pm2" class="table-of-contents__link toc-highlight">pm2</a></li><li><a href="#windwos文件名到linux乱码" class="table-of-contents__link toc-highlight">windwos文件名到linux乱码</a></li><li><a href="#redis" class="table-of-contents__link toc-highlight">redis</a></li><li><a href="#kvm" class="table-of-contents__link toc-highlight">kvm</a></li><li><a href="#lvs" class="table-of-contents__link toc-highlight">lvs</a></li><li><a href="#nginx热升级版本" class="table-of-contents__link toc-highlight">nginx热升级版本</a></li><li><a href="#查看证书信息" class="table-of-contents__link toc-highlight">查看证书信息</a></li><li><a href="#kvm-开启tcp远程连接" class="table-of-contents__link toc-highlight">kvm 开启tcp远程连接</a></li><li><a href="#vim进入块编辑模式" class="table-of-contents__link toc-highlight">vim进入块编辑模式</a></li><li><a href="#安装python" class="table-of-contents__link toc-highlight">安装python</a></li><li><a href="#查看使用swap进程" class="table-of-contents__link toc-highlight">查看使用swap进程</a></li><li><a href="#esxi-安装megacli" class="table-of-contents__link toc-highlight">esxi 安装MegaCli</a></li><li><a href="#omsa" class="table-of-contents__link toc-highlight">omsa</a></li><li><a href="#mysql-日志为utc时间" class="table-of-contents__link toc-highlight">mysql 日志为utc时间</a></li><li><a href="#kvm嵌套虚拟化" class="table-of-contents__link toc-highlight">kvm嵌套虚拟化</a></li><li><a href="#run-django脚本" class="table-of-contents__link toc-highlight">run django脚本</a></li><li><a href="#nginx静态资源配置" class="table-of-contents__link toc-highlight">nginx静态资源配置</a></li><li><a href="#zabbix-微信脚本" class="table-of-contents__link toc-highlight">zabbix 微信脚本</a></li><li><a href="#jenkins-pipeline" class="table-of-contents__link toc-highlight">jenkins pipeline</a></li><li><a href="#终端字体" class="table-of-contents__link toc-highlight">终端字体</a></li><li><a href="#django导入默认数据" class="table-of-contents__link toc-highlight">django导入默认数据</a></li><li><a href="#mysql查看数据库占用大小" class="table-of-contents__link toc-highlight">mysql查看数据库占用大小</a></li><li><a href="#sendmail发送邮件" class="table-of-contents__link toc-highlight">sendmail发送邮件</a></li><li><a href="#生成随机密码" class="table-of-contents__link toc-highlight">生成随机密码</a></li><li><a href="#django重建表" class="table-of-contents__link toc-highlight">django重建表</a></li><li><a href="#tlbb" class="table-of-contents__link toc-highlight">tlbb</a></li><li><a href="#es修改日志按天数保留" class="table-of-contents__link toc-highlight">es修改日志按天数保留</a></li><li><a href="#清理cache占用大量内存" class="table-of-contents__link toc-highlight">清理cache占用大量内存</a></li><li><a href="#nfs" class="table-of-contents__link toc-highlight">nfs</a></li><li><a href="#systemd-模板" class="table-of-contents__link toc-highlight">systemd 模板</a></li><li><a href="#git-初始化提交" class="table-of-contents__link toc-highlight">git 初始化提交</a></li><li><a href="#zabbix启动中文" class="table-of-contents__link toc-highlight">zabbix启动中文</a></li><li><a href="#centos7升级内核" class="table-of-contents__link toc-highlight">centos7升级内核</a></li><li><a href="#smokeping" class="table-of-contents__link toc-highlight">smokeping</a></li><li><a href="#jdbc" class="table-of-contents__link toc-highlight">jdbc</a></li><li><a href="#yum源" class="table-of-contents__link toc-highlight">yum源</a></li><li><a href="#linux生成随机数" class="table-of-contents__link toc-highlight">Linux生成随机数</a></li><li><a href="#python-简单http服务与ftp服务" class="table-of-contents__link toc-highlight">Python 简单http服务与ftp服务</a></li><li><a href="#红帽cockpit-web管理服务器" class="table-of-contents__link toc-highlight">红帽cockpit web管理服务器</a></li><li><a href="#linux-设置时区" class="table-of-contents__link toc-highlight">linux 设置时区</a></li><li><a href="#weedfs-mount" class="table-of-contents__link toc-highlight">weedfs mount</a></li><li><a href="#获取linux-cpu核数" class="table-of-contents__link toc-highlight">获取Linux cpu核数</a></li><li><a href="#生成-100w-记录的数据文件导入mysql" class="table-of-contents__link toc-highlight">生成 100w 记录的数据文件导入mysql</a></li><li><a href="#docker安装及相关设置" class="table-of-contents__link toc-highlight">docker安装及相关设置</a></li><li><a href="#keepalived配置双机热备" class="table-of-contents__link toc-highlight">keepalived配置双机热备</a></li><li><a href="#内网穿透" class="table-of-contents__link toc-highlight">内网穿透</a></li><li><a href="#生成mipsel架构clash解决illegal-instruction错误" class="table-of-contents__link toc-highlight">生成mipsel架构clash解决Illegal instruction错误</a></li><li><a href="#openwrt" class="table-of-contents__link toc-highlight">openwrt</a></li><li><a href="#命令行json格式化输出" class="table-of-contents__link toc-highlight">命令行json格式化输出</a></li><li><a href="#docker添加中文支持" class="table-of-contents__link toc-highlight">docker添加中文支持</a></li><li><a href="#git撤销commit到未提交状态" class="table-of-contents__link toc-highlight">git撤销commit到未提交状态</a></li><li><a href="#git上传可执行文件" class="table-of-contents__link toc-highlight">git上传可执行文件</a></li><li><a href="#python命令行不能使用方向键" class="table-of-contents__link toc-highlight">python命令行不能使用方向键</a></li><li><a href="#nginx配置websocket" class="table-of-contents__link toc-highlight">nginx配置websocket</a></li><li><a href="#安装twisted模块" class="table-of-contents__link toc-highlight">安装twisted模块</a></li><li><a href="#删除git上指定目录" class="table-of-contents__link toc-highlight">删除git上指定目录</a></li><li><a href="#进入目录自动载入-python-虚拟环境配置" class="table-of-contents__link toc-highlight">进入目录自动载入 Python 虚拟环境配置</a></li><li><a href="#生成ssh密钥" class="table-of-contents__link toc-highlight">生成ssh密钥</a></li><li><a href="#tutum" class="table-of-contents__link toc-highlight">tutum</a></li><li><a href="#mongodb数据迁移" class="table-of-contents__link toc-highlight">mongodb数据迁移</a></li><li><a href="#percona-server-57-安装" class="table-of-contents__link toc-highlight">percona-server-5.7 安装</a></li><li><a href="#find使用" class="table-of-contents__link toc-highlight">find使用</a></li><li><a href="#zabbix执行远程命令" class="table-of-contents__link toc-highlight">zabbix执行远程命令</a></li><li><a href="#lvm卷组" class="table-of-contents__link toc-highlight">LVM卷组</a></li><li><a href="#vsftp-出现报错530-login-incorrect" class="table-of-contents__link toc-highlight">vsftp 出现报错530 Login incorrect</a></li><li><a href="#yum删除重复软件包" class="table-of-contents__link toc-highlight">yum删除重复软件包</a></li><li><a href="#yum下载rpm包" class="table-of-contents__link toc-highlight">yum下载rpm包</a></li><li><a href="#linux-scoket5代理转换http代理" class="table-of-contents__link toc-highlight">linux scoket5代理转换http代理</a></li><li><a href="#linux-连接vpnpptp" class="table-of-contents__link toc-highlight">linux 连接vpn（pptp）</a></li><li><a href="#nginx-http强制跳转https" class="table-of-contents__link toc-highlight">nginx http强制跳转https</a></li><li><a href="#shadowsocks安装" class="table-of-contents__link toc-highlight">shadowsocks安装</a></li><li><a href="#linux-大于2tb磁盘创建" class="table-of-contents__link toc-highlight">linux 大于2TB磁盘创建</a></li><li><a href="#网站压力测试" class="table-of-contents__link toc-highlight">网站压力测试</a></li><li><a href="#vi-去空格" class="table-of-contents__link toc-highlight">vi 去空格</a></li><li><a href="#查看文件权限" class="table-of-contents__link toc-highlight">查看文件权限</a></li><li><a href="#shell-字符串变量值的替换" class="table-of-contents__link toc-highlight">shell 字符串变量值的替换</a></li><li><a href="#linux获取外网ip" class="table-of-contents__link toc-highlight">linux获取外网ip</a></li><li><a href="#locale-编码报错" class="table-of-contents__link toc-highlight">locale 编码报错</a></li><li><a href="#windows下编辑的shell脚本在linux无法执行" class="table-of-contents__link toc-highlight">Windows下编辑的shell脚本在Linux无法执行</a></li><li><a href="#pip-安装" class="table-of-contents__link toc-highlight">pip 安装</a></li><li><a href="#脚本取得网站状态码" class="table-of-contents__link toc-highlight">脚本取得网站状态码</a></li><li><a href="#查找指定日期文件" class="table-of-contents__link toc-highlight">查找指定日期文件</a></li><li><a href="#centos7-创建自定义服务" class="table-of-contents__link toc-highlight">centos7 创建自定义服务</a></li><li><a href="#screen--保存日志" class="table-of-contents__link toc-highlight">screen  保存日志</a></li><li><a href="#内存缓存" class="table-of-contents__link toc-highlight">内存缓存</a></li><li><a href="#git-免密码" class="table-of-contents__link toc-highlight">git 免密码</a></li><li><a href="#linux-l2tp-安装脚本" class="table-of-contents__link toc-highlight">linux l2tp 安装脚本</a></li><li><a href="#linux-查找" class="table-of-contents__link toc-highlight">linux 查找</a></li><li><a href="#linux-测试网速" class="table-of-contents__link toc-highlight">linux 测试网速</a></li><li><a href="#cobbler-安装错误" class="table-of-contents__link toc-highlight">cobbler 安装错误</a></li><li><a href="#linux文本处理命令" class="table-of-contents__link toc-highlight">linux文本处理命令</a></li><li><a href="#升级php56" class="table-of-contents__link toc-highlight">升级php5.6</a></li><li><a href="#后台任务" class="table-of-contents__link toc-highlight">后台任务</a></li><li><a href="#saltstack安装" class="table-of-contents__link toc-highlight">saltstack安装</a></li><li><a href="#ubuntu安装桌面环境" class="table-of-contents__link toc-highlight">Ubuntu安装桌面环境</a></li><li><a href="#ubuntu提示w-mdadm-etcmdadmmdadmconf-defines-no-arrays" class="table-of-contents__link toc-highlight">Ubuntu提示W: mdadm: /etc/mdadm/mdadm.conf defines no arrays</a></li><li><a href="#mysql-56-mycnf-参数说明" class="table-of-contents__link toc-highlight">MySQL 5.6 my.cnf 参数说明</a></li><li><a href="#mysql-56版本适合在1gb内存vps上的mycnf配置文件" class="table-of-contents__link toc-highlight">MySQL 5.6版本适合在1GB内存VPS上的my.cnf配置文件</a></li><li><a href="#linux-加密脚本" class="table-of-contents__link toc-highlight">Linux 加密脚本</a></li><li><a href="#dell服务器硬件信息查看" class="table-of-contents__link toc-highlight">DELL服务器硬件信息查看</a></li><li><a href="#普通账号后再使用su--命令切换回root提示incorrect-password" class="table-of-contents__link toc-highlight">普通账号后再使用su -命令切换回root提示&quot;incorrect password&quot;</a></li><li><a href="#不打印空行和注释" class="table-of-contents__link toc-highlight">不打印空行和注释</a></li><li><a href="#虚拟机在线添加磁盘" class="table-of-contents__link toc-highlight">虚拟机在线添加磁盘</a></li><li><a href="#iptables通过lokkit开放端口" class="table-of-contents__link toc-highlight">iptables通过lokkit开放端口</a></li><li><a href="#查看libstdc库对应版本型号" class="table-of-contents__link toc-highlight">查看libstdc库对应版本型号</a></li><li><a href="#fork-炸弹" class="table-of-contents__link toc-highlight">fork 炸弹</a></li><li><a href="#多个外网ip指定出口ip" class="table-of-contents__link toc-highlight">多个外网ip指定出口ip</a></li><li><a href="#ssh反向代理" class="table-of-contents__link toc-highlight">ssh反向代理</a></li><li><a href="#linux端口转发" class="table-of-contents__link toc-highlight">linux端口转发</a></li><li><a href="#乱码名字文件通过inode修改文件名字" class="table-of-contents__link toc-highlight">乱码名字文件通过inode修改文件名字</a></li><li><a href="#shell参数" class="table-of-contents__link toc-highlight">Shell参数</a></li><li><a href="#升级zabbix" class="table-of-contents__link toc-highlight">升级zabbix</a></li><li><a href="#linux网页管理工具" class="table-of-contents__link toc-highlight">Linux网页管理工具</a></li><li><a href="#centos65升级到centos7" class="table-of-contents__link toc-highlight">centos6.5升级到centos7</a></li><li><a href="#安装zabbix报错解决方法" class="table-of-contents__link toc-highlight">安装zabbix报错解决方法</a></li><li><a href="#调整根分区大小" class="table-of-contents__link toc-highlight">调整根分区大小</a></li><li><a href="#linux连接wpa加密的wifi" class="table-of-contents__link toc-highlight">linux连接wpa加密的wifi</a></li><li><a href="#系统初始化脚本" class="table-of-contents__link toc-highlight">系统初始化脚本</a></li><li><a href="#查看cpu信息" class="table-of-contents__link toc-highlight">查看cpu信息</a></li><li><a href="#svn迁移" class="table-of-contents__link toc-highlight">svn迁移</a></li><li><a href="#vim-快捷键" class="table-of-contents__link toc-highlight">vim 快捷键</a></li><li><a href="#挂载ntfs分区" class="table-of-contents__link toc-highlight">挂载ntfs分区</a></li><li><a href="#修改单个用户字符集" class="table-of-contents__link toc-highlight">修改单个用户字符集</a></li><li><a href="#查看服务器硬件信息" class="table-of-contents__link toc-highlight">查看服务器硬件信息</a></li><li><a href="#zabbix监控exsi" class="table-of-contents__link toc-highlight">zabbix监控exsi</a></li><li><a href="#服务器网络死掉" class="table-of-contents__link toc-highlight">服务器网络死掉</a></li><li><a href="#查看网络连接数" class="table-of-contents__link toc-highlight">查看网络连接数</a></li><li><a href="#批量修改服务器密码" class="table-of-contents__link toc-highlight">批量修改服务器密码</a></li><li><a href="#配置ssh信任关系" class="table-of-contents__link toc-highlight">配置ssh信任关系</a></li><li><a href="#ansible使用" class="table-of-contents__link toc-highlight">ansible使用</a></li><li><a href="#查看设备oid值" class="table-of-contents__link toc-highlight">查看设备OID值</a></li><li><a href="#ssh登录错误次数较多的ip用iptables封掉脚本" class="table-of-contents__link toc-highlight">ssh登录错误次数较多的IP用iptables封掉脚本</a></li><li><a href="#iptables添加多个端口脚本" class="table-of-contents__link toc-highlight">iptables添加多个端口脚本</a></li><li><a href="#ssh连接只显示-bash-41" class="table-of-contents__link toc-highlight">ssh连接只显示-bash-4.1#</a></li><li><a href="#iptables-设置限制mac地址" class="table-of-contents__link toc-highlight">iptables 设置限制mac地址</a></li><li><a href="#不重启关闭selinux" class="table-of-contents__link toc-highlight">不重启关闭selinux</a></li><li><a href="#添加高级路由" class="table-of-contents__link toc-highlight">添加高级路由</a></li><li><a href="#查询ip路由信息" class="table-of-contents__link toc-highlight">查询ip路由信息</a></li><li><a href="#修改ssh基于密码验证" class="table-of-contents__link toc-highlight">修改ssh基于密码验证</a></li><li><a href="#安装logwatch" class="table-of-contents__link toc-highlight">安装logwatch</a></li><li><a href="#you-have-new-mail-in-varspoolmailroot-解决方法" class="table-of-contents__link toc-highlight">You have new mail in /var/spool/mail/root 解决方法</a></li><li><a href="#设置自动同步时间" class="table-of-contents__link toc-highlight">设置自动同步时间</a></li><li><a href="#安装sz-rz命令" class="table-of-contents__link toc-highlight">安装sz rz命令</a></li><li><a href="#yum无pptpd" class="table-of-contents__link toc-highlight">yum无pptpd</a></li><li><a href="#升级gcc后使用filezilla报错" class="table-of-contents__link toc-highlight">升级GCC后使用filezilla报错</a></li><li><a href="#linux-安装dns" class="table-of-contents__link toc-highlight">linux 安装DNS</a></li><li><a href="#安装本地rpm包" class="table-of-contents__link toc-highlight">安装本地rpm包</a></li><li><a href="#ipsec安装" class="table-of-contents__link toc-highlight">ipsec安装</a></li><li><a href="#测试硬盘读写速度" class="table-of-contents__link toc-highlight">测试硬盘读写速度</a></li><li><a href="#销毁磁盘数据" class="table-of-contents__link toc-highlight">销毁磁盘数据</a></li><li><a href="#查看系统所有用户和组" class="table-of-contents__link toc-highlight">查看系统所有用户和组</a></li><li><a href="#查看用户登录日志" class="table-of-contents__link toc-highlight">查看用户登录日志</a></li><li><a href="#查看系统版本" class="table-of-contents__link toc-highlight">查看系统版本</a></li><li><a href="#输出最为常用的十条命令" class="table-of-contents__link toc-highlight">输出最为常用的十条命令</a></li><li><a href="#anaconda-kscfg" class="table-of-contents__link toc-highlight">anaconda-ks.cfg</a></li><li><a href="#linux-卸载rpm" class="table-of-contents__link toc-highlight">linux 卸载rpm</a></li><li><a href="#安装gbd出现--cc1plus-warnings-being-treated-as-errors-错误解决方法" class="table-of-contents__link toc-highlight">安装GBD出现  cc1plus: warnings being treated as errors 错误解决方法</a></li><li><a href="#沒有nslookuphostdig命令" class="table-of-contents__link toc-highlight">沒有nslookup、host、dig命令</a></li><li><a href="#配置多个tomcat" class="table-of-contents__link toc-highlight">配置多个tomcat</a></li><li><a href="#修改fstab文件出错系统无法启动" class="table-of-contents__link toc-highlight">修改FSTAB文件出错系统无法启动</a></li><li><a href="#安装svn" class="table-of-contents__link toc-highlight">安装SVN</a></li><li><a href="#svn启动" class="table-of-contents__link toc-highlight">svn启动</a></li><li><a href="#安装java修改profile" class="table-of-contents__link toc-highlight">安装JAVA修改profile</a></li><li><a href="#查看当前正在删除的进程" class="table-of-contents__link toc-highlight">查看当前正在删除的进程</a></li><li><a href="#查看目录大小" class="table-of-contents__link toc-highlight">查看目录大小</a></li><li><a href="#isolinuxcfg" class="table-of-contents__link toc-highlight">isolinux.cfg</a></li><li><a href="#打包目录脚本" class="table-of-contents__link toc-highlight">打包目录脚本</a></li><li><a href="#关闭ipv6" class="table-of-contents__link toc-highlight">关闭IPV6</a></li><li><a href="#查看后台任务" class="table-of-contents__link toc-highlight">查看后台任务</a></li><li><a href="#使用二进制源安装后终端无命令" class="table-of-contents__link toc-highlight">使用二进制源安装后终端无命令</a></li><li><a href="#防火墙打开端口" class="table-of-contents__link toc-highlight">防火墙打开端口</a></li><li><a href="#查看打开端口" class="table-of-contents__link toc-highlight">查看打开端口</a></li><li><a href="#设置分辨率" class="table-of-contents__link toc-highlight">设置分辨率</a></li><li><a href="#设置开机启动" class="table-of-contents__link toc-highlight">设置开机启动</a></li><li><a href="#创建或修改文件时间" class="table-of-contents__link toc-highlight">创建或修改文件时间</a></li><li><a href="#linux时间日期" class="table-of-contents__link toc-highlight">linux时间日期</a></li><li><a href="#禁止文件修改删除" class="table-of-contents__link toc-highlight">禁止文件修改删除</a></li><li><a href="#立即生效文件" class="table-of-contents__link toc-highlight">立即生效文件</a></li><li><a href="#修改开机默认启动方式" class="table-of-contents__link toc-highlight">修改开机默认启动方式</a></li><li><a href="#scp安装" class="table-of-contents__link toc-highlight">scp安装</a></li><li><a href="#top查看实时进程信息" class="table-of-contents__link toc-highlight">top查看实时进程信息</a></li><li><a href="#查看linux系统信息" class="table-of-contents__link toc-highlight">查看linux系统信息</a></li><li><a href="#显示用户过去命用的命令" class="table-of-contents__link toc-highlight">显示用户过去命用的命令</a></li><li><a href="#查看文件内容" class="table-of-contents__link toc-highlight">查看文件内容</a></li><li><a href="#ftp" class="table-of-contents__link toc-highlight">ftp</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 GavinTan.</div></div></div></footer></div>
</body>
</html>